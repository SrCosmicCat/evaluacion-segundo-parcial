import{A as fT,B as fn,C as Xr,D as kd,E as xu,F as Um,G as pT,H as gT,I as q,J as zt,K as ut,L as Bm,M as mT,N as Mu,O as ce,P as Xt,Q as Od,R as $m,S as pn,T as ei,U as Xi,V as Fd,W as yT,X as Rn,Y as vt,a as x,b as ue,c as Vm,d as v,e as iT,f as xd,g as sT,h as oT,i as S,j as yo,k as Md,l as aT,m as uT,n as dt,o as Rd,p as Au,q as Lm,r as cT,s as Qn,t as jm,u as Nd,v as lT,w as dT,x as Pd,y as Qe,z as hT}from"./chunk-EMU53QTL.js";var _T=null;var Hm=1,vT=Symbol("SIGNAL");function en(t){let e=_T;return _T=t,e}var wT={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function dV(t){if(!(zm(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===Hm)){if(!t.producerMustRecompute(t)&&!qm(t)){t.dirty=!1,t.lastCleanEpoch=Hm;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=Hm}}function ET(t){return t&&(t.nextProducerIndex=0),en(t)}function IT(t,e){if(en(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(zm(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Gm(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function qm(t){Vd(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(dV(n),r!==n.version))return!0}return!1}function CT(t){if(Vd(t),zm(t))for(let e=0;e<t.producerNode.length;e++)Gm(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Gm(t,e){if(hV(t),Vd(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)Gm(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Vd(i),i.producerIndexOfThis[r]=e}}function zm(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Vd(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function hV(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function fV(){throw new Error}var pV=fV;function DT(t){pV=t}function W(t){return typeof t=="function"}function _o(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Ld=_o(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function es(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var qe=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(W(r))try{r()}catch(s){e=s instanceof Ld?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{TT(s)}catch(o){e=e??[],o instanceof Ld?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Ld(e)}}add(e){var n;if(e&&e!==this)if(this.closed)TT(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&es(n,e)}remove(e){let{_finalizers:n}=this;n&&es(n,e),e instanceof t&&e._removeParent(this)}};qe.EMPTY=(()=>{let t=new qe;return t.closed=!0,t})();var Wm=qe.EMPTY;function jd(t){return t instanceof qe||t&&"closed"in t&&W(t.remove)&&W(t.add)&&W(t.unsubscribe)}function TT(t){W(t)?t():t.unsubscribe()}var Nn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var vo={setTimeout(t,e,...n){let{delegate:r}=vo;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=vo;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Ud(t){vo.setTimeout(()=>{let{onUnhandledError:e}=Nn;if(e)e(t);else throw t})}function ts(){}var bT=Km("C",void 0,void 0);function ST(t){return Km("E",void 0,t)}function AT(t){return Km("N",t,void 0)}function Km(t,e,n){return{kind:t,value:e,error:n}}var ns=null;function wo(t){if(Nn.useDeprecatedSynchronousErrorHandling){let e=!ns;if(e&&(ns={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=ns;if(ns=null,n)throw r}}else t()}function xT(t){Nn.useDeprecatedSynchronousErrorHandling&&ns&&(ns.errorThrown=!0,ns.error=t)}var rs=class extends qe{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,jd(e)&&e.add(this)):this.destination=yV}static create(e,n,r){return new Sr(e,n,r)}next(e){this.isStopped?Ym(AT(e),this):this._next(e)}error(e){this.isStopped?Ym(ST(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Ym(bT,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},gV=Function.prototype.bind;function Qm(t,e){return gV.call(t,e)}var Zm=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Bd(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Bd(r)}else Bd(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Bd(n)}}},Sr=class extends rs{constructor(e,n,r){super();let i;if(W(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Nn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Qm(e.next,s),error:e.error&&Qm(e.error,s),complete:e.complete&&Qm(e.complete,s)}):i=e}this.destination=new Zm(i)}};function Bd(t){Nn.useDeprecatedSynchronousErrorHandling?xT(t):Ud(t)}function mV(t){throw t}function Ym(t,e){let{onStoppedNotification:n}=Nn;n&&vo.setTimeout(()=>n(t,e))}var yV={closed:!0,next:ts,error:mV,complete:ts};var Eo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function wt(t){return t}function Jm(...t){return Xm(t)}function Xm(t){return t.length===0?wt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var ne=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=vV(n)?n:new Sr(n,r,i);return wo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=MT(r),new r((i,s)=>{let o=new Sr({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Eo](){return this}pipe(...n){return Xm(n)(this)}toPromise(n){return n=MT(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function MT(t){var e;return(e=t??Nn.Promise)!==null&&e!==void 0?e:Promise}function _V(t){return t&&W(t.next)&&W(t.error)&&W(t.complete)}function vV(t){return t&&t instanceof rs||_V(t)&&jd(t)}function ey(t){return W(t?.lift)}function Y(t){return e=>{if(ey(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function K(t,e,n,r,i){return new ty(t,e,n,r,i)}var ty=class extends rs{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Io(){return Y((t,e)=>{let n=null;t._refCount++;let r=K(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Co=class extends ne{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,ey(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new qe;let n=this.getSubject();e.add(this.source.subscribe(K(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=qe.EMPTY)}return e}refCount(){return Io()(this)}};var RT=_o(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ye=(()=>{class t extends ne{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new $d(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new RT}next(n){wo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){wo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){wo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Wm:(this.currentObservers=null,s.push(n),new qe(()=>{this.currentObservers=null,es(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new ne;return n.source=this,n}}return t.create=(e,n)=>new $d(e,n),t})(),$d=class extends Ye{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Wm}};var Et=class extends Ye{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Ru={now(){return(Ru.delegate||Date).now()},delegate:void 0};var Hd=class extends Ye{constructor(e=1/0,n=1/0,r=Ru){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}};var qd=class extends qe{constructor(e,n){super()}schedule(e,n=0){return this}};var Nu={setInterval(t,e,...n){let{delegate:r}=Nu;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=Nu;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Do=class extends qd{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return Nu.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&Nu.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,es(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var To=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};To.now=Ru.now;var bo=class extends To{constructor(e,n=To.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var is=new bo(Do);var Gd=class extends Do{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var zd=class extends bo{};var ny=new zd(Gd);var Wt=new ne(t=>t.complete());function NT(t){return t&&W(t.schedule)}function ry(t){return t[t.length-1]}function So(t){return W(ry(t))?t.pop():void 0}function Yn(t){return NT(ry(t))?t.pop():void 0}function PT(t,e){return typeof ry(t)=="number"?t.pop():e}var Wd=t=>t&&typeof t.length=="number"&&typeof t!="function";function Kd(t){return W(t?.then)}function Qd(t){return W(t[Eo])}function Yd(t){return Symbol.asyncIterator&&W(t?.[Symbol.asyncIterator])}function Zd(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function wV(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Jd=wV();function Xd(t){return W(t?.[Jd])}function eh(t){return sT(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield xd(n.read());if(i)return yield xd(void 0);yield yield xd(r)}}finally{n.releaseLock()}})}function th(t){return W(t?.getReader)}function Te(t){if(t instanceof ne)return t;if(t!=null){if(Qd(t))return EV(t);if(Wd(t))return IV(t);if(Kd(t))return CV(t);if(Yd(t))return kT(t);if(Xd(t))return DV(t);if(th(t))return TV(t)}throw Zd(t)}function EV(t){return new ne(e=>{let n=t[Eo]();if(W(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function IV(t){return new ne(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function CV(t){return new ne(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Ud)})}function DV(t){return new ne(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function kT(t){return new ne(e=>{bV(t,e).catch(n=>e.error(n))})}function TV(t){return kT(eh(t))}function bV(t,e){var n,r,i,s;return iT(this,void 0,void 0,function*(){try{for(n=oT(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function Kt(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function gn(t,e=0){return Y((n,r)=>{n.subscribe(K(r,i=>Kt(r,t,()=>r.next(i),e),()=>Kt(r,t,()=>r.complete(),e),i=>Kt(r,t,()=>r.error(i),e)))})}function Pn(t,e=0){return Y((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function OT(t,e){return Te(t).pipe(Pn(e),gn(e))}function FT(t,e){return Te(t).pipe(Pn(e),gn(e))}function VT(t,e){return new ne(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function LT(t,e){return new ne(n=>{let r;return Kt(n,e,()=>{r=t[Jd](),Kt(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>W(r?.return)&&r.return()})}function nh(t,e){if(!t)throw new Error("Iterable cannot be null");return new ne(n=>{Kt(n,e,()=>{let r=t[Symbol.asyncIterator]();Kt(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function jT(t,e){return nh(eh(t),e)}function UT(t,e){if(t!=null){if(Qd(t))return OT(t,e);if(Wd(t))return VT(t,e);if(Kd(t))return FT(t,e);if(Yd(t))return nh(t,e);if(Xd(t))return LT(t,e);if(th(t))return jT(t,e)}throw Zd(t)}function _e(t,e){return e?UT(t,e):Te(t)}function U(...t){let e=Yn(t);return _e(t,e)}function Ao(t,e){let n=W(t)?t:()=>t,r=i=>i.error(n());return new ne(e?i=>e.schedule(r,0,i):r)}function iy(t){return!!t&&(t instanceof ne||W(t.lift)&&W(t.subscribe))}var Ar=_o(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function j(t,e){return Y((n,r)=>{let i=0;n.subscribe(K(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:SV}=Array;function AV(t,e){return SV(e)?t(...e):t(e)}function rh(t){return j(e=>AV(t,e))}var{isArray:xV}=Array,{getPrototypeOf:MV,prototype:RV,keys:NV}=Object;function ih(t){if(t.length===1){let e=t[0];if(xV(e))return{args:e,keys:null};if(PV(e)){let n=NV(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function PV(t){return t&&typeof t=="object"&&MV(t)===RV}function sh(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function Pu(...t){let e=Yn(t),n=So(t),{args:r,keys:i}=ih(t);if(r.length===0)return _e([],e);let s=new ne(kV(r,e,i?o=>sh(i,o):wt));return n?s.pipe(rh(n)):s}function kV(t,e,n=wt){return r=>{BT(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)BT(e,()=>{let c=_e(t[u],e),l=!1;c.subscribe(K(r,d=>{s[u]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function BT(t,e,n){t?Kt(n,t,e):e()}function $T(t,e,n,r,i,s,o,a){let u=[],c=0,l=0,d=!1,h=()=>{d&&!u.length&&!c&&e.complete()},f=g=>c<r?p(g):u.push(g),p=g=>{s&&e.next(g),c++;let _=!1;Te(n(g,l++)).subscribe(K(e,T=>{i?.(T),s?f(T):e.next(T)},()=>{_=!0},void 0,()=>{if(_)try{for(c--;u.length&&c<r;){let T=u.shift();o?Kt(e,o,()=>p(T)):p(T)}h()}catch(T){e.error(T)}}))};return t.subscribe(K(e,f,()=>{d=!0,h()})),()=>{a?.()}}function Ze(t,e,n=1/0){return W(e)?Ze((r,i)=>j((s,o)=>e(r,s,i,o))(Te(t(r,i))),n):(typeof e=="number"&&(n=e),Y((r,i)=>$T(r,i,t,n)))}function ti(t=1/0){return Ze(wt,t)}function HT(){return ti(1)}function xo(...t){return HT()(_e(t,Yn(t)))}function oh(t){return new ne(e=>{Te(t()).subscribe(e)})}function sy(...t){let e=So(t),{args:n,keys:r}=ih(t),i=new ne(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),u=o,c=o;for(let l=0;l<o;l++){let d=!1;Te(n[l]).subscribe(K(s,h=>{d||(d=!0,c--),a[l]=h},()=>u--,void 0,()=>{(!u||!d)&&(c||s.next(r?sh(r,a):a),s.complete())}))}});return e?i.pipe(rh(e)):i}function Mo(...t){let e=Yn(t),n=PT(t,1/0),r=t;return r.length?r.length===1?Te(r[0]):ti(n)(_e(r,e)):Wt}function It(t,e){return Y((n,r)=>{let i=0;n.subscribe(K(r,s=>t.call(e,s,i++)&&r.next(s)))})}function ni(t){return Y((e,n)=>{let r=null,i=!1,s;r=e.subscribe(K(n,void 0,void 0,o=>{s=Te(t(o,ni(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function qT(t,e,n,r,i){return(s,o)=>{let a=n,u=e,c=0;s.subscribe(K(o,l=>{let d=c++;u=a?t(u,l,d):(a=!0,l),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function ss(t,e){return W(e)?Ze(t,e,1):Ze(t,1)}function ri(t){return Y((e,n)=>{let r=!1;e.subscribe(K(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function xr(t){return t<=0?()=>Wt:Y((e,n)=>{let r=0;e.subscribe(K(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function oy(t){return j(()=>t)}function ku(t,e=wt){return t=t??OV,Y((n,r)=>{let i,s=!0;n.subscribe(K(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function OV(t,e){return t===e}function ah(t=FV){return Y((e,n)=>{let r=!1;e.subscribe(K(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function FV(){return new Ar}function Ou(t){return Y((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function mn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?It((i,s)=>t(i,s,r)):wt,xr(1),n?ri(e):ah(()=>new Ar))}function Ro(t){return t<=0?()=>Wt:Y((e,n)=>{let r=[];e.subscribe(K(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function ay(t,e){let n=arguments.length>=2;return r=>r.pipe(t?It((i,s)=>t(i,s,r)):wt,Ro(1),n?ri(e):ah(()=>new Ar))}function Fu(){return Y((t,e)=>{let n,r=!1;t.subscribe(K(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function Zn(t,e){return Y(qT(t,e,arguments.length>=2,!0))}function Vu(t={}){let{connector:e=()=>new Ye,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,c=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=u=void 0,l=d=!1},p=()=>{let g=o;f(),g?.unsubscribe()};return Y((g,_)=>{c++,!d&&!l&&h();let T=u=u??e();_.add(()=>{c--,c===0&&!d&&!l&&(a=uy(p,i))}),T.subscribe(_),!o&&c>0&&(o=new Sr({next:P=>T.next(P),error:P=>{d=!0,h(),a=uy(f,n,P),T.error(P)},complete:()=>{l=!0,h(),a=uy(f,r),T.complete()}}),Te(g).subscribe(o))})(s)}}function uy(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new Sr({next:()=>{r.unsubscribe(),t()}});return Te(e(...n)).subscribe(r)}function uh(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,Vu({connector:()=>new Hd(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function cy(t){return Y((e,n)=>{let r=!1,i=0;e.subscribe(K(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function os(...t){let e=Yn(t);return Y((n,r)=>{(e?xo(t,n,e):xo(t,n)).subscribe(r)})}function Oe(t,e){return Y((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(K(r,u=>{i?.unsubscribe();let c=0,l=s++;Te(t(u,l)).subscribe(i=K(r,d=>r.next(e?e(u,d,l,c++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function ch(t,e){return W(e)?Oe(()=>t,e):Oe(()=>t)}function ly(t){return Y((e,n)=>{Te(t).subscribe(K(n,()=>n.complete(),ts)),!n.closed&&e.subscribe(n)})}function Je(t,e,n){let r=W(t)||e||n?{next:t,error:e,complete:n}:t;return r?Y((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(K(s,u=>{var c;(c=r.next)===null||c===void 0||c.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,u),s.error(u)},()=>{var u,c;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):wt}function dy(...t){let e=So(t);return Y((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let u=0;u<i;u++)Te(t[u]).subscribe(K(r,c=>{s[u]=c,!a&&!o[u]&&(o[u]=!0,(a=o.every(wt))&&(o=null))},ts));n.subscribe(K(r,u=>{if(a){let c=[u,...s];r.next(e?e(...c):c)}}))})}var Rb="https://g.co/ng/security#xss",$=class extends Error{constructor(e,n){super(f_(e,n)),this.code=e}};function f_(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function be(t){for(let e in t)if(t[e]===be)return e;throw Error("Could not find renamed property on target object.")}function VV(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Qt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Qt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function GT(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var LV=be({__forward_ref__:be});function li(t){return t.__forward_ref__=li,t.toString=function(){return Qt(this())},t}function Ot(t){return Nb(t)?t():t}function Nb(t){return typeof t=="function"&&t.hasOwnProperty(LV)&&t.__forward_ref__===li}function Pb(t){return t&&!!t.\u0275providers}var jV=be({\u0275cmp:be}),UV=be({\u0275dir:be}),BV=be({\u0275pipe:be}),$V=be({\u0275mod:be}),wh=be({\u0275fac:be}),Lu=be({__NG_ELEMENT_ID__:be}),zT=be({__NG_ENV_ID__:be});function $h(t){return typeof t=="string"?t:t==null?"":String(t)}function HV(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():$h(t)}function qV(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new $(-200,t)}function p_(t,e){throw new $(-201,!1)}function V(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Xe(t){return{providers:t.providers||[],imports:t.imports||[]}}function Hh(t){return WT(t,Ob)||WT(t,Fb)}function kb(t){return Hh(t)!==null}function WT(t,e){return t.hasOwnProperty(e)?t[e]:null}function GV(t){let e=t&&(t[Ob]||t[Fb]);return e||null}function KT(t){return t&&(t.hasOwnProperty(QT)||t.hasOwnProperty(zV))?t[QT]:null}var Ob=be({\u0275prov:be}),QT=be({\u0275inj:be}),Fb=be({ngInjectableDef:be}),zV=be({ngInjectorDef:be}),se=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(se||{}),by;function Vb(){return by}function yn(t){let e=by;return by=t,e}function Lb(t,e,n){let r=Hh(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&se.Optional)return null;if(e!==void 0)return e;p_(t,"Injector")}var Ft=globalThis;var F=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=V({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};var WV={},Uu=WV,Sy="__NG_DI_FLAG__",Eh="ngTempTokenPath",KV="ngTokenPath",QV=/\n/gm,YV="\u0275",YT="__source",Fo;function ZV(){return Fo}function ii(t){let e=Fo;return Fo=t,e}function JV(t,e=se.Default){if(Fo===void 0)throw new $(-203,!1);return Fo===null?Lb(t,void 0,e):Fo.get(t,e&se.Optional?null:void 0,e)}function I(t,e=se.Default){return(Vb()||JV)(Ot(t),e)}function k(t,e=se.Default){return I(t,qh(e))}function qh(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Ay(t){let e=[];for(let n=0;n<t.length;n++){let r=Ot(t[n]);if(Array.isArray(r)){if(r.length===0)throw new $(900,!1);let i,s=se.Default;for(let o=0;o<r.length;o++){let a=r[o],u=XV(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(I(i,s))}else e.push(I(r))}return e}function jb(t,e){return t[Sy]=e,t.prototype[Sy]=e,t}function XV(t){return t[Sy]}function eL(t,e,n,r){let i=t[Eh];throw e[YT]&&i.unshift(e[YT]),t.message=tL(`
`+t.message,i,n,r),t[KV]=i,t[Eh]=null,t}function tL(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==YV?t.slice(2):t;let i=Qt(e);if(Array.isArray(e))i=e.map(Qt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Qt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(QV,`
  `)}`}function Zu(t){return{toString:t}.toString()}var Ub=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Ub||{}),er=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(er||{}),Lo={},_n=[],Vt=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Vt||{});function Bb(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function xy(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];nL(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function $b(t){return t===3||t===4||t===6}function nL(t){return t.charCodeAt(0)===64}function Bu(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?ZT(t,n,i,null,e[++r]):ZT(t,n,i,null,null))}}return t}function ZT(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var Hb="ng-template";function rL(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if(typeof s=="string"&&i){let o=t[r++];if(n&&s==="class"&&Bb(o.toLowerCase(),e,0)!==-1)return!0}else if(s===1){for(;r<t.length&&typeof(s=t[r++])=="string";)if(s.toLowerCase()===e)return!0;return!1}else typeof s=="number"&&(i=!1)}return!1}function qb(t){return t.type===4&&t.value!==Hb}function iL(t,e,n){let r=t.type===4&&!n?Hb:t.value;return e===r}function sL(t,e,n){let r=4,i=t.attrs||[],s=uL(i),o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!kn(r)&&!kn(u))return!1;if(o&&kn(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!iL(t,u,n)||u===""&&e.length===1){if(kn(r))return!1;o=!0}}else{let c=r&8?u:e[++a];if(r&8&&t.attrs!==null){if(!rL(t.attrs,c,n)){if(kn(r))return!1;o=!0}continue}let l=r&8?"class":u,d=oL(l,i,qb(t),n);if(d===-1){if(kn(r))return!1;o=!0;continue}if(c!==""){let h;d>s?h="":h=i[d+1].toLowerCase();let f=r&8?h:null;if(f&&Bb(f,c,0)!==-1||r&2&&c!==h){if(kn(r))return!1;o=!0}}}}return kn(r)||o}function kn(t){return(t&1)===0}function oL(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return cL(e,t)}function aL(t,e,n=!1){for(let r=0;r<e.length;r++)if(sL(t,e[r],n))return!0;return!1}function uL(t){for(let e=0;e<t.length;e++){let n=t[e];if($b(n))return e}return t.length}function cL(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function JT(t,e){return t?":not("+e.trim()+")":e}function lL(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!kn(o)&&(e+=JT(s,i),i=""),r=o,s=s||!kn(r);n++}return i!==""&&(e+=JT(s,i)),e}function dL(t){return t.map(lL).join(",")}function hL(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!kn(i))break;i=s}r++}return{attrs:e,classes:n}}function Yt(t){return Zu(()=>{let e=Qb(t),n=ue(x({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Ub.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||er.Emulated,styles:t.styles||_n,_:null,schemas:t.schemas||null,tView:null,id:""});Yb(n);let r=t.dependencies;return n.directiveDefs=eb(r,!1),n.pipeDefs=eb(r,!0),n.id=gL(n),n})}function fL(t){return oi(t)||Gb(t)}function pL(t){return t!==null}function et(t){return Zu(()=>({type:t.type,bootstrap:t.bootstrap||_n,declarations:t.declarations||_n,imports:t.imports||_n,exports:t.exports||_n,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function XT(t,e){if(t==null)return Lo;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=Vt.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==Vt.None?[r,a]:r,e[s]=o):n[s]=r}return n}function At(t){return Zu(()=>{let e=Qb(t);return Yb(e),e})}function oi(t){return t[jV]||null}function Gb(t){return t[UV]||null}function zb(t){return t[BV]||null}function Wb(t){let e=oi(t)||Gb(t)||zb(t);return e!==null?e.standalone:!1}function Kb(t,e){let n=t[$V]||null;if(!n&&e===!0)throw new Error(`Type ${Qt(t)} does not have '\u0275mod' property.`);return n}function Qb(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Lo,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||_n,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:XT(t.inputs,e),outputs:XT(t.outputs),debugInfo:null}}function Yb(t){t.features?.forEach(e=>e(t))}function eb(t,e){if(!t)return null;let n=e?zb:fL;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(pL)}function gL(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}var Pr=0,pe=1,z=2,St=3,On=4,Vn=5,Ih=6,$u=7,Fn=8,jo=9,Mr=10,Ct=11,Hu=12,tb=13,zo=14,tr=15,Gh=16,No=17,qu=18,zh=19,Zb=20,si=21,hy=22,cs=23,ai=25,Jb=1;var ls=7,Ch=8,Dh=9,vn=10,g_=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(g_||{});function as(t){return Array.isArray(t)&&typeof t[Jb]=="object"}function kr(t){return Array.isArray(t)&&t[Jb]===!0}function Xb(t){return(t.flags&4)!==0}function Wh(t){return t.componentOffset>-1}function m_(t){return(t.flags&1)===1}function ui(t){return!!t.template}function mL(t){return(t[z]&512)!==0}function Uo(t,e){let n=t.hasOwnProperty(wh);return n?t[wh]:null}var My=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function eS(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function ms(){return tS}function tS(t){return t.type.prototype.ngOnChanges&&(t.setInput=_L),yL}ms.ngInherit=!0;function yL(){let t=rS(this),e=t?.current;if(e){let n=t.previous;if(n===Lo)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function _L(t,e,n,r,i){let s=this.declaredInputs[r],o=rS(t)||vL(t,{previous:Lo,current:null}),a=o.current||(o.current={}),u=o.previous,c=u[s];a[s]=new My(c&&c.currentValue,n,u===Lo),eS(t,e,i,n)}var nS="__ngSimpleChanges__";function rS(t){return t[nS]||null}function vL(t,e){return t[nS]=e}var nb=null;var Jn=function(t,e,n){nb?.(t,e,n)},wL="svg",EL="math",IL=!1;function CL(){return IL}function nr(t){for(;Array.isArray(t);)t=t[Pr];return t}function iS(t,e){return nr(e[t])}function wn(t,e){return nr(e[t.index])}function sS(t,e){return t.data[e]}function di(t,e){let n=e[t];return as(n)?n:n[Pr]}function y_(t){return(t[z]&128)===128}function DL(t){return kr(t[St])}function Th(t,e){return e==null?null:t[e]}function oS(t){t[No]=0}function TL(t){t[z]&1024||(t[z]|=1024,y_(t)&&Gu(t))}function bL(t,e){for(;t>0;)e=e[zo],t--;return e}function __(t){return!!(t[z]&9216||t[cs]?.dirty)}function Ry(t){__(t)?Gu(t):t[z]&64&&(CL()?(t[z]|=1024,Gu(t)):t[Mr].changeDetectionScheduler?.notify())}function Gu(t){t[Mr].changeDetectionScheduler?.notify();let e=zu(t);for(;e!==null&&!(e[z]&8192||(e[z]|=8192,!y_(e)));)e=zu(e)}function aS(t,e){if((t[z]&256)===256)throw new $(911,!1);t[si]===null&&(t[si]=[]),t[si].push(e)}function SL(t,e){if(t[si]===null)return;let n=t[si].indexOf(e);n!==-1&&t[si].splice(n,1)}function zu(t){let e=t[St];return kr(e)?e[St]:e}var de={lFrame:pS(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function AL(){return de.lFrame.elementDepthCount}function xL(){de.lFrame.elementDepthCount++}function ML(){de.lFrame.elementDepthCount--}function uS(){return de.bindingsEnabled}function RL(){return de.skipHydrationRootTNode!==null}function NL(t){return de.skipHydrationRootTNode===t}function PL(){de.skipHydrationRootTNode=null}function Le(){return de.lFrame.lView}function Ln(){return de.lFrame.tView}function Wo(t){return de.lFrame.contextLView=t,t[Fn]}function Ko(t){return de.lFrame.contextLView=null,t}function nn(){let t=cS();for(;t!==null&&t.type===64;)t=t.parent;return t}function cS(){return de.lFrame.currentTNode}function kL(){let t=de.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function Ju(t,e){let n=de.lFrame;n.currentTNode=t,n.isParent=e}function lS(){return de.lFrame.isParent}function OL(){de.lFrame.isParent=!1}function FL(t){return de.lFrame.bindingIndex=t}function v_(){return de.lFrame.bindingIndex++}function VL(t){let e=de.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function LL(){return de.lFrame.inI18n}function jL(t,e){let n=de.lFrame;n.bindingIndex=n.bindingRootIndex=t,Ny(e)}function UL(){return de.lFrame.currentDirectiveIndex}function Ny(t){de.lFrame.currentDirectiveIndex=t}function BL(t){let e=de.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function dS(t){de.lFrame.currentQueryIndex=t}function $L(t){let e=t[pe];return e.type===2?e.declTNode:e.type===1?t[Vn]:null}function hS(t,e,n){if(n&se.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&se.Host);)if(i=$L(s),i===null||(s=s[zo],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=de.lFrame=fS();return r.currentTNode=e,r.lView=t,!0}function w_(t){let e=fS(),n=t[pe];de.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function fS(){let t=de.lFrame,e=t===null?null:t.child;return e===null?pS(t):e}function pS(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function gS(){let t=de.lFrame;return de.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var mS=gS;function E_(){let t=gS();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function HL(t){return(de.lFrame.contextLView=bL(t,de.lFrame.contextLView))[Fn]}function Qo(){return de.lFrame.selectedIndex}function ds(t){de.lFrame.selectedIndex=t}function yS(){let t=de.lFrame;return sS(t.tView,t.selectedIndex)}function qL(){return de.lFrame.currentNamespace}var _S=!0;function I_(){return _S}function C_(t){_S=t}function GL(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=tS(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function D_(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function gh(t,e,n){vS(t,e,3,n)}function mh(t,e,n,r){(t[z]&3)===n&&vS(t,e,n,r)}function fy(t,e){let n=t[z];(n&3)===e&&(n&=16383,n+=1,t[z]=n)}function vS(t,e,n,r){let i=r!==void 0?t[No]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(t[No]+=65536),(a<s||s==-1)&&(zL(t,n,e,u),t[No]=(t[No]&4294901760)+u+2),u++}function rb(t,e){Jn(4,t,e);let n=en(null);try{e.call(t)}finally{en(n),Jn(5,t,e)}}function zL(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[z]>>14<t[No]>>16&&(t[z]&3)===e&&(t[z]+=16384,rb(a,s)):rb(a,s)}var Vo=-1,hs=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function WL(t){return t instanceof hs}function KL(t){return(t.flags&8)!==0}function QL(t){return(t.flags&16)!==0}function wS(t){return t!==Vo}function bh(t){return t&32767}function YL(t){return t>>16}function Sh(t,e){let n=YL(t),r=e;for(;n>0;)r=r[zo],n--;return r}var Py=!0;function ib(t){let e=Py;return Py=t,e}var ZL=256,ES=ZL-1,IS=5,JL=0,Xn={};function XL(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(Lu)&&(r=n[Lu]),r==null&&(r=n[Lu]=JL++);let i=r&ES,s=1<<i;e.data[t+(i>>IS)]|=s}function Ah(t,e){let n=CS(t,e);if(n!==-1)return n;let r=e[pe];r.firstCreatePass&&(t.injectorIndex=e.length,py(r.data,t),py(e,null),py(r.blueprint,null));let i=T_(t,e),s=t.injectorIndex;if(wS(i)){let o=bh(i),a=Sh(i,e),u=a[pe].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|u[o+c]}return e[s+8]=i,s}function py(t,e){t.push(0,0,0,0,0,0,0,0,e)}function CS(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function T_(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=AS(i),r===null)return Vo;if(n++,i=i[zo],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Vo}function ky(t,e,n){XL(t,e,n)}function e2(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if($b(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function DS(t,e,n){if(n&se.Optional||t!==void 0)return t;p_(e,"NodeInjector")}function TS(t,e,n,r){if(n&se.Optional&&r===void 0&&(r=null),!(n&(se.Self|se.Host))){let i=t[jo],s=yn(void 0);try{return i?i.get(e,r,n&se.Optional):Lb(e,r,n&se.Optional)}finally{yn(s)}}return DS(r,e,n)}function bS(t,e,n,r=se.Default,i){if(t!==null){if(e[z]&2048&&!(r&se.Self)){let o=s2(t,e,n,r,Xn);if(o!==Xn)return o}let s=SS(t,e,n,r,Xn);if(s!==Xn)return s}return TS(e,n,r,i)}function SS(t,e,n,r,i){let s=r2(n);if(typeof s=="function"){if(!hS(e,t,r))return r&se.Host?DS(i,n,r):TS(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&se.Optional))p_(n);else return o}finally{mS()}}else if(typeof s=="number"){let o=null,a=CS(t,e),u=Vo,c=r&se.Host?e[tr][Vn]:null;for((a===-1||r&se.SkipSelf)&&(u=a===-1?T_(t,e):e[a+8],u===Vo||!ob(r,!1)?a=-1:(o=e[pe],a=bh(u),e=Sh(u,e)));a!==-1;){let l=e[pe];if(sb(s,a,l.data)){let d=t2(a,e,n,o,r,c);if(d!==Xn)return d}u=e[a+8],u!==Vo&&ob(r,e[pe].data[a+8]===c)&&sb(s,a,e)?(o=l,a=bh(u),e=Sh(u,e)):a=-1}}return i}function t2(t,e,n,r,i,s){let o=e[pe],a=o.data[t+8],u=r==null?Wh(a)&&Py:r!=o&&(a.type&3)!==0,c=i&se.Host&&s===a,l=n2(a,o,n,u,c);return l!==null?Bo(e,o,l,a):Xn}function n2(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,u=t.directiveStart,c=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:c;for(let f=d;f<h;f++){let p=o[f];if(f<u&&n===p||f>=u&&p.type===n)return f}if(i){let f=o[u];if(f&&ui(f)&&f.type===n)return u}return null}function Bo(t,e,n,r){let i=t[n],s=e.data;if(WL(i)){let o=i;o.resolving&&qV(HV(s[n]));let a=ib(o.canSeeViewProviders);o.resolving=!0;let u,c=o.injectImpl?yn(o.injectImpl):null,l=hS(t,r,se.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&GL(n,s[n],e)}finally{c!==null&&yn(c),ib(a),o.resolving=!1,mS()}}return i}function r2(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(Lu)?t[Lu]:void 0;return typeof e=="number"?e>=0?e&ES:i2:e}function sb(t,e,n){let r=1<<t;return!!(n[e+(t>>IS)]&r)}function ob(t,e){return!(t&se.Self)&&!(t&se.Host&&e)}var us=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return bS(this._tNode,this._lView,e,qh(r),n)}};function i2(){return new us(nn(),Le())}function hi(t){return Zu(()=>{let e=t.prototype.constructor,n=e[wh]||Oy(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[wh]||Oy(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Oy(t){return Nb(t)?()=>{let e=Oy(Ot(t));return e&&e()}:Uo(t)}function s2(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[z]&2048&&!(o[z]&512);){let a=SS(s,o,n,r|se.Self,Xn);if(a!==Xn)return a;let u=s.parent;if(!u){let c=o[Zb];if(c){let l=c.get(n,Xn,r);if(l!==Xn)return l}u=AS(o),o=o[zo]}s=u}return i}function AS(t){let e=t[pe],n=e.type;return n===2?e.declTNode:n===1?t[Vn]:null}function b_(t){return e2(nn(),t)}var lh="__parameters__";function o2(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function xS(t,e,n){return Zu(()=>{let r=o2(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,c,l){let d=u.hasOwnProperty(lh)?u[lh]:Object.defineProperty(u,lh,{value:[]})[lh];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}function a2(t){let e=Ft.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function u2(t){return typeof t=="function"}function S_(t,e){t.forEach(n=>Array.isArray(n)?S_(n,e):e(n))}function MS(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function xh(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function c2(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function l2(t,e,n){let r=Xu(t,e);return r>=0?t[r|1]=n:(r=~r,c2(t,r,e,n)),r}function gy(t,e){let n=Xu(t,e);if(n>=0)return t[n|1]}function Xu(t,e){return d2(t,e,1)}function d2(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var Yo=jb(xS("Optional"),8);var A_=jb(xS("SkipSelf"),4);function h2(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(m2))}return s}return Mh.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(c=>{i.template=c}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let c=i.styles.length,l=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[c+h]=f,l.splice(l.indexOf(d),1),l.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(c=>{a.push(c),i.styleUrl=void 0}));let u=Promise.all(o).then(()=>y2(s));e.push(u)}),p2(),Promise.all(e).then(()=>{})}var Mh=new Map,f2=new Set;function p2(){let t=Mh;return Mh=new Map,t}function g2(){return Mh.size===0}function m2(t){return typeof t=="string"?t:t.text()}function y2(t){f2.delete(t)}var $o=new F(""),RS=new F("",-1),NS=new F(""),Rh=class{get(e,n=Uu){if(n===Uu){let r=new Error(`NullInjectorError: No provider for ${Qt(e)}!`);throw r.name="NullInjectorError",r}return n}};function _2(...t){return{\u0275providers:PS(!0,t),\u0275fromNgModule:!0}}function PS(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return S_(e,o=>{let a=o;Fy(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&kS(i,s),n}function kS(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];x_(i,s=>{e(s,r)})}}function Fy(t,e,n,r){if(t=Ot(t),!t)return!1;let i=null,s=KT(t),o=!s&&oi(t);if(!s&&!o){let u=t.ngModule;if(s=KT(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of u)Fy(c,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let c;try{S_(s.imports,l=>{Fy(l,e,n,r)&&(c||=[],c.push(l))})}finally{}c!==void 0&&kS(c,e)}if(!a){let c=Uo(i)||(()=>new i);e({provide:i,useFactory:c,deps:_n},i),e({provide:NS,useValue:i,multi:!0},i),e({provide:$o,useValue:()=>I(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let c=t;x_(u,l=>{e(l,c)})}}else return!1;return i!==t&&t.providers!==void 0}function x_(t,e){for(let n of t)Pb(n)&&(n=n.\u0275providers),Array.isArray(n)?x_(n,e):e(n)}var v2=be({provide:String,useValue:be});function OS(t){return t!==null&&typeof t=="object"&&v2 in t}function w2(t){return!!(t&&t.useExisting)}function E2(t){return!!(t&&t.useFactory)}function Ho(t){return typeof t=="function"}function I2(t){return!!t.useClass}var Kh=new F(""),yh={},C2={},my;function M_(){return my===void 0&&(my=new Rh),my}var tn=class{},Wu=class extends tn{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ly(e,o=>this.processProvider(o)),this.records.set(RS,Po(void 0,this)),i.has("environment")&&this.records.set(tn,Po(void 0,this));let s=this.records.get(Kh);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(NS,_n,se.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=ii(this),r=yn(void 0),i;try{return e()}finally{ii(n),yn(r)}}get(e,n=Uu,r=se.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(zT))return e[zT](this);r=qh(r);let i,s=ii(this),o=yn(void 0);try{if(!(r&se.SkipSelf)){let u=this.records.get(e);if(u===void 0){let c=A2(e)&&Hh(e);c&&this.injectableDefInScope(c)?u=Po(Vy(e),yh):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&se.Self?M_():this.parent;return n=r&se.Optional&&n===Uu?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Eh]=a[Eh]||[]).unshift(Qt(e)),s)throw a;return eL(a,e,"R3InjectorError",this.source)}else throw a}finally{yn(o),ii(s)}}resolveInjectorInitializers(){let e=ii(this),n=yn(void 0),r;try{let i=this.get($o,_n,se.Self);for(let s of i)s()}finally{ii(e),yn(n)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Qt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new $(205,!1)}processProvider(e){e=Ot(e);let n=Ho(e)?e:Ot(e&&e.provide),r=T2(e);if(!Ho(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Po(void 0,yh,!0),i.factory=()=>Ay(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===yh&&(n.value=C2,n.value=n.factory()),typeof n.value=="object"&&n.value&&S2(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Ot(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function Vy(t){let e=Hh(t),n=e!==null?e.factory:Uo(t);if(n!==null)return n;if(t instanceof F)throw new $(204,!1);if(t instanceof Function)return D2(t);throw new $(204,!1)}function D2(t){if(t.length>0)throw new $(204,!1);let n=GV(t);return n!==null?()=>n.factory(t):()=>new t}function T2(t){if(OS(t))return Po(void 0,t.useValue);{let e=FS(t);return Po(e,yh)}}function FS(t,e,n){let r;if(Ho(t)){let i=Ot(t);return Uo(i)||Vy(i)}else if(OS(t))r=()=>Ot(t.useValue);else if(E2(t))r=()=>t.useFactory(...Ay(t.deps||[]));else if(w2(t))r=()=>I(Ot(t.useExisting));else{let i=Ot(t&&(t.useClass||t.provide));if(b2(t))r=()=>new i(...Ay(t.deps));else return Uo(i)||Vy(i)}return r}function Po(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function b2(t){return!!t.deps}function S2(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function A2(t){return typeof t=="function"||typeof t=="object"&&t instanceof F}function Ly(t,e){for(let n of t)Array.isArray(n)?Ly(n,e):n&&Pb(n)?Ly(n.\u0275providers,e):e(n)}function fi(t,e){t instanceof Wu&&t.assertNotDestroyed();let n,r=ii(t),i=yn(void 0);try{return e()}finally{ii(r),yn(i)}}function x2(t){if(!Vb()&&!ZV())throw new $(-203,!1)}function ab(t,e=null,n=null,r){let i=VS(t,e,n,r);return i.resolveInjectorInitializers(),i}function VS(t,e=null,n=null,r,i=new Set){let s=[n||_n,_2(t)];return r=r||(typeof t=="object"?void 0:Qt(t)),new Wu(s,e||M_(),r||null,i)}var jn=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return ab({name:""},i,r,"");{let s=r.name??"";return ab({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Uu,e.NULL=new Rh,e.\u0275prov=V({token:e,providedIn:"any",factory:()=>I(RS)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var jy;function LS(t){jy=t}function M2(){if(jy!==void 0)return jy;if(typeof document<"u")return document;throw new $(210,!1)}var Qh=new F("",{providedIn:"root",factory:()=>R2}),R2="ng",R_=new F(""),xt=new F("",{providedIn:"platform",factory:()=>"unknown"});var N_=new F("",{providedIn:"root",factory:()=>M2().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function jS(t){return t instanceof Function?t():t}function N2(t){return(t??k(jn)).get(xt)==="browser"}function US(t){return(t.flags&128)===128}var Rr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Rr||{});var BS=new Map,P2=0;function k2(){return P2++}function O2(t){BS.set(t[zh],t)}function F2(t){BS.delete(t[zh])}var ub="__ngContext__";function fs(t,e){as(e)?(t[ub]=e[zh],O2(e)):t[ub]=e}var V2;function P_(t,e){return V2(t,e)}function ko(t,e,n,r,i){if(r!=null){let s,o=!1;kr(r)?s=r:as(r)&&(o=!0,r=r[Pr]);let a=nr(r);t===0&&n!==null?i==null?zS(e,n,a):Nh(e,n,a,i||null,!0):t===1&&n!==null?Nh(e,n,a,i||null,!0):t===2?ej(e,a,o):t===3&&e.destroyNode(a),s!=null&&nj(e,t,s,n,i)}}function L2(t,e){return t.createText(e)}function j2(t,e,n){t.setValue(e,n)}function $S(t,e,n){return t.createElement(e,n)}function U2(t,e){HS(t,e),e[Pr]=null,e[Vn]=null}function B2(t,e,n,r,i,s){r[Pr]=i,r[Vn]=e,Yh(t,r,n,1,i,s)}function HS(t,e){Yh(t,e,e[Ct],2,null,null)}function $2(t){let e=t[Hu];if(!e)return yy(t[pe],t);for(;e;){let n=null;if(as(e))n=e[Hu];else{let r=e[vn];r&&(n=r)}if(!n){for(;e&&!e[On]&&e!==t;)as(e)&&yy(e[pe],e),e=e[St];e===null&&(e=t),as(e)&&yy(e[pe],e),n=e&&e[On]}e=n}}function H2(t,e,n,r){let i=vn+r,s=n.length;r>0&&(n[i-1][On]=e),r<s-vn?(e[On]=n[i],MS(n,vn+r,e)):(n.push(e),e[On]=null),e[St]=n;let o=e[Gh];o!==null&&n!==o&&q2(o,e);let a=e[qu];a!==null&&a.insertView(t),Ry(e),e[z]|=128}function q2(t,e){let n=t[Dh],i=e[St][St][tr];e[tr]!==i&&(t[z]|=g_.HasTransplantedViews),n===null?t[Dh]=[e]:n.push(e)}function qS(t,e){let n=t[Dh],r=n.indexOf(e);n.splice(r,1)}function Uy(t,e){if(t.length<=vn)return;let n=vn+e,r=t[n];if(r){let i=r[Gh];i!==null&&i!==t&&qS(i,r),e>0&&(t[n-1][On]=r[On]);let s=xh(t,vn+e);U2(r[pe],r);let o=s[qu];o!==null&&o.detachView(s[pe]),r[St]=null,r[On]=null,r[z]&=-129}return r}function GS(t,e){if(!(e[z]&256)){let n=e[Ct];n.destroyNode&&Yh(t,e,n,3,null,null),$2(e)}}function yy(t,e){if(!(e[z]&256)){e[z]&=-129,e[z]|=256,e[cs]&&CT(e[cs]),z2(t,e),G2(t,e),e[pe].type===1&&e[Ct].destroy();let n=e[Gh];if(n!==null&&kr(e[St])){n!==e[St]&&qS(n,e);let r=e[qu];r!==null&&r.detachView(t)}F2(e)}}function G2(t,e){let n=t.cleanup,r=e[$u];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[$u]=null);let i=e[si];if(i!==null){e[si]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function z2(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof hs)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];Jn(4,a,u);try{u.call(a)}finally{Jn(5,a,u)}}else{Jn(4,i,s);try{s.call(i)}finally{Jn(5,i,s)}}}}}function W2(t,e,n){return K2(t,e.parent,n)}function K2(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[Pr];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===er.None||s===er.Emulated)return null}return wn(r,n)}}function Nh(t,e,n,r,i){t.insertBefore(e,n,r,i)}function zS(t,e,n){t.appendChild(e,n)}function cb(t,e,n,r,i){r!==null?Nh(t,e,n,r,i):zS(t,e,n)}function Q2(t,e,n,r){t.removeChild(e,n,r)}function k_(t,e){return t.parentNode(e)}function Y2(t,e){return t.nextSibling(e)}function Z2(t,e,n){return X2(t,e,n)}function J2(t,e,n){return t.type&40?wn(t,n):null}var X2=J2,lb;function O_(t,e,n,r){let i=W2(t,r,e),s=e[Ct],o=r.parent||e[Vn],a=Z2(o,r,e);if(i!=null)if(Array.isArray(n))for(let u=0;u<n.length;u++)cb(s,i,n[u],a,!1);else cb(s,i,n,a,!1);lb!==void 0&&lb(s,r,e,n,i)}function _h(t,e){if(e!==null){let n=e.type;if(n&3)return wn(e,t);if(n&4)return By(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return _h(t,r);{let i=t[e.index];return kr(i)?By(-1,i):nr(i)}}else{if(n&32)return P_(e,t)()||nr(t[e.index]);{let r=WS(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=zu(t[tr]);return _h(i,r)}else return _h(t,e.next)}}}return null}function WS(t,e){if(e!==null){let r=t[tr][Vn],i=e.projection;return r.projection[i]}return null}function By(t,e){let n=vn+t+1;if(n<e.length){let r=e[n],i=r[pe].firstChild;if(i!==null)return _h(r,i)}return e[ls]}function ej(t,e,n){let r=k_(t,e);r&&Q2(t,r,e,n)}function F_(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],u=n.type;if(o&&e===0&&(a&&fs(nr(a),r),n.flags|=2),(n.flags&32)!==32)if(u&8)F_(t,e,n.child,r,i,s,!1),ko(e,t,i,a,s);else if(u&32){let c=P_(n,r),l;for(;l=c();)ko(e,t,i,l,s);ko(e,t,i,a,s)}else u&16?tj(t,e,r,n,i,s):ko(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Yh(t,e,n,r,i,s){F_(n,r,t.firstChild,e,i,s,!1)}function tj(t,e,n,r,i,s){let o=n[tr],u=o[Vn].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++){let l=u[c];ko(e,t,i,l,s)}else{let c=u,l=o[St];US(r)&&(c.flags|=128),F_(t,e,c,l,i,s,!0)}}function nj(t,e,n,r,i){let s=n[ls],o=nr(n);s!==o&&ko(e,t,r,s,i);for(let a=vn;a<n.length;a++){let u=n[a];Yh(u[pe],u,t,e,r,s)}}function rj(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Rr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Rr.Important),t.setStyle(n,r,i,s))}}function ij(t,e,n){t.setAttribute(e,"style",n)}function KS(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function QS(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&xy(t,e,r),i!==null&&KS(t,e,i),s!==null&&ij(t,e,s)}var dh;function sj(){if(dh===void 0&&(dh=null,Ft.trustedTypes))try{dh=Ft.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return dh}function db(t){return sj()?.createScriptURL(t)||t}var Ph=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Rb})`}};function ec(t){return t instanceof Ph?t.changingThisBreaksApplicationSecurity:t}function V_(t,e){let n=oj(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${Rb})`)}return n===e}function oj(t){return t instanceof Ph&&t.getTypeName()||null}var aj=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function YS(t){return t=String(t),t.match(aj)?t:"unsafe:"+t}var Zh=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Zh||{});function uj(t){let e=JS();return e?e.sanitize(Zh.URL,t)||"":V_(t,"URL")?ec(t):YS($h(t))}function cj(t){let e=JS();if(e)return db(e.sanitize(Zh.RESOURCE_URL,t)||"");if(V_(t,"ResourceURL"))return db(ec(t));throw new $(904,!1)}function lj(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?cj:uj}function ZS(t,e,n){return lj(e,n)(t)}function JS(){let t=Le();return t&&t[Mr].sanitizer}var $y=class{};var dj="h",hj="b";var fj=()=>null;function L_(t,e,n=!1){return fj(t,e,n)}var Hy=class{},kh=class{};function pj(t){let e=Error(`No component factory found for ${Qt(t)}.`);return e[gj]=t,e}var gj="ngComponent";var qy=class{resolveComponentFactory(e){throw pj(e)}},Jh=(()=>{let e=class e{};e.NULL=new qy;let t=e;return t})();function mj(){return Xh(nn(),Le())}function Xh(t,e){return new ir(wn(t,e))}var ir=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=mj;let t=e;return t})();var Ku=class{},Or=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>yj();let t=e;return t})();function yj(){let t=Le(),e=nn(),n=di(e.index,t);return(as(n)?n:t)[Ct]}var _j=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),_y={};function XS(t){return wj(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function vj(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function wj(t){return t!==null&&(typeof t=="function"||typeof t=="object")}var Gy=class{constructor(){}supports(e){return XS(e)}create(e){return new zy(e)}},Ej=(t,e)=>e,zy=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Ej}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<hb(r,i,s)?n:r,a=hb(o,i,s),u=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let c=a-i,l=u-i;if(c!=l){for(let h=0;h<c;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;l<=p&&p<c&&(s[h]=f+1)}let d=o.previousIndex;s[d]=l-c}}a!==u&&e(o,a,u)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!XS(e))throw new $(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,vj(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new Wy(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new Oh),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Oh),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Wy=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Ky=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},Oh=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new Ky,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function hb(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function fb(){return new j_([new Gy])}var j_=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||fb()),deps:[[e,new A_,new Yo]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new $(901,!1)}};e.\u0275prov=V({token:e,providedIn:"root",factory:fb});let t=e;return t})();function Fh(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(nr(s)),kr(s)&&Ij(s,r);let o=n.type;if(o&8)Fh(t,e,n.child,r);else if(o&32){let a=P_(n,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=WS(e,n);if(Array.isArray(a))r.push(...a);else{let u=zu(e[tr]);Fh(u[pe],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function Ij(t,e){for(let n=vn;n<t.length;n++){let r=t[n],i=r[pe].firstChild;i!==null&&Fh(r[pe],r,i,e)}t[ls]!==t[Pr]&&e.push(t[ls])}var eA=[];function Cj(t){return t[cs]??Dj(t)}function Dj(t){let e=eA.pop()??Object.create(bj);return e.lView=t,e}function Tj(t){t.lView[cs]!==t&&(t.lView=null,eA.push(t))}var bj=ue(x({},wT),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Gu(t.lView)},consumerOnSignalRead(){this.lView[cs]=this}});function tA(t){return rA(t[Hu])}function nA(t){return rA(t[On])}function rA(t){for(;t!==null&&!kr(t);)t=t[On];return t}var Sj="ngOriginalError";function vy(t){return t[Sj]}var rr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&vy(e);for(;n&&vy(n);)n=vy(n);return n||null}},iA=new F("",{providedIn:"root",factory:()=>k(rr).handleError.bind(void 0)});var sA=!1,Aj=new F("",{providedIn:"root",factory:()=>sA});var Zo={};function Ee(t=1){oA(Ln(),Le(),Qo()+t,!1)}function oA(t,e,n,r){if(!r)if((e[z]&3)===3){let s=t.preOrderCheckHooks;s!==null&&gh(e,s,n)}else{let s=t.preOrderHooks;s!==null&&mh(e,s,0,n)}ds(n)}function oe(t,e=se.Default){let n=Le();if(n===null)return I(t,e);let r=nn();return bS(r,n,Ot(t),e)}function aA(){let t="invalid";throw new Error(t)}function uA(t,e,n,r,i,s){let o=en(null);try{let a=null;i&Vt.SignalBased&&(a=e[r][vT]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Vt.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):eS(e,a,r,s)}finally{en(o)}}function xj(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)ds(~i);else{let s=i,o=n[++r],a=n[++r];jL(o,s);let u=e[s];a(2,u)}}}finally{ds(-1)}}function ef(t,e,n,r,i,s,o,a,u,c,l){let d=e.blueprint.slice();return d[Pr]=i,d[z]=r|4|128|8|64,(c!==null||t&&t[z]&2048)&&(d[z]|=2048),oS(d),d[St]=d[zo]=t,d[Fn]=n,d[Mr]=o||t&&t[Mr],d[Ct]=a||t&&t[Ct],d[jo]=u||t&&t[jo]||null,d[Vn]=s,d[zh]=k2(),d[Ih]=l,d[Zb]=c,d[tr]=e.type==2?t[tr]:d,d}function tf(t,e,n,r,i){let s=t.data[e];if(s===null)s=Mj(t,e,n,r,i),LL()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=kL();s.injectorIndex=o===null?-1:o.injectorIndex}return Ju(s,!0),s}function Mj(t,e,n,r,i){let s=cS(),o=lS(),a=o?s:s&&s.parent,u=t.data[e]=Oj(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function cA(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function lA(t,e,n,r,i){let s=Qo(),o=r&2;try{ds(-1),o&&e.length>ai&&oA(t,e,ai,!1),Jn(o?2:0,i),n(r,i)}finally{ds(s),Jn(o?3:1,i)}}function dA(t,e,n){if(Xb(e)){let r=en(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{en(r)}}}function hA(t,e,n){uS()&&($j(t,e,n,wn(n,e)),(n.flags&64)===64&&yA(t,e,n))}function fA(t,e,n=wn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function pA(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=U_(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function U_(t,e,n,r,i,s,o,a,u,c,l){let d=ai+r,h=d+i,f=Rj(d,h),p=typeof c=="function"?c():c;return f[pe]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:p,incompleteFirstPass:!1,ssrId:l}}function Rj(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:Zo);return n}function Nj(t,e,n,r){let s=r.get(Aj,sA)||n===er.ShadowDom,o=t.selectRootElement(e,s);return Pj(o),o}function Pj(t){kj(t)}var kj=()=>null;function Oj(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return RL()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function pb(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,u=Vt.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let c=s;if(i!==null){if(!i.hasOwnProperty(s))continue;c=i[s]}t===0?gb(r,n,c,a,u):gb(r,n,c,a)}return r}function gb(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function Fj(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],u=null,c=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;u=pb(0,d.inputs,l,u,f),c=pb(1,d.outputs,l,c,p);let g=u!==null&&o!==null&&!qb(e)?Xj(u,l,o):null;a.push(g)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=c}function Vj(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function Lj(t,e,n,r,i,s,o,a){let u=wn(e,n),c=e.inputs,l;!a&&c!=null&&(l=c[r])?(B_(t,n,l,r,i),Wh(e)&&jj(n,e.index)):e.type&3?(r=Vj(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(u,r,i)):e.type&12}function jj(t,e){let n=di(e,t);n[z]&16||(n[z]|=64)}function gA(t,e,n,r){if(uS()){let i=r===null?null:{"":-1},s=qj(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&mA(t,e,n,o,i,a),i&&Gj(n,r,i)}n.mergedAttrs=Bu(n.mergedAttrs,n.attrs)}function mA(t,e,n,r,i,s){for(let c=0;c<r.length;c++)ky(Ah(n,e),t,r[c].type);Wj(n,t.data.length,r.length);for(let c=0;c<r.length;c++){let l=r[c];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,u=cA(t,e,r.length,null);for(let c=0;c<r.length;c++){let l=r[c];n.mergedAttrs=Bu(n.mergedAttrs,l.hostAttrs),Kj(t,n,e,u,l),zj(u,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}Fj(t,n,s)}function Uj(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;Bj(o)!=a&&o.push(a),o.push(n,r,s)}}function Bj(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function $j(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;Wh(n)&&Qj(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Ah(n,e),fs(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let u=t.data[a],c=Bo(e,t,a,n);if(fs(c,e),o!==null&&Jj(e,a-i,c,u,n,o),ui(u)){let l=di(n.index,e);l[Fn]=Bo(e,t,a,n)}}}function yA(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=UL();try{ds(s);for(let a=r;a<i;a++){let u=t.data[a],c=e[a];Ny(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&Hj(u,c)}}finally{ds(-1),Ny(o)}}function Hj(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function qj(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(aL(e,o.selectors,!1))if(r||(r=[]),ui(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;Qy(t,e,u)}else r.unshift(o),Qy(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function Qy(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function Gj(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new $(-301,!1);r.push(e[i],s)}}}function zj(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;ui(e)&&(n[""]=t)}}function Wj(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Kj(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Uo(i.type,!0)),o=new hs(s,ui(i),oe);t.blueprint[r]=o,n[r]=o,Uj(t,e,r,cA(t,n,i.hostVars,Zo),i)}function Qj(t,e,n){let r=wn(e,t),i=pA(n),s=t[Mr].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=nf(t,ef(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function Yj(t,e,n,r,i,s){let o=wn(t,e);Zj(e[Ct],o,s,t.value,n,r,i)}function Zj(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?$h(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function Jj(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],c=o[a++],l=o[a++],d=o[a++];uA(r,n,u,c,l,d)}}function Xj(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function _A(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function vA(t,e){let n=t.contentQueries;if(n!==null){let r=en(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];dS(s),a.contentQueries(2,e[o],o)}}}finally{en(r)}}}function nf(t,e){return t[Hu]?t[tb][On]=e:t[Hu]=e,t[tb]=e,e}function Yy(t,e,n){dS(0);let r=en(null);try{e(t,n)}finally{en(r)}}function eU(t){return t[$u]||(t[$u]=[])}function tU(t){return t.cleanup||(t.cleanup=[])}function wA(t,e){let n=t[jo],r=n?n.get(rr,null):null;r&&r.handleError(e)}function B_(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],u=n[s++],c=e[o],l=t.data[o];uA(l,c,r,a,u,i)}}function nU(t,e,n){let r=iS(e,t);j2(t[Ct],r,n)}var EA=100;function IA(t,e=!0,n=0){let r=t[Mr],i=r.rendererFactory,s=!1;s||i.begin?.();try{rU(t,n)}catch(o){throw e&&wA(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function rU(t,e){Zy(t,e);let n=0;for(;__(t);){if(n===EA)throw new $(103,!1);n++,Zy(t,1)}}function iU(t,e,n,r){let i=e[z];if((i&256)===256)return;let s=!1;!s&&e[Mr].inlineEffectRunner?.flush(),w_(e);let o=null,a=null;!s&&sU(t)&&(a=Cj(e),o=ET(a));try{oS(e),FL(t.bindingStartIndex),n!==null&&lA(t,e,n,2,r);let u=(i&3)===3;if(!s)if(u){let d=t.preOrderCheckHooks;d!==null&&gh(e,d,null)}else{let d=t.preOrderHooks;d!==null&&mh(e,d,0,null),fy(e,0)}if(oU(e),CA(e,0),t.contentQueries!==null&&vA(t,e),!s)if(u){let d=t.contentCheckHooks;d!==null&&gh(e,d)}else{let d=t.contentHooks;d!==null&&mh(e,d,1),fy(e,1)}xj(t,e);let c=t.components;c!==null&&TA(e,c,0);let l=t.viewQuery;if(l!==null&&Yy(2,l,r),!s)if(u){let d=t.viewCheckHooks;d!==null&&gh(e,d)}else{let d=t.viewHooks;d!==null&&mh(e,d,2),fy(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[hy]){for(let d of e[hy])d();e[hy]=null}s||(e[z]&=-73)}catch(u){throw Gu(e),u}finally{a!==null&&(IT(a,o),Tj(a)),E_()}}function sU(t){return t.type!==2}function CA(t,e){for(let n=tA(t);n!==null;n=nA(n))for(let r=vn;r<n.length;r++){let i=n[r];DA(i,e)}}function oU(t){for(let e=tA(t);e!==null;e=nA(e)){if(!(e[z]&g_.HasTransplantedViews))continue;let n=e[Dh];for(let r=0;r<n.length;r++){let i=n[r],s=i[St];TL(i)}}}function aU(t,e,n){let r=di(e,t);DA(r,n)}function DA(t,e){y_(t)&&Zy(t,e)}function Zy(t,e){let r=t[pe],i=t[z],s=t[cs],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&qm(s)),s&&(s.dirty=!1),t[z]&=-9217,o)iU(r,t,r.template,t[Fn]);else if(i&8192){CA(t,1);let a=r.components;a!==null&&TA(t,a,1)}}function TA(t,e,n){for(let r=0;r<e.length;r++)aU(t,e[r],n)}function $_(t){for(t[Mr].changeDetectionScheduler?.notify();t;){t[z]|=64;let e=zu(t);if(mL(t)&&!e)return t;t=e}return null}var ps=class{get rootNodes(){let e=this._lView,n=e[pe];return Fh(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Fn]}set context(e){this._lView[Fn]=e}get destroyed(){return(this._lView[z]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[St];if(kr(e)){let n=e[Ch],r=n?n.indexOf(this):-1;r>-1&&(Uy(e,r),xh(n,r))}this._attachedToViewContainer=!1}GS(this._lView[pe],this._lView)}onDestroy(e){aS(this._lView,e)}markForCheck(){$_(this._cdRefInjectingView||this._lView)}detach(){this._lView[z]&=-129}reattach(){Ry(this._lView),this._lView[z]|=128}detectChanges(){this._lView[z]|=1024,IA(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new $(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,HS(this._lView[pe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new $(902,!1);this._appRef=e,Ry(this._lView)}},Jo=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=uU;let t=e;return t})();function uU(t){return cU(nn(),Le(),(t&16)===16)}function cU(t,e,n){if(Wh(t)&&!n){let r=di(t.index,e);return new ps(r,r)}else if(t.type&47){let r=e[tr];return new ps(r,e)}return null}var bA=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=lU,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),Jy=class extends bA{constructor(e){super(),this._lView=e}onDestroy(e){return aS(this._lView,e),()=>SL(this._lView,e)}};function lU(){return new Jy(Le())}var mb=new Set;function H_(t){mb.has(t)||(mb.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var Xy=class extends Ye{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=wy(s),i&&(i=wy(i)),o&&(o=wy(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof qe&&e.add(a),a}};function wy(t){return e=>{setTimeout(t,void 0,e)}}var ct=Xy;function yb(...t){}function dU(){let t=typeof Ft.requestAnimationFrame=="function",e=Ft[t?"requestAnimationFrame":"setTimeout"],n=Ft[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var le=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ct(!1),this.onMicrotaskEmpty=new ct(!1),this.onStable=new ct(!1),this.onError=new ct(!1),typeof Zone>"u")throw new $(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=dU().nativeRequestAnimationFrame,pU(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new $(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new $(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,hU,yb,yb);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},hU={};function q_(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function fU(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Ft,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,e_(t),t.isCheckStableRunning=!0,q_(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),e_(t))}function pU(t){let e=()=>{fU(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(gU(a))return n.invokeTask(i,s,o,a);try{return _b(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),vb(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return _b(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),vb(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,e_(t),q_(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function e_(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function _b(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function vb(t){t._nesting--,q_(t)}var t_=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ct,this.onMicrotaskEmpty=new ct,this.onStable=new ct,this.onError=new ct}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function gU(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function mU(t="zone.js",e){return t==="noop"?new t_:t==="zone.js"?new le(e):t}var Oo=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Oo||{}),yU={destroy(){}};function G_(t,e){!e&&x2(G_);let n=e?.injector??k(jn);if(!N2(n))return yU;H_("NgAfterNextRender");let r=n.get(z_),i=r.handler??=new r_,s=e?.phase??Oo.MixedReadWrite,o=()=>{i.unregister(u),a()},a=n.get(bA).onDestroy(o),u=new n_(n,s,()=>{o(),t()});return i.register(u),{destroy:o}}var n_=class{constructor(e,n,r){this.phase=n,this.callbackFn=r,this.zone=e.get(le),this.errorHandler=e.get(rr,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},r_=class{constructor(){this.executingCallbacks=!1,this.buckets={[Oo.EarlyRead]:new Set,[Oo.Write]:new Set,[Oo.MixedReadWrite]:new Set,[Oo.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},z_=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i();this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function _U(t,e){let n=di(e,t),r=n[pe];vU(r,n);let i=n[Pr];i!==null&&n[Ih]===null&&(n[Ih]=L_(i,n[jo])),W_(r,n,n[Fn])}function vU(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function W_(t,e,n){w_(e);try{let r=t.viewQuery;r!==null&&Yy(1,r,n);let i=t.template;i!==null&&lA(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&vA(t,e),t.staticViewQueries&&Yy(2,t.viewQuery,n);let s=t.components;s!==null&&wU(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[z]&=-5,E_()}}function wU(t,e){for(let n=0;n<e.length;n++)_U(t,e[n])}function i_(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=GT(i,a);else if(s==2){let u=a,c=e[++o];r=GT(r,u+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Vh=class extends Jh{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=oi(e);return new qo(n,this.ngModule)}};function wb(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function EU(t){let e=t.toLowerCase();return e==="svg"?wL:e==="math"?EL:null}var s_=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=qh(r);let i=this.injector.get(e,_y,r);return i!==_y||n===_y?i:this.parentInjector.get(e,n,r)}},qo=class extends kh{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=wb(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return wb(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=dL(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){i=i||this.ngModule;let s=i instanceof tn?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let o=s?new s_(e,s):e,a=o.get(Ku,null);if(a===null)throw new $(407,!1);let u=o.get(_j,null),c=o.get(z_,null),l=o.get($y,null),d={rendererFactory:a,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:c,changeDetectionScheduler:l},h=a.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=r?Nj(h,r,this.componentDef.encapsulation,o):$S(h,f,EU(f)),g=512;this.componentDef.signals?g|=4096:this.componentDef.onPush||(g|=16);let _=null;p!==null&&(_=L_(p,o,!0));let T=U_(0,null,null,1,0,null,null,null,null,null,null),P=ef(null,T,null,g,null,null,d,h,o,null,_);w_(P);let A,H;try{let G=this.componentDef,X,ke=null;G.findHostDirectiveDefs?(X=[],ke=new Map,G.findHostDirectiveDefs(G,X,ke),X.push(G)):X=[G];let hn=IU(P,p),Fm=CU(hn,p,G,X,P,d,h);H=sS(T,ai),p&&bU(h,G,p,r),n!==void 0&&SU(H,this.ngContentSelectors,n),A=TU(Fm,G,X,ke,P,[AU]),W_(T,P,null)}finally{E_()}return new o_(this.componentType,A,Xh(H,P),P,H)}},o_=class extends Hy{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new ps(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;B_(s[pe],s,i,e,n),this.previousInputValues.set(e,n);let o=di(this._tNode.index,s);$_(o)}}get injector(){return new us(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function IU(t,e){let n=t[pe],r=ai;return t[r]=e,tf(n,r,2,"#host",null)}function CU(t,e,n,r,i,s,o){let a=i[pe];DU(r,t,e,o);let u=null;e!==null&&(u=L_(e,i[jo]));let c=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=ef(i,pA(n),null,l,i[t.index],t,s,c,null,null,u);return a.firstCreatePass&&Qy(a,t,r.length-1),nf(i,d),i[t.index]=d}function DU(t,e,n,r){for(let i of t)e.mergedAttrs=Bu(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(i_(e,e.mergedAttrs,!0),n!==null&&QS(r,n,e))}function TU(t,e,n,r,i,s){let o=nn(),a=i[pe],u=wn(o,i);mA(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=Bo(i,a,d,o);fs(h,i)}yA(a,i,o),u&&fs(u,i);let c=Bo(i,a,o.directiveStart+o.componentOffset,o);if(t[Fn]=i[Fn]=c,s!==null)for(let l of s)l(c,e);return dA(a,o,t),c}function bU(t,e,n,r){if(r)xy(t,n,["ng-version","17.1.3"]);else{let{attrs:i,classes:s}=hL(e.selectors[0]);i&&xy(t,n,i),s&&s.length>0&&KS(t,n,s.join(" "))}}function SU(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function AU(){let t=nn();D_(Le()[pe],t)}function xU(t){return Object.getPrototypeOf(t.prototype).constructor}function Fr(t){let e=xU(t.type),n=!0,r=[t];for(;e;){let i;if(ui(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new $(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=hh(t.inputs),o.inputTransforms=hh(t.inputTransforms),o.declaredInputs=hh(t.declaredInputs),o.outputs=hh(t.outputs);let a=i.hostBindings;a&&kU(t,a);let u=i.viewQuery,c=i.contentQueries;if(u&&NU(t,u),c&&PU(t,c),MU(t,i),VV(t.outputs,i.outputs),ui(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===Fr&&(n=!1)}}e=Object.getPrototypeOf(e)}RU(r)}function MU(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function RU(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Bu(i.hostAttrs,n=Bu(n,i.hostAttrs))}}function hh(t){return t===Lo?{}:t===_n?[]:t}function NU(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function PU(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function kU(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function K_(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var uJ=new RegExp(`^(\\d+)*(${hj}|${dj})*(.*)`);var OU=()=>null;function Eb(t,e){return OU(t,e)}function FU(t,e,n,r){let i=e.tView,o=t[z]&4096?4096:16,a=ef(t,i,n,o,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),u=t[e.index];a[Gh]=u;let c=t[qu];return c!==null&&(a[qu]=c.createEmbeddedView(i)),W_(i,a,n),a}function Ib(t,e){return!e||e.firstChild===null||US(t)}function VU(t,e,n,r=!0){let i=e[pe];if(H2(i,e,t,n),r){let o=By(n,t),a=e[Ct],u=k_(a,t[ls]);u!==null&&B2(i,t[Vn],a,e,u,o)}let s=e[Ih];s!==null&&s.firstChild!==null&&(s.firstChild=null)}var tc=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=LU;let t=e;return t})();function LU(){let t=nn();return UU(t,Le())}var jU=tc,SA=class extends jU{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Xh(this._hostTNode,this._hostLView)}get injector(){return new us(this._hostTNode,this._hostLView)}get parentInjector(){let e=T_(this._hostTNode,this._hostLView);if(wS(e)){let n=Sh(e,this._hostLView),r=bh(e),i=n[pe].data[r+8];return new us(i,n)}else return new us(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=Cb(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-vn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Eb(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,Ib(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!u2(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let u=o?e:new qo(oi(e)),c=r||this.parentInjector;if(!s&&u.ngModule==null){let g=(o?c:this.parentInjector).get(tn,null);g&&(s=g)}let l=oi(u.componentType??{}),d=Eb(this._lContainer,l?.id??null),h=d?.firstChild??null,f=u.create(c,i,h,s);return this.insertImpl(f.hostView,a,Ib(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(DL(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[St],c=new SA(u,u[Vn],u[St]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return VU(o,i,s,r),e.attachToViewContainerRef(),MS(Ey(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=Cb(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=Uy(this._lContainer,n);r&&(xh(Ey(this._lContainer),n),GS(r[pe],r))}detach(e){let n=this._adjustIndex(e,-1),r=Uy(this._lContainer,n);return r&&xh(Ey(this._lContainer),n)!=null?new ps(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function Cb(t){return t[Ch]}function Ey(t){return t[Ch]||(t[Ch]=[])}function UU(t,e){let n,r=e[t.index];return kr(r)?n=r:(n=_A(r,e,null,t),e[t.index]=n,nf(e,n)),$U(n,e,t,r),new SA(n,t,e)}function BU(t,e){let n=t[Ct],r=n.createComment(""),i=wn(e,t),s=k_(n,i);return Nh(n,s,r,Y2(n,i),!1),r}var $U=GU,HU=()=>!1;function qU(t,e,n){return HU(t,e,n)}function GU(t,e,n,r){if(t[ls])return;let i;n.type&8?i=nr(r):i=BU(e,n),t[ls]=i}var ci=class{},Qu=class{};var Lh=class extends ci{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Vh(this);let i=Kb(e);this._bootstrapComponents=jS(i.bootstrap),this._r3Injector=VS(e,n,[{provide:ci,useValue:this},{provide:Jh,useValue:this.componentFactoryResolver},...r],Qt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},jh=class extends Qu{constructor(e){super(),this.moduleType=e}create(e){return new Lh(this.moduleType,e,[])}};function zU(t,e,n){return new Lh(t,e,n)}var a_=class extends ci{constructor(e){super(),this.componentFactoryResolver=new Vh(this),this.instance=null;let n=new Wu([...e.providers,{provide:ci,useValue:this},{provide:Jh,useValue:this.componentFactoryResolver}],e.parent||M_(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function rf(t,e,n=null){return new a_({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var sf=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Et(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function of(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function WU(t,e,n,r,i,s,o,a,u){let c=e.consts,l=tf(e,t,4,o||null,Th(c,a));gA(e,n,l,Th(c,u)),D_(e,l);let d=l.tView=U_(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function ys(t,e,n,r,i,s,o,a){let u=Le(),c=Ln(),l=t+ai,d=c.firstCreatePass?WU(l,c,u,e,n,r,i,s,o):c.data[l];Ju(d,!1);let h=KU(c,u,d,t);I_()&&O_(c,u,h,d),fs(h,u);let f=_A(h,u,h,d);return u[l]=f,nf(u,f),qU(f,d,u),m_(d)&&hA(c,u,d),o!=null&&fA(u,d,a),ys}var KU=QU;function QU(t,e,n,r){return C_(!0),e[Ct].createComment("")}function af(t,e,n,r){let i=Le(),s=v_();if(of(i,s,e)){let o=Ln(),a=yS();Yj(a,i,t,e,n,r)}return af}function YU(t,e,n,r){return of(t,v_(),n)?e+$h(n)+r:Zo}function fh(t,e){return t<<17|e<<2}function gs(t){return t>>17&32767}function ZU(t){return(t&2)==2}function JU(t,e){return t&131071|e<<17}function u_(t){return t|2}function Go(t){return(t&131068)>>2}function Iy(t,e){return t&-131069|e<<2}function XU(t){return(t&1)===1}function c_(t){return t|1}function eB(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=gs(o),u=Go(o);t[r]=n;let c=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||Xu(d,l)>0)&&(c=!0)}else l=n;if(i)if(u!==0){let h=gs(t[a+1]);t[r+1]=fh(h,a),h!==0&&(t[h+1]=Iy(t[h+1],r)),t[a+1]=JU(t[a+1],r)}else t[r+1]=fh(a,0),a!==0&&(t[a+1]=Iy(t[a+1],r)),a=r;else t[r+1]=fh(u,0),a===0?a=r:t[u+1]=Iy(t[u+1],r),u=r;c&&(t[r+1]=u_(t[r+1])),Db(t,l,r,!0),Db(t,l,r,!1),tB(e,l,t,r,s),o=fh(a,u),s?e.classBindings=o:e.styleBindings=o}function tB(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&Xu(s,e)>=0&&(n[r+1]=c_(n[r+1]))}function Db(t,e,n,r){let i=t[n+1],s=e===null,o=r?gs(i):Go(i),a=!1;for(;o!==0&&(a===!1||s);){let u=t[o],c=t[o+1];nB(u,e)&&(a=!0,t[o+1]=r?c_(c):u_(c)),o=r?gs(c):Go(c)}a&&(t[n+1]=r?u_(i):c_(i))}function nB(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?Xu(t,e)>=0:!1}function tt(t,e,n){let r=Le(),i=v_();if(of(r,i,e)){let s=Ln(),o=yS();Lj(s,o,r,t,e,r[Ct],n,!1)}return tt}function Tb(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";B_(t,n,s[o],o,r)}function Q_(t,e){return rB(t,e,null,!0),Q_}function rB(t,e,n,r){let i=Le(),s=Ln(),o=VL(2);if(s.firstUpdatePass&&sB(s,t,o,r),e!==Zo&&of(i,o,e)){let a=s.data[Qo()];lB(s,a,i,i[Ct],t,i[o+1]=dB(e,n),r,o)}}function iB(t,e){return e>=t.expandoStartIndex}function sB(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[Qo()],o=iB(t,n);hB(s,r)&&e===null&&!o&&(e=!1),e=oB(i,s,e,r),eB(i,s,e,n,o,r)}}function oB(t,e,n,r){let i=BL(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=Cy(null,t,e,n,r),n=Yu(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=Cy(i,t,e,n,r),s===null){let u=aB(t,e,r);u!==void 0&&Array.isArray(u)&&(u=Cy(null,t,e,u[1],r),u=Yu(u,e.attrs,r),uB(t,e,r,u))}else s=cB(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function aB(t,e,n){let r=n?e.classBindings:e.styleBindings;if(Go(r)!==0)return t[gs(r)]}function uB(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[gs(i)]=r}function cB(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=Yu(r,o,n)}return Yu(r,e.attrs,n)}function Cy(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=Yu(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Yu(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),l2(t,o,n?!0:e[++s]))}return t===void 0?null:t}function lB(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let u=t.data,c=u[a+1],l=XU(c)?bb(u,e,n,i,Go(c),o):void 0;if(!Uh(l)){Uh(s)||ZU(c)&&(s=bb(u,null,n,i,a,o));let d=iS(Qo(),n);rj(r,o,d,i,s)}}function bb(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let u=t[i],c=Array.isArray(u),l=c?u[1]:u,d=l===null,h=n[i+1];h===Zo&&(h=d?_n:void 0);let f=d?gy(h,r):l===r?h:void 0;if(c&&!Uh(f)&&(f=gy(u,r)),Uh(f)&&(a=f,o))return a;let p=t[i+1];i=o?gs(p):Go(p)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(a=gy(u,r))}return a}function Uh(t){return t!==void 0}function dB(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Qt(ec(t)))),t}function hB(t,e){return(t.flags&(e?8:16))!==0}function fB(t,e,n,r,i,s){let o=e.consts,a=Th(o,i),u=tf(e,t,2,r,a);return gA(e,n,u,Th(o,s)),u.attrs!==null&&i_(u,u.attrs,!1),u.mergedAttrs!==null&&i_(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function w(t,e,n,r){let i=Le(),s=Ln(),o=ai+t,a=i[Ct],u=s.firstCreatePass?fB(o,s,i,e,n,r):s.data[o],c=pB(s,i,u,a,e,t);i[o]=c;let l=m_(u);return Ju(u,!0),QS(a,c,u),(u.flags&32)!==32&&I_()&&O_(s,i,c,u),AL()===0&&fs(c,i),xL(),l&&(hA(s,i,u),dA(s,u,i)),r!==null&&fA(i,u),w}function D(){let t=nn();lS()?OL():(t=t.parent,Ju(t,!1));let e=t;NL(e)&&PL(),ML();let n=Ln();return n.firstCreatePass&&(D_(n,t),Xb(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&KL(e)&&Tb(n,e,Le(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&QL(e)&&Tb(n,e,Le(),e.stylesWithoutHost,!1),D}function xe(t,e,n,r){return w(t,e,n,r),D(),xe}var pB=(t,e,n,r,i,s)=>(C_(!0),$S(r,i,qL()));function Xo(){return Le()}var Bh="en-US";var gB=Bh;function mB(t){typeof t=="string"&&(gB=t.toLowerCase().replace(/_/g,"-"))}function _s(t){return!!t&&typeof t.then=="function"}function AA(t){return!!t&&typeof t.subscribe=="function"}function he(t,e,n,r){let i=Le(),s=Ln(),o=nn();return _B(s,i,i[Ct],o,t,e,r),he}function yB(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[$u],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function _B(t,e,n,r,i,s,o){let a=m_(r),c=t.firstCreatePass&&tU(t),l=e[Fn],d=eU(e),h=!0;if(r.type&3||o){let g=wn(r,e),_=o?o(g):g,T=d.length,P=o?H=>o(nr(H[r.index])):r.index,A=null;if(!o&&a&&(A=yB(t,e,i,r.index)),A!==null){let H=A.__ngLastListenerFn__||A;H.__ngNextListenerFn__=s,A.__ngLastListenerFn__=s,h=!1}else{s=Ab(r,e,l,s,!1);let H=n.listen(_,i,s);d.push(s,H),c&&c.push(i,P,T,T+1)}}else s=Ab(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let _=0;_<g;_+=2){let T=p[_],P=p[_+1],G=e[T][P].subscribe(s),X=d.length;d.push(s,G),c&&c.push(i,r.index,X,-(X+1))}}}function Sb(t,e,n,r){try{return Jn(6,e,n),n(r)!==!1}catch(i){return wA(t,i),!1}finally{Jn(7,e,n)}}function Ab(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?di(t.index,e):e;$_(a);let u=Sb(e,n,r,o),c=s.__ngNextListenerFn__;for(;c;)u=Sb(e,n,c,o)&&u,c=c.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}function ea(t=1){return HL(t)}var Y_=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=EB;let t=e;return t})(),vB=Y_,wB=class extends vB{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=FU(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new ps(i)}};function EB(){return IB(nn(),Le())}function IB(t,e){return t.type&4?new wB(e,t,Xh(t,e)):null}function b(t,e=""){let n=Le(),r=Ln(),i=t+ai,s=r.firstCreatePass?tf(r,i,1,e,null):r.data[i],o=CB(r,n,s,e,t);n[i]=o,I_()&&O_(r,n,o,s),Ju(s,!1)}var CB=(t,e,n,r,i)=>(C_(!0),L2(e[Ct],r));function Lt(t){return xA("",t,""),Lt}function xA(t,e,n){let r=Le(),i=YU(r,t,e,n);return i!==Zo&&nU(r,Qo(),i),xA}function DB(t,e,n){let r=Ln();if(r.firstCreatePass){let i=ui(t);l_(n,r.data,r.blueprint,i,!0),l_(e,r.data,r.blueprint,i,!1)}}function l_(t,e,n,r,i){if(t=Ot(t),Array.isArray(t))for(let s=0;s<t.length;s++)l_(t[s],e,n,r,i);else{let s=Ln(),o=Le(),a=nn(),u=Ho(t)?t:Ot(t.provide),c=FS(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Ho(t)||!t.multi){let f=new hs(c,i,oe),p=Ty(u,e,i?l:l+h,d);p===-1?(ky(Ah(a,o),s,u),Dy(s,t,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=Ty(u,e,l+h,d),p=Ty(u,e,l,l+h),g=f>=0&&n[f],_=p>=0&&n[p];if(i&&!_||!i&&!g){ky(Ah(a,o),s,u);let T=SB(i?bB:TB,n.length,i,r,c);!i&&_&&(n[p].providerFactory=T),Dy(s,t,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(T),o.push(T)}else{let T=MA(n[i?p:f],c,!i&&r);Dy(s,t,f>-1?f:p,T)}!i&&r&&_&&n[p].componentProviders++}}}function Dy(t,e,n,r){let i=Ho(e),s=I2(e);if(i||s){let u=(s?Ot(e.useClass):e).prototype.ngOnDestroy;if(u){let c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=c.indexOf(n);l===-1?c.push(n,[r,u]):c[l+1].push(r,u)}else c.push(n,u)}}}function MA(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function Ty(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function TB(t,e,n,r){return d_(this.multi,[])}function bB(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Bo(n,n[pe],this.providerFactory.index,r);s=a.slice(0,o),d_(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],d_(i,s);return s}function d_(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function SB(t,e,n,r,i){let s=new hs(t,n,oe);return s.multi=[],s.index=e,s.componentProviders=0,MA(s,i,r&&!n),s}function ta(t,e=[]){return n=>{n.providersResolver=(r,i)=>DB(r,i?i(t):t,e)}}var AB=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=PS(!1,r.type),s=i.length>0?rf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=V({token:e,providedIn:"environment",factory:()=>new e(I(tn))});let t=e;return t})();function RA(t){H_("NgStandalone"),t.getStandaloneInjector=e=>e.get(AB).getOrCreateStandaloneInjector(t)}var ph=null;function xB(t){ph!==null&&(t.defaultEncapsulation!==ph.defaultEncapsulation||t.preserveWhitespaces!==ph.preserveWhitespaces)||(ph=t)}var Nr=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},NA=new Nr("17.1.3"),uf=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),h_=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},cf=(()=>{let e=class e{compileModuleSync(r){return new jh(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=Kb(r),o=jS(s.declarations).reduce((a,u)=>{let c=oi(u);return c&&a.push(new qo(c)),a},[]);return new h_(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),MB=new F("");var Z_=new F(""),nc=new F(""),lf=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,J_||(RB(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{le.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(I(le),I(df),I(nc))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),df=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return J_?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function RB(t){J_=t}var J_,hf=new F(""),PA=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=k(hf,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(_s(o))r.push(o);else if(AA(o)){let a=new Promise((u,c)=>{o.subscribe({complete:u,error:c})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),X_=new F("");function NB(t,e,n){let r=new jh(n);return Promise.resolve(r)}function PB(){DT(()=>{throw new $(600,!1)})}function kB(t){return t.isBoundToModule}function OB(t,e,n){try{let r=n();return _s(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function kA(t,e){return Array.isArray(e)?e.reduce(kA,t):x(x({},t),e)}var na=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=k(iA),this.afterRenderEffectManager=k(z_),this.componentTypes=[],this.components=[],this.isStable=k(sf).hasPendingTasks.pipe(j(r=>!r)),this._injector=k(tn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof kh;if(!this._injector.get(PA).done){let f=!s&&Wb(r),p=!1;throw new $(405,p)}let a;s?a=r:a=this._injector.get(Jh).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let u=kB(a)?void 0:this._injector.get(ci),c=i||a.selector,l=a.create(jn.NULL,[],c,u),d=l.location.nativeElement,h=l.injector.get(Z_,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),vh(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new $(101,!1);try{this._runningTick=!0,this.detectChangesInAttachedViews()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1}}detectChangesInAttachedViews(){let r=0;do{if(r===EA)throw new $(103,!1);let i=r===0;for(let{_lView:s,notifyErrorHandler:o}of this._views)!i&&!Mb(s)||this.detectChangesInView(s,o,i);this.afterRenderEffectManager.execute(),r++}while(this._views.some(({_lView:i})=>Mb(i)))}detectChangesInView(r,i,s){let o;s?(o=0,r[z]|=1024):r[z]&64?o=0:o=1,IA(r,i,o)}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;vh(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(X_,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>vh(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new $(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function vh(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function xb(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}function Mb(t){return __(t)}var FB=(()=>{let e=class e{constructor(){this.zone=k(le),this.applicationRef=k(na)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function VB(t){return[{provide:le,useFactory:t},{provide:$o,multi:!0,useFactory:()=>{let e=k(FB,{optional:!0});return()=>e.initialize()}},{provide:$o,multi:!0,useFactory:()=>{let e=k(UB);return()=>{e.initialize()}}},{provide:iA,useFactory:LB}]}function LB(){let t=k(le),e=k(rr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function jB(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var UB=(()=>{let e=class e{constructor(){this.subscription=new qe,this.initialized=!1,this.zone=k(le),this.pendingTasks=k(sf)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{le.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{le.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function BB(){return typeof $localize<"u"&&$localize.locale||Bh}var ev=new F("",{providedIn:"root",factory:()=>k(ev,se.Optional|se.SkipSelf)||BB()});var OA=new F(""),FA=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=mU(i?.ngZone,jB({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=zU(r.moduleType,this.injector,VB(()=>s)),a=o.injector.get(rr,null);return s.runOutsideAngular(()=>{let u=s.onError.subscribe({next:c=>{a.handleError(c)}});o.onDestroy(()=>{vh(this._modules,o),u.unsubscribe()})}),OB(a,s,()=>{let u=o.injector.get(PA);return u.runInitializers(),u.donePromise.then(()=>{let c=o.injector.get(ev,Bh);return mB(c||Bh),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=kA({},i);return NB(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(na);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new $(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new $(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(OA,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(I(jn))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),ju=null,VA=new F("");function $B(t){if(ju&&!ju.get(VA,!1))throw new $(400,!1);PB(),ju=t;let e=t.get(FA);return GB(t),e}function tv(t,e,n=[]){let r=`Platform: ${e}`,i=new F(r);return(s=[])=>{let o=LA();if(!o||o.injector.get(VA,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):$B(HB(a,r))}return qB(i)}}function HB(t=[],e){return jn.create({name:e,providers:[{provide:Kh,useValue:"platform"},{provide:OA,useValue:new Set([()=>ju=null])},...t]})}function qB(t){let e=LA();if(!e)throw new $(401,!1);return e}function LA(){return ju?.get(FA)??null}function GB(t){t.get(R_,null)?.forEach(n=>n())}function nv(){return!1}var jA=tv(null,"core",[]),UA=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(I(na))},e.\u0275mod=et({type:e}),e.\u0275inj=Xe({});let t=e;return t})();function vs(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function BA(t){let e=oi(t);if(!e)return null;let n=new qo(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var GA=null;function sr(){return GA}function zA(t){GA??=t}var ff=class{},Zt=new F(""),ov=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>k(zB),providedIn:"platform"});let t=e;return t})(),WA=new F(""),zB=(()=>{let e=class e extends ov{constructor(){super(),this._doc=k(Zt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return sr().getBaseHref(this._doc)}onPopState(r){let i=sr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=sr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function av(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function $A(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Vr(t){return t&&t[0]!=="?"?"?"+t:t}var Lr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>k(uv),providedIn:"root"});let t=e;return t})(),KA=new F(""),uv=(()=>{let e=class e extends Lr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??k(Zt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return av(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Vr(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Vr(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Vr(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(I(ov),I(KA,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),QA=(()=>{let e=class e extends Lr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=av(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Vr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Vr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(I(ov),I(KA,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),ra=(()=>{let e=class e{constructor(r){this._subject=new ct,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=QB($A(HA(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Vr(i))}normalize(r){return e.stripTrailingSlash(KB(this._basePath,HA(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Vr(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Vr(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Vr,e.joinWithSlash=av,e.stripTrailingSlash=$A,e.\u0275fac=function(i){return new(i||e)(I(Lr))},e.\u0275prov=V({token:e,factory:()=>WB(),providedIn:"root"});let t=e;return t})();function WB(){return new ra(I(Lr))}function KB(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function HA(t){return t.replace(/\/index.html$/,"")}function QB(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function YA(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var rv=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},ia=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new rv(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let u=i.get(o);i.move(u,a),qA(u,s)}});for(let s=0,o=i.length;s<o;s++){let u=i.get(s).context;u.index=s,u.count=o,u.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);qA(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(oe(tc),oe(Y_),oe(j_))},e.\u0275dir=At({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function qA(t,e){t.context.$implicit=e.item}var ZA=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e}),e.\u0275inj=Xe({});let t=e;return t})(),cv="browser",YB="server";function ZB(t){return t===cv}function ws(t){return t===YB}var JA=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>ZB(k(xt))?new iv(k(Zt),window):new sv});let t=e;return t})(),iv=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=JB(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function JB(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var sv=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},pf=class{};var hv=class extends ff{constructor(){super(...arguments),this.supportsDOMEvents=!0}},fv=class t extends hv{static makeCurrent(){zA(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=e$();return n==null?null:t$(n)}resetBaseElement(){rc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return YA(document.cookie,e)}},rc=null;function e$(){return rc=rc||document.querySelector("base"),rc?rc.getAttribute("href"):null}function t$(t){return new URL(t,document.baseURI).pathname}var pv=class{addToWindow(e){Ft.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new $(5103,!1);return s},Ft.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ft.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=Ft.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Ft.frameworkStabilizers||(Ft.frameworkStabilizers=[]),Ft.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?sr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},n$=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),gv=new F(""),nx=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new $(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(I(gv),I(le))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),mf=class{constructor(e){this._doc=e}},lv="ng-app-id",rx=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=ws(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${lv}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(lv),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(lv,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(I(Zt),I(Qh),I(N_,8),I(xt))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),dv={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},yv=/%COMP%/g,ix="%COMP%",r$=`_nghost-${ix}`,i$=`_ngcontent-${ix}`,s$=!0,o$=new F("",{providedIn:"root",factory:()=>s$});function a$(t){return i$.replace(yv,t)}function u$(t){return r$.replace(yv,t)}function sx(t,e){return e.map(n=>n.replace(yv,t))}var XA=(()=>{let e=class e{constructor(r,i,s,o,a,u,c,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=ws(u),this.defaultRenderer=new ic(r,a,c,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===er.ShadowDom&&(i=ue(x({},i),{encapsulation:er.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof yf?s.applyToHost(r):s instanceof sc&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,u=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case er.Emulated:o=new yf(c,l,i,this.appId,d,a,u,h);break;case er.ShadowDom:return new mv(c,l,r,i,a,u,this.nonce,h);default:o=new sc(c,l,i,d,a,u,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(I(nx),I(rx),I(Qh),I(o$),I(Zt),I(xt),I(le),I(N_))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),ic=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(dv[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(ex(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(ex(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new $(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=dv[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=dv[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Rr.DashCase|Rr.Important)?e.style.setProperty(n,r,i&Rr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Rr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=sr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function ex(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var mv=class extends ic{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=sx(i.id,i.styles);for(let l of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},sc=class extends ic{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?sx(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},yf=class extends sc{constructor(e,n,r,i,s,o,a,u){let c=i+"-"+r.id;super(e,n,r,s,o,a,u,c),this.contentAttr=a$(c),this.hostAttr=u$(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},c$=(()=>{let e=class e extends mf{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(I(Zt))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),tx=["alt","control","meta","shift"],l$={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},d$={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},h$=(()=>{let e=class e extends mf{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>sr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),a="code."),tx.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=s,c.fullKey=a,c}static matchEventFullKeyCode(r,i){let s=l$[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),tx.forEach(a=>{if(a!==s){let u=d$[a];u(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(I(Zt))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function f$(){fv.makeCurrent()}function p$(){return new rr}function g$(){return LS(document),document}var m$=[{provide:xt,useValue:cv},{provide:R_,useValue:f$,multi:!0},{provide:Zt,useFactory:g$,deps:[]}],ox=tv(jA,"browser",m$),y$=new F(""),_$=[{provide:nc,useClass:pv,deps:[]},{provide:Z_,useClass:lf,deps:[le,df,nc]},{provide:lf,useClass:lf,deps:[le,df,nc]}],v$=[{provide:Kh,useValue:"root"},{provide:rr,useFactory:p$,deps:[]},{provide:gv,useClass:c$,multi:!0,deps:[Zt,le,xt]},{provide:gv,useClass:h$,multi:!0,deps:[Zt]},XA,rx,nx,{provide:Ku,useExisting:XA},{provide:pf,useClass:n$,deps:[]},[]],ax=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:Qh,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(I(y$,12))},e.\u0275mod=et({type:e}),e.\u0275inj=Xe({providers:[...v$,..._$],imports:[ZA,UA]});let t=e;return t})();var ux=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(I(Zt))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var te="primary",wc=Symbol("RouteTitle"),Iv=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function ca(t){return new Iv(t)}function w$(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function E$(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!or(t[n],e[n]))return!1;return!0}function or(t,e){let n=t?Cv(t):void 0,r=e?Cv(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!_x(t[i],e[i]))return!1;return!0}function Cv(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function _x(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function vx(t){return t.length>0?t[t.length-1]:null}function _i(t){return iy(t)?t:_s(t)?_e(Promise.resolve(t)):U(t)}var I$={exact:Ex,subset:Ix},wx={exact:C$,subset:D$,ignored:()=>!0};function lx(t,e,n){return I$[n.paths](t.root,e.root,n.matrixParams)&&wx[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function C$(t,e){return or(t,e)}function Ex(t,e,n){if(!Is(t.segments,e.segments)||!wf(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!Ex(t.children[r],e.children[r],n))return!1;return!0}function D$(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>_x(t[n],e[n]))}function Ix(t,e,n){return Cx(t,e,e.segments,n)}function Cx(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Is(i,n)||e.hasChildren()||!wf(i,n,r))}else if(t.segments.length===n.length){if(!Is(t.segments,n)||!wf(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!Ix(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Is(t.segments,i)||!wf(t.segments,i,r)||!t.children[te]?!1:Cx(t.children[te],e,s,r)}}function wf(t,e,n){return e.every((r,i)=>wx[n](t[i].parameters,r.parameters))}var pi=class{constructor(e=new Ie([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ca(this.queryParams),this._queryParamMap}toString(){return S$.serialize(this)}},Ie=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ef(this)}},Es=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=ca(this.parameters),this._parameterMap}toString(){return Tx(this)}};function T$(t,e){return Is(t,e)&&t.every((n,r)=>or(n.parameters,e[r].parameters))}function Is(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function b$(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===te&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==te&&(n=n.concat(e(i,r)))}),n}var Ec=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new hc,providedIn:"root"});let t=e;return t})(),hc=class{parse(e){let n=new Tv(e);return new pi(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${oc(e.root,!0)}`,r=M$(e.queryParams),i=typeof e.fragment=="string"?`#${A$(e.fragment)}`:"";return`${n}${r}${i}`}},S$=new hc;function Ef(t){return t.segments.map(e=>Tx(e)).join("/")}function oc(t,e){if(!t.hasChildren())return Ef(t);if(e){let n=t.children[te]?oc(t.children[te],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==te&&r.push(`${i}:${oc(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=b$(t,(r,i)=>i===te?[oc(t.children[te],!1)]:[`${i}:${oc(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[te]!=null?`${Ef(t)}/${n[0]}`:`${Ef(t)}/(${n.join("//")})`}}function Dx(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function _f(t){return Dx(t).replace(/%3B/gi,";")}function A$(t){return encodeURI(t)}function Dv(t){return Dx(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function If(t){return decodeURIComponent(t)}function dx(t){return If(t.replace(/\+/g,"%20"))}function Tx(t){return`${Dv(t.path)}${x$(t.parameters)}`}function x$(t){return Object.entries(t).map(([e,n])=>`;${Dv(e)}=${Dv(n)}`).join("")}function M$(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${_f(n)}=${_f(i)}`).join("&"):`${_f(n)}=${_f(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var R$=/^[^\/()?;#]+/;function _v(t){let e=t.match(R$);return e?e[0]:""}var N$=/^[^\/()?;=#]+/;function P$(t){let e=t.match(N$);return e?e[0]:""}var k$=/^[^=?&#]+/;function O$(t){let e=t.match(k$);return e?e[0]:""}var F$=/^[^&#]+/;function V$(t){let e=t.match(F$);return e?e[0]:""}var Tv=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ie([],{}):new Ie([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[te]=new Ie(e,n)),r}parseSegment(){let e=_v(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new $(4009,!1);return this.capture(e),new Es(If(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=P$(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=_v(this.remaining);i&&(r=i,this.capture(r))}e[If(n)]=If(r)}parseQueryParam(e){let n=O$(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=V$(this.remaining);o&&(r=o,this.capture(r))}let i=dx(n),s=dx(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=_v(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new $(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=te);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[te]:new Ie([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new $(4011,!1)}};function bx(t){return t.segments.length>0?new Ie([],{[te]:t}):t}function Sx(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=Sx(i);if(r===te&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ie(t.segments,e);return L$(n)}function L$(t){if(t.numberOfChildren===1&&t.children[te]){let e=t.children[te];return new Ie(t.segments.concat(e.segments),e.children)}return t}function la(t){return t instanceof pi}function j$(t,e,n=null,r=null){let i=Ax(t);return xx(i,e,n,r)}function Ax(t){let e;function n(s){let o={};for(let u of s.children){let c=n(u);o[u.outlet]=c}let a=new Ie(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=bx(r);return e??i}function xx(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return vv(i,i,i,n,r);let s=U$(e);if(s.toRoot())return vv(i,i,new Ie([],{}),n,r);let o=B$(s,i,t),a=o.processChildren?cc(o.segmentGroup,o.index,s.commands):Rx(o.segmentGroup,o.index,s.commands);return vv(i,o.segmentGroup,a,n,r)}function Cf(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function fc(t){return typeof t=="object"&&t!=null&&t.outlets}function vv(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([u,c])=>{s[u]=Array.isArray(c)?c.map(l=>`${l}`):`${c}`});let o;t===e?o=n:o=Mx(t,e,n);let a=bx(Sx(o));return new pi(a,s,i)}function Mx(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=Mx(s,e,n)}),new Ie(t.segments,r)}var Df=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&Cf(r[0]))throw new $(4003,!1);let i=r.find(fc);if(i&&i!==vx(r))throw new $(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function U$(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Df(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,c])=>{a[u]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Df(n,e,r)}var aa=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function B$(t,e,n){if(t.isAbsolute)return new aa(e,!0,0);if(!n)return new aa(e,!1,NaN);if(n.parent===null)return new aa(n,!0,0);let r=Cf(t.commands[0])?0:1,i=n.segments.length-1+r;return $$(n,i,t.numberOfDoubleDots)}function $$(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new $(4005,!1);i=r.segments.length}return new aa(r,!1,i-s)}function H$(t){return fc(t[0])?t[0].outlets:{[te]:t}}function Rx(t,e,n){if(t??=new Ie([],{}),t.segments.length===0&&t.hasChildren())return cc(t,e,n);let r=q$(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ie(t.segments.slice(0,r.pathIndex),{});return s.children[te]=new Ie(t.segments.slice(r.pathIndex),t.children),cc(s,0,i)}else return r.match&&i.length===0?new Ie(t.segments,{}):r.match&&!t.hasChildren()?bv(t,e,n):r.match?cc(t,0,i):bv(t,e,n)}function cc(t,e,n){if(n.length===0)return new Ie(t.segments,{});{let r=H$(n),i={};if(Object.keys(r).some(s=>s!==te)&&t.children[te]&&t.numberOfChildren===1&&t.children[te].segments.length===0){let s=cc(t.children[te],e,n);return new Ie(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=Rx(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ie(t.segments,i)}}function q$(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(fc(a))break;let u=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&u===void 0)break;if(u&&c&&typeof c=="object"&&c.outlets===void 0){if(!fx(u,c,o))return s;r+=2}else{if(!fx(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function bv(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(fc(s)){let u=G$(s.outlets);return new Ie(r,u)}if(i===0&&Cf(n[0])){let u=t.segments[e];r.push(new Es(u.path,hx(n[0]))),i++;continue}let o=fc(s)?s.outlets[te]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&Cf(a)?(r.push(new Es(o,hx(a))),i+=2):(r.push(new Es(o,{})),i++)}return new Ie(r,{})}function G$(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=bv(new Ie([],{}),0,r))}),e}function hx(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function fx(t,e,n){return t==n.path&&or(e,n.parameters)}var lc="imperative",ht=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(ht||{}),In=class{constructor(e,n){this.id=e,this.url=n}},da=class extends In{constructor(e,n,r="imperative",i=null){super(e,n),this.type=ht.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ar=class extends In{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=ht.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},En=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(En||{}),Tf=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Tf||{}),gi=class extends In{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=ht.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},mi=class extends In{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=ht.NavigationSkipped}},pc=class extends In{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=ht.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},bf=class extends In{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=ht.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Sv=class extends In{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=ht.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Av=class extends In{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=ht.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},xv=class extends In{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=ht.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Mv=class extends In{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=ht.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Rv=class{constructor(e){this.route=e,this.type=ht.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Nv=class{constructor(e){this.route=e,this.type=ht.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Pv=class{constructor(e){this.snapshot=e,this.type=ht.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},kv=class{constructor(e){this.snapshot=e,this.type=ht.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ov=class{constructor(e){this.snapshot=e,this.type=ht.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Fv=class{constructor(e){this.snapshot=e,this.type=ht.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Sf=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=ht.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},gc=class{},mc=class{constructor(e){this.url=e}};var Vv=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ic,this.attachRef=null}},Ic=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new Vv,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Af=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=Lv(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=Lv(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=jv(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return jv(e,this._root).map(n=>n.value)}};function Lv(t,e){if(t===e.value)return e;for(let n of e.children){let r=Lv(t,n);if(r)return r}return null}function jv(t,e){if(t===e.value)return[e];for(let n of e.children){let r=jv(t,n);if(r.length)return r.unshift(e),r}return[]}var rn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function oa(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var xf=class extends Af{constructor(e,n){super(e),this.snapshot=n,Qv(this,e)}toString(){return this.snapshot.toString()}};function Nx(t){let e=z$(t),n=new Et([new Es("",{})]),r=new Et({}),i=new Et({}),s=new Et({}),o=new Et(""),a=new Cs(n,r,s,o,i,te,t,e.root);return a.snapshot=e.root,new xf(new rn(a,[]),e)}function z$(t){let e={},n={},r={},i="",s=new yc([],e,r,i,n,te,t,null,{});return new Mf("",new rn(s,[]))}var Cs=class{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(j(c=>c[wc]))??U(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(j(e=>ca(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(j(e=>ca(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Kv(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:x(x({},e.params),t.params),data:x(x({},e.data),t.data),resolve:x(x(x(x({},t.data),e.data),i?.data),t._resolvedData)}:r={params:x({},t.params),data:x({},t.data),resolve:x(x({},t.data),t._resolvedData??{})},i&&kx(i)&&(r.resolve[wc]=i.title),r}var yc=class{get title(){return this.data?.[wc]}constructor(e,n,r,i,s,o,a,u,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ca(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ca(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Mf=class extends Af{constructor(e,n){super(n),this.url=e,Qv(this,n)}toString(){return Px(this._root)}};function Qv(t,e){e.value._routerState=t,e.children.forEach(n=>Qv(t,n))}function Px(t){let e=t.children.length>0?` { ${t.children.map(Px).join(", ")} } `:"";return`${t.value}${e}`}function wv(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,or(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),or(e.params,n.params)||t.paramsSubject.next(n.params),E$(e.url,n.url)||t.urlSubject.next(n.url),or(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function Uv(t,e){let n=or(t.params,e.params)&&T$(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||Uv(t.parent,e.parent))}function kx(t){return typeof t.title=="string"||t.title===null}var Yv=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=te,this.activateEvents=new ct,this.deactivateEvents=new ct,this.attachEvents=new ct,this.detachEvents=new ct,this.parentContexts=k(Ic),this.location=k(tc),this.changeDetector=k(Jo),this.environmentInjector=k(tn),this.inputBinder=k(Of,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new $(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new $(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new $(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new $(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new Bv(r,u,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=At({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ms]});let t=e;return t})(),Bv=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Cs?this.route:e===Ic?this.childContexts:this.parent.get(e,n)}},Of=new F(""),px=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Pu([i.queryParams,i.params,i.data]).pipe(Oe(([o,a,u],c)=>(u=x(x(x({},o),a),u),c===0?U(u):Promise.resolve(u)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=BA(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:u}of a.inputs)r.activatedComponentRef.setInput(u,o[u])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function W$(t,e,n){let r=_c(t,e._root,n?n._root:void 0);return new xf(r,e)}function _c(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=K$(t,e,n);return new rn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>_c(t,a)),o}}let r=Q$(e.value),i=e.children.map(s=>_c(t,s));return new rn(r,i)}}function K$(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return _c(t,r,i);return _c(t,r)})}function Q$(t){return new Cs(new Et(t.url),new Et(t.params),new Et(t.queryParams),new Et(t.fragment),new Et(t.data),t.outlet,t.component,t)}var Ox="ngNavigationCancelingError";function Fx(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=la(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Vx(!1,En.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function Vx(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[Ox]=!0,n.cancellationCode=e,n}function Y$(t){return Lx(t)&&la(t.url)}function Lx(t){return!!t&&t[Ox]}var Z$=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Yt({type:e,selectors:[["ng-component"]],standalone:!0,features:[RA],decls:1,vars:0,template:function(i,s){i&1&&xe(0,"router-outlet")},dependencies:[Yv],encapsulation:2});let t=e;return t})();function J$(t,e){return t.providers&&!t._injector&&(t._injector=rf(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Zv(t){let e=t.children&&t.children.map(Zv),n=e?ue(x({},t),{children:e}):x({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==te&&(n.component=Z$),n}function ur(t){return t.outlet||te}function X$(t,e){let n=t.filter(r=>ur(r)===e);return n.push(...t.filter(r=>ur(r)!==e)),n}function Cc(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var eH=(t,e,n,r)=>j(i=>(new $v(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),$v=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),wv(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=oa(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=oa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=oa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=oa(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Fv(s.value.snapshot))}),e.children.length&&this.forwardEvent(new kv(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(wv(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),wv(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Cc(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Rf=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ua=class{constructor(e,n){this.component=e,this.route=n}};function tH(t,e,n){let r=t._root,i=e?e._root:null;return ac(r,i,n,[r.value])}function nH(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function fa(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!kb(t)?t:e.get(t):r}function ac(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=oa(e);return t.children.forEach(o=>{rH(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>dc(a,n.getContext(o),i)),i}function rH(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=iH(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new Rf(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?ac(t,e,a?a.children:null,r,i):ac(t,e,n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new ua(a.outlet.component,o))}else o&&dc(e,a,i),i.canActivateChecks.push(new Rf(r)),s.component?ac(t,null,a?a.children:null,r,i):ac(t,null,n,r,i);return i}function iH(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Is(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Is(t.url,e.url)||!or(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Uv(t,e)||!or(t.queryParams,e.queryParams);case"paramsChange":default:return!Uv(t,e)}}function dc(t,e,n){let r=oa(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?dc(o,e.children.getContext(s),n):dc(o,null,n):dc(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new ua(e.outlet.component,i)):n.canDeactivateChecks.push(new ua(null,i)):n.canDeactivateChecks.push(new ua(null,i))}function Dc(t){return typeof t=="function"}function sH(t){return typeof t=="boolean"}function oH(t){return t&&Dc(t.canLoad)}function aH(t){return t&&Dc(t.canActivate)}function uH(t){return t&&Dc(t.canActivateChild)}function cH(t){return t&&Dc(t.canDeactivate)}function lH(t){return t&&Dc(t.canMatch)}function jx(t){return t instanceof Ar||t?.name==="EmptyError"}var vf=Symbol("INITIAL_VALUE");function ha(){return Oe(t=>Pu(t.map(e=>e.pipe(xr(1),os(vf)))).pipe(j(e=>{for(let n of e)if(n!==!0){if(n===vf)return vf;if(n===!1||n instanceof pi)return n}return!0}),It(e=>e!==vf),xr(1)))}function dH(t,e){return Ze(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?U(ue(x({},n),{guardsResult:!0})):hH(o,r,i,t).pipe(Ze(a=>a&&sH(a)?fH(r,s,t,e):U(a)),j(a=>ue(x({},n),{guardsResult:a})))})}function hH(t,e,n,r){return _e(t).pipe(Ze(i=>_H(i.component,i.route,n,e,r)),mn(i=>i!==!0,!0))}function fH(t,e,n,r){return _e(e).pipe(ss(i=>xo(gH(i.route.parent,r),pH(i.route,r),yH(t,i.path,n),mH(t,i.route,n))),mn(i=>i!==!0,!0))}function pH(t,e){return t!==null&&e&&e(new Ov(t)),U(!0)}function gH(t,e){return t!==null&&e&&e(new Pv(t)),U(!0)}function mH(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return U(!0);let i=r.map(s=>oh(()=>{let o=Cc(e)??n,a=fa(s,o),u=aH(a)?a.canActivate(e,t):fi(o,()=>a(e,t));return _i(u).pipe(mn())}));return U(i).pipe(ha())}function yH(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>nH(o)).filter(o=>o!==null).map(o=>oh(()=>{let a=o.guards.map(u=>{let c=Cc(o.node)??n,l=fa(u,c),d=uH(l)?l.canActivateChild(r,t):fi(c,()=>l(r,t));return _i(d).pipe(mn())});return U(a).pipe(ha())}));return U(s).pipe(ha())}function _H(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return U(!0);let o=s.map(a=>{let u=Cc(e)??i,c=fa(a,u),l=cH(c)?c.canDeactivate(t,e,n,r):fi(u,()=>c(t,e,n,r));return _i(l).pipe(mn())});return U(o).pipe(ha())}function vH(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return U(!0);let s=i.map(o=>{let a=fa(o,t),u=oH(a)?a.canLoad(e,n):fi(t,()=>a(e,n));return _i(u)});return U(s).pipe(ha(),Ux(r))}function Ux(t){return Jm(Je(e=>{if(la(e))throw Fx(t,e)}),j(e=>e===!0))}function wH(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return U(!0);let s=i.map(o=>{let a=fa(o,t),u=lH(a)?a.canMatch(e,n):fi(t,()=>a(e,n));return _i(u)});return U(s).pipe(ha(),Ux(r))}var vc=class{constructor(e){this.segmentGroup=e||null}},Nf=class extends Error{constructor(e){super(),this.urlTree=e}};function sa(t){return Ao(new vc(t))}function EH(t){return Ao(new $(4e3,!1))}function IH(t){return Ao(Vx(!1,En.GuardRejected))}var Hv=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return U(r);if(i.numberOfChildren>1||!i.children[te])return EH(e.redirectTo);i=i.children[te]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Nf(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new pi(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new Ie(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new $(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},qv={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function CH(t,e,n,r,i){let s=Jv(t,e,n);return s.matched?(r=J$(e,r),wH(r,e,n,i).pipe(j(o=>o===!0?s:x({},qv)))):U(s)}function Jv(t,e,n){if(e.path==="**")return DH(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?x({},qv):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||w$)(n,t,e);if(!i)return x({},qv);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?x(x({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function DH(t){return{matched:!0,parameters:t.length>0?vx(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function gx(t,e,n,r){return n.length>0&&SH(t,n,r)?{segmentGroup:new Ie(e,bH(r,new Ie(n,t.children))),slicedSegments:[]}:n.length===0&&AH(t,n,r)?{segmentGroup:new Ie(t.segments,TH(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ie(t.segments,t.children),slicedSegments:n}}function TH(t,e,n,r){let i={};for(let s of n)if(Ff(t,e,s)&&!r[ur(s)]){let o=new Ie([],{});i[ur(s)]=o}return x(x({},r),i)}function bH(t,e){let n={};n[te]=e;for(let r of t)if(r.path===""&&ur(r)!==te){let i=new Ie([],{});n[ur(r)]=i}return n}function SH(t,e,n){return n.some(r=>Ff(t,e,r)&&ur(r)!==te)}function AH(t,e,n){return n.some(r=>Ff(t,e,r))}function Ff(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function xH(t,e,n,r){return ur(t)!==r&&(r===te||!Ff(e,n,t))?!1:Jv(e,t,n).matched}function MH(t,e,n){return e.length===0&&!t.children[n]}var Gv=class{};function RH(t,e,n,r,i,s,o="emptyOnly"){return new zv(t,e,n,r,i,o,s).recognize()}var NH=31,zv=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Hv(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new $(4002,`'${e.segmentGroup}'`)}recognize(){let e=gx(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(j(n=>{let r=new yc([],Object.freeze({}),Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,{},te,this.rootComponentType,null,{}),i=new rn(r,n),s=new Mf("",i),o=j$(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,te).pipe(ni(r=>{if(r instanceof Nf)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof vc?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=Kv(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(j(s=>s instanceof rn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return _e(i).pipe(ss(s=>{let o=r.children[s],a=X$(n,s);return this.processSegmentGroup(e,a,o,s)}),Zn((s,o)=>(s.push(...o),s)),ri(null),ay(),Ze(s=>{if(s===null)return sa(r);let o=Bx(s);return PH(o),U(o)}))}processSegment(e,n,r,i,s,o){return _e(n).pipe(ss(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(ni(u=>{if(u instanceof vc)return U(null);throw u}))),mn(a=>!!a),ni(a=>{if(jx(a))return MH(r,i,s)?U(new Gv):sa(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return xH(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):sa(i):sa(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:c,remainingSegments:l}=Jv(n,i,s);if(!a)return sa(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>NH&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,c);return this.applyRedirects.lineralizeSegments(i,d).pipe(Ze(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=CH(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Oe(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Oe(({routes:u})=>{let c=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new yc(l,h,Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,OH(r),ur(r),r.component??r._loadedComponent??null,r,FH(r)),{segmentGroup:p,slicedSegments:g}=gx(n,l,d,u);if(g.length===0&&p.hasChildren())return this.processChildren(c,u,p).pipe(j(T=>T===null?null:new rn(f,T)));if(u.length===0&&g.length===0)return U(new rn(f,[]));let _=ur(r)===s;return this.processSegment(c,u,p,g,_?te:s,!0).pipe(j(T=>new rn(f,T instanceof rn?[T]:[])))}))):sa(n)))}getChildConfig(e,n,r){return n.children?U({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?U({routes:n._loadedRoutes,injector:n._loadedInjector}):vH(e,n,r,this.urlSerializer).pipe(Ze(i=>i?this.configLoader.loadChildren(e,n).pipe(Je(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):IH(n))):U({routes:[],injector:e})}};function PH(t){t.sort((e,n)=>e.value.outlet===te?-1:n.value.outlet===te?1:e.value.outlet.localeCompare(n.value.outlet))}function kH(t){let e=t.value.routeConfig;return e&&e.path===""}function Bx(t){let e=[],n=new Set;for(let r of t){if(!kH(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=Bx(r.children);e.push(new rn(r.value,i))}return e.filter(r=>!n.has(r))}function OH(t){return t.data||{}}function FH(t){return t.resolve||{}}function VH(t,e,n,r,i,s){return Ze(o=>RH(t,e,n,r,o.extractedUrl,i,s).pipe(j(({state:a,tree:u})=>ue(x({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function LH(t,e){return Ze(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return U(n);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let c of $x(u))o.add(c);let a=0;return _e(o).pipe(ss(u=>s.has(u)?jH(u,r,t,e):(u.data=Kv(u,u.parent,t).resolve,U(void 0))),Je(()=>a++),Ro(1),Ze(u=>a===o.size?U(n):Wt))})}function $x(t){let e=t.children.map(n=>$x(n)).flat();return[t,...e]}function jH(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!kx(i)&&(s[wc]=i.title),UH(s,t,e,r).pipe(j(o=>(t._resolvedData=o,t.data=Kv(t,t.parent,n).resolve,null)))}function UH(t,e,n,r){let i=Cv(t);if(i.length===0)return U({});let s={};return _e(i).pipe(Ze(o=>BH(t[o],e,n,r).pipe(mn(),Je(a=>{s[o]=a}))),Ro(1),oy(s),ni(o=>jx(o)?Wt:Ao(o)))}function BH(t,e,n,r){let i=Cc(e)??r,s=fa(t,i),o=s.resolve?s.resolve(e,n):fi(i,()=>s(e,n));return _i(o)}function Ev(t){return Oe(e=>{let n=t(e);return n?_e(n).pipe(j(()=>e)):U(e)})}var Hx=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===te);return i}getResolvedTitleForRoute(r){return r.data[wc]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>k($H),providedIn:"root"});let t=e;return t})(),$H=(()=>{let e=class e extends Hx{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(I(ux))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Tc=new F("",{providedIn:"root",factory:()=>({})}),Pf=new F(""),Xv=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=k(cf)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return U(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=_i(r.loadComponent()).pipe(j(qx),Je(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Ou(()=>{this.componentLoaders.delete(r)})),s=new Co(i,()=>new Ye).pipe(Io());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return U({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=HH(i,this.compiler,r,this.onLoadEndListener).pipe(Ou(()=>{this.childrenLoaders.delete(i)})),a=new Co(o,()=>new Ye).pipe(Io());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function HH(t,e,n,r){return _i(t.loadChildren()).pipe(j(qx),Ze(i=>i instanceof Qu||Array.isArray(i)?U(i):_e(e.compileModuleAsync(i))),j(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Pf,[],{optional:!0,self:!0}).flat()),{routes:o.map(Zv),injector:s}}))}function qH(t){return t&&typeof t=="object"&&"default"in t}function qx(t){return qH(t)?t.default:t}var ew=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>k(GH),providedIn:"root"});let t=e;return t})(),GH=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Gx=new F(""),zx=new F("");function zH(t,e,n){let r=t.get(zx),i=t.get(Zt);return t.get(le).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(c=>{s=c}),a=i.startViewTransition(()=>(s(),WH(t))),{onViewTransitionCreated:u}=r;return u&&fi(t,()=>u({transition:a,from:e,to:n})),o})}function WH(t){return new Promise(e=>{G_(e,{injector:t})})}var tw=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ye,this.transitionAbortSubject=new Ye,this.configLoader=k(Xv),this.environmentInjector=k(tn),this.urlSerializer=k(Ec),this.rootContexts=k(Ic),this.location=k(ra),this.inputBindingEnabled=k(Of,{optional:!0})!==null,this.titleStrategy=k(Hx),this.options=k(Tc,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=k(ew),this.createViewTransition=k(Gx,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>U(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Rv(s)),i=s=>this.events.next(new Nv(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ue(x(x({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Et({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:lc,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(It(o=>o.id!==0),j(o=>ue(x({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Oe(o=>{this.currentTransition=o;let a=!1,u=!1;return U(o).pipe(Je(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?ue(x({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Oe(c=>{let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new mi(c.id,this.urlSerializer.serialize(c.rawUrl),h,Tf.IgnoredSameUrlNavigation)),c.resolve(null),Wt}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return U(c).pipe(Oe(h=>{let f=this.transitions?.getValue();return this.events.next(new da(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Wt:Promise.resolve(h)}),VH(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Je(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ue(x({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new bf(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:_}=c,T=new da(h,this.urlSerializer.serialize(f),p,g);this.events.next(T);let P=Nx(this.rootComponentType).snapshot;return this.currentTransition=o=ue(x({},c),{targetSnapshot:P,urlAfterRedirects:f,extras:ue(x({},_),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,U(o)}else{let h="";return this.events.next(new mi(c.id,this.urlSerializer.serialize(c.extractedUrl),h,Tf.IgnoredByUrlHandlingStrategy)),c.resolve(null),Wt}}),Je(c=>{let l=new Sv(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),j(c=>(this.currentTransition=o=ue(x({},c),{guards:tH(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),dH(this.environmentInjector,c=>this.events.next(c)),Je(c=>{if(o.guardsResult=c.guardsResult,la(c.guardsResult))throw Fx(this.urlSerializer,c.guardsResult);let l=new Av(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),It(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",En.GuardRejected),!1)),Ev(c=>{if(c.guards.canActivateChecks.length)return U(c).pipe(Je(l=>{let d=new xv(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Oe(l=>{let d=!1;return U(l).pipe(LH(this.paramsInheritanceStrategy,this.environmentInjector),Je({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",En.NoDataFromResolver)}}))}),Je(l=>{let d=new Mv(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),Ev(c=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(Je(f=>{d.component=f}),j(()=>{})));for(let f of d.children)h.push(...l(f));return h};return Pu(l(c.targetSnapshot.root)).pipe(ri(null),xr(1))}),Ev(()=>this.afterPreactivation()),Oe(()=>{let{currentSnapshot:c,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?_e(d).pipe(j(()=>o)):U(o)}),j(c=>{let l=W$(r.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=ue(x({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),Je(()=>{this.events.next(new gc)}),eH(this.rootContexts,r.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),xr(1),Je({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ar(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),ly(this.transitionAbortSubject.pipe(Je(c=>{throw c}))),Ou(()=>{!a&&!u&&this.cancelNavigationTransition(o,"",En.SupersededByNewNavigation),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),ni(c=>{if(u=!0,Lx(c))this.events.next(new gi(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),Y$(c)?this.events.next(new mc(c.url)):o.resolve(!1);else{this.events.next(new pc(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return Wt}))}))}cancelNavigationTransition(r,i,s){let o=new gi(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function KH(t){return t!==lc}var QH=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>k(YH),providedIn:"root"});let t=e;return t})(),Wv=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},YH=(()=>{let e=class e extends Wv{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=hi(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Wx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>k(ZH),providedIn:"root"});let t=e;return t})(),ZH=(()=>{let e=class e extends Wx{constructor(){super(...arguments),this.location=k(ra),this.urlSerializer=k(Ec),this.options=k(Tc,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=k(ew),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new pi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Nx(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof da)this.stateMemento=this.createStateMemento();else if(r instanceof mi)this.rawUrlTree=i.initialUrl;else if(r instanceof bf){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof gc?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof gi&&(r.code===En.GuardRejected||r.code===En.NoDataFromResolver)?this.restoreHistory(i):r instanceof pc?this.restoreHistory(i,!0):r instanceof ar&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=x(x({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=x(x({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=hi(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),uc=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(uc||{});function Kx(t,e){t.events.pipe(It(n=>n instanceof ar||n instanceof gi||n instanceof pc||n instanceof mi),j(n=>n instanceof ar||n instanceof mi?uc.COMPLETE:(n instanceof gi?n.code===En.Redirect||n.code===En.SupersededByNewNavigation:!1)?uc.REDIRECTING:uc.FAILED),It(n=>n!==uc.REDIRECTING),xr(1)).subscribe(()=>{e()})}function JH(t){throw t}var XH={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},e4={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},yi=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=k(uf),this.stateManager=k(Wx),this.options=k(Tc,{optional:!0})||{},this.pendingTasks=k(sf),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=k(tw),this.urlSerializer=k(Ec),this.location=k(ra),this.urlHandlingStrategy=k(ew),this._events=new Ye,this.errorHandler=this.options.errorHandler||JH,this.navigated=!1,this.routeReuseStrategy=k(QH),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=k(Pf,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!k(Of,{optional:!0}),this.eventsSubscription=new qe,this.isNgZoneEnabled=k(le)instanceof le&&le.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof gi&&i.code!==En.Redirect&&i.code!==En.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof ar)this.navigated=!0;else if(i instanceof mc){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),u={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||KH(s.source)};this.scheduleNavigation(a,lc,null,u,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}n4(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),lc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let c=x({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let u=this.parseUrl(r);this.scheduleNavigation(u,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(Zv),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:a,d=null;switch(u){case"merge":d=x(x({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=Ax(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return xx(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=la(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,lc,null,i)}navigate(r,i={skipLocationChange:!1}){return t4(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=x({},XH):i===!1?s=x({},e4):s=i,la(r))return lx(this.currentUrlTree,r,s);let o=this.parseUrl(r);return lx(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let u,c,l;a?(u=a.resolve,c=a.reject,l=a.promise):l=new Promise((h,f)=>{u=h,c=f});let d=this.pendingTasks.add();return Kx(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:u,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function t4(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new $(4008,!1)}function n4(t){return!(t instanceof gc)&&!(t instanceof mc)}var Vf=(()=>{let e=class e{constructor(r,i,s,o,a,u){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=u,this.href=null,this.commands=null,this.onChanges=new Ye,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let c=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=r.events.subscribe(l=>{l instanceof ar&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let u=this.urlTree;if(u===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(u,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:ZS(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(oe(yi),oe(Cs),b_("tabindex"),oe(Or),oe(ir),oe(Lr))},e.\u0275dir=At({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&he("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&af("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Vt.HasDecoratorInputTransform,"preserveFragment","preserveFragment",vs],skipLocationChange:[Vt.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",vs],replaceUrl:[Vt.HasDecoratorInputTransform,"replaceUrl","replaceUrl",vs],routerLink:"routerLink"},standalone:!0,features:[K_,ms]});let t=e;return t})();var kf=class{};var r4=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(It(r=>r instanceof ar),ss(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=rf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,u=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(u,o.children??o._loadedRoutes))}return _e(s).pipe(ti())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=U(null);let o=s.pipe(Ze(a=>a===null?U(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return _e([o,a]).pipe(ti())}else return o})}};e.\u0275fac=function(i){return new(i||e)(I(yi),I(cf),I(tn),I(kf),I(Xv))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Qx=new F(""),i4=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof da?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof ar?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof mi&&r.code===Tf.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Sf&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Sf(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){aA()},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function s4(t){return t.routerState.root}function bc(t,e){return{\u0275kind:t,\u0275providers:e}}function o4(){let t=k(jn);return e=>{let n=t.get(na);if(e!==n.components[0])return;let r=t.get(yi),i=t.get(Yx);t.get(nw)===1&&r.initialNavigation(),t.get(Zx,null,se.Optional)?.setUpPreloading(),t.get(Qx,null,se.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Yx=new F("",{factory:()=>new Ye}),nw=new F("",{providedIn:"root",factory:()=>1});function a4(){return bc(2,[{provide:nw,useValue:0},{provide:hf,multi:!0,deps:[jn],useFactory:e=>{let n=e.get(WA,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(yi),s=e.get(Yx);Kx(i,()=>{r(!0)}),e.get(tw).afterPreactivation=()=>(r(!0),s.closed?U(void 0):s),i.initialNavigation()}))}}])}function u4(){return bc(3,[{provide:hf,multi:!0,useFactory:()=>{let e=k(yi);return()=>{e.setUpLocationChangeListener()}}},{provide:nw,useValue:2}])}var Zx=new F("");function c4(t){return bc(0,[{provide:Zx,useExisting:r4},{provide:kf,useExisting:t}])}function l4(){return bc(8,[px,{provide:Of,useExisting:px}])}function d4(t){let e=[{provide:Gx,useValue:zH},{provide:zx,useValue:x({skipNextTransition:!!t?.skipInitialTransition},t)}];return bc(9,e)}var mx=new F("ROUTER_FORROOT_GUARD"),h4=[ra,{provide:Ec,useClass:hc},yi,Ic,{provide:Cs,useFactory:s4,deps:[yi]},Xv,[]],rw=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[h4,[],{provide:Pf,multi:!0,useValue:r},{provide:mx,useFactory:m4,deps:[[yi,new Yo,new A_]]},{provide:Tc,useValue:i||{}},i?.useHash?p4():g4(),f4(),i?.preloadingStrategy?c4(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?y4(i):[],i?.bindToComponentInputs?l4().\u0275providers:[],i?.enableViewTransitions?d4().\u0275providers:[],_4()]}}static forChild(r){return{ngModule:e,providers:[{provide:Pf,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(I(mx,8))},e.\u0275mod=et({type:e}),e.\u0275inj=Xe({});let t=e;return t})();function f4(){return{provide:Qx,useFactory:()=>{let t=k(JA),e=k(le),n=k(Tc),r=k(tw),i=k(Ec);return n.scrollOffset&&t.setOffset(n.scrollOffset),new i4(i,r,t,e,n)}}}function p4(){return{provide:Lr,useClass:QA}}function g4(){return{provide:Lr,useClass:uv}}function m4(t){return"guarded"}function y4(t){return[t.initialNavigation==="disabled"?u4().\u0275providers:[],t.initialNavigation==="enabledBlocking"?a4().\u0275providers:[]]}var yx=new F("");function _4(){return[{provide:yx,useFactory:o4},{provide:X_,multi:!0,useExisting:yx}]}var Ds=class{constructor(){this.id="",this.titulo="",this.autor="",this.editorial="",this.year=0}};var v4="firebase",w4="10.8.0";Rn(v4,w4,"app");var Ts=new Nr("ANGULARFIRE2_VERSION");var E4=(t,e)=>{let n=e?[e]:yT(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},jr=class{constructor(){return E4(I4)}},I4="app-check";function iw(){}var Lf=class{zone;delegate;constructor(e,n=ny){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},sw=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",iw,{},iw,iw)),n.pipe(Je({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},pa=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Lf(Zone.current)),this.insideAngular=n.run(()=>new Lf(Zone.current,is)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(I(le))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function C4(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Ge(t){return D4(C4())(t)}function D4(t){return function(n){return n=n.lift(new sw(t.ngZone)),n.pipe(Pn(t.outsideAngular),gn(t.insideAngular))}}var T4=new Map,b4={activated:!1,tokenObservers:[]},S4={initialized:!1,enabled:!1};function Un(t){return T4.get(t)||Object.assign({},b4)}function sM(){return S4}var A4="https://content-firebaseappcheck.googleapis.com/v1";var x4="exchangeDebugToken",Xx={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},jX=24*60*60*1e3;var uw=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return v(this,null,function*(){this.stop();try{this.pending=new dt,this.pending.promise.catch(n=>{}),yield M4(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new dt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function M4(t){return new Promise(e=>{setTimeout(e,t)})}var R4={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},vi=new dT("appCheck","AppCheck",R4);function oM(t){if(!Un(t).activated)throw vi.create("use-before-activation",{appName:t.name})}function aM(r,i){return v(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(t,a)}catch(f){throw vi.create("fetch-network-error",{originalErrorMessage:f?.message})}if(u.status!==200)throw vi.create("fetch-status-error",{httpStatus:u.status});let c;try{c=yield u.json()}catch(f){throw vi.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=c.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw vi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function uM(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${A4}/projects/${n}/apps/${r}:${x4}?key=${i}`,body:{debug_token:e}}}var N4="firebase-app-check-database",P4=1,cw="firebase-app-check-store";var jf=null;function k4(){return jf||(jf=new Promise((t,e)=>{try{let n=indexedDB.open(N4,P4);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(vi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(cw,{keyPath:"compositeKey"})}}}catch(n){e(vi.create("storage-open",{originalErrorMessage:n?.message}))}}),jf)}function O4(t,e){return F4(V4(t),e)}function F4(t,e){return v(this,null,function*(){let r=(yield k4()).transaction(cw,"readwrite"),s=r.objectStore(cw).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var c;a(vi.create("storage-set",{originalErrorMessage:(c=u.target.error)===null||c===void 0?void 0:c.message}))}})})}function V4(t){return`${t.options.appId}-${t.name}`}var lw=new ei("@firebase/app-check");function aw(t,e){return Nd()?O4(t,e).catch(n=>{lw.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function cM(){return sM().enabled}function lM(){return v(this,null,function*(){let t=sM();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var L4={error:"UNKNOWN_ERROR"};function j4(t){return Md.encodeString(JSON.stringify(t),!1)}function dw(t,e=!1){return v(this,null,function*(){let n=t.app;oM(n);let r=Un(n),i=r.token,s;if(i&&!Sc(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(Sc(u)?i=u:yield aw(n,void 0))}if(!e&&i&&Sc(i))return{token:i.token};let o=!1;if(cM()){r.exchangeTokenPromise||(r.exchangeTokenPromise=aM(uM(n,yield lM()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let u=yield r.exchangeTokenPromise;return yield aw(n,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Un(n).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?lw.warn(u.message):lw.error(u),s=u}let a;return i?s?Sc(i)?a={token:i.token,internalError:s}:a=tM(s):(a={token:i.token},r.token=i,yield aw(n,i)):a=tM(s),o&&H4(n,a),a})}function U4(t){return v(this,null,function*(){let e=t.app;oM(e);let{provider:n}=Un(e);if(cM()){let r=yield lM(),{token:i}=yield aM(uM(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function B4(t,e,n,r){let{app:i}=t,s=Un(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Sc(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),eM(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>eM(t))}function dM(t,e){let n=Un(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function eM(t){let{app:e}=t,n=Un(e),r=n.tokenRefresher;r||(r=$4(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function $4(t){let{app:e}=t;return new uw(()=>v(this,null,function*(){let n=Un(e),r;if(n.token?r=yield dw(t,!0):r=yield dw(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=Un(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Xx.RETRIAL_MIN_WAIT,Xx.RETRIAL_MAX_WAIT)}function H4(t,e){let n=Un(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Sc(t){return t.expireTimeMillis-Date.now()>0}function tM(t){return{token:j4(L4),error:t}}var hw=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=Un(this.app);for(let n of e)dM(this.app,n.next);return Promise.resolve()}};function q4(t,e){return new hw(t,e)}function G4(t){return{getToken:e=>dw(t,e),getLimitedUseToken:()=>U4(t),addTokenListener:e=>B4(t,"INTERNAL",e),removeTokenListener:e=>dM(t.app,e)}}var z4="@firebase/app-check",W4="0.8.2";var K4="app-check",nM="app-check-internal";function Q4(){Xi(new Xt(K4,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return q4(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(nM).initialize()})),Xi(new Xt(nM,t=>{let e=t.getProvider("app-check").getImmediate();return G4(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Rn(z4,W4)}Q4();var Y4=["localhost","0.0.0.0","127.0.0.1"],ZX=typeof window<"u"&&Y4.includes(window.location.hostname);var Z4="firebase",J4="10.8.0";vt.registerVersion(Z4,J4,"app-compat");var X4=["ngOnDestroy"],fM=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(X4.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let u=a?.[s];return typeof u=="function"?u.bind(a):u?.then?u.then(c=>n.run(()=>c)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,c)=>o.then(l=>{let d=l?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,d),d})})})});var Uf=class{constructor(e){return e}},wi=new F("angularfire2.app.options"),Ei=new F("angularfire2.app.name");function bs(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=vt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>vt.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;eq("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Uf(o)}var eq=(t,...e)=>{nv()&&typeof console<"u"&&console[t](...e)},tq={provide:Uf,useFactory:bs,deps:[wi,le,[new Yo,Ei]]},pM=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:wi,useValue:n},{provide:Ei,useValue:r}]}}constructor(n){vt.registerVersion("angularfire",Ts.full,"core"),vt.registerVersion("angularfire",Ts.full,"app-compat"),vt.registerVersion("angular",NA.full,n.toString())}static \u0275fac=function(r){return new(r||t)(I(xt))};static \u0275mod=et({type:t});static \u0275inj=Xe({providers:[tq]})}return t})();function ga(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return nq(i,o)||(hM("error",`${e} was already initialized on the ${n} Firebase App with different settings.${rq?" You may need to reload as Firebase is not HMR aware.":""}`),hM("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function nq(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var rq=typeof module<"u"&&!!module.hot,hM=(t,...e)=>{nv()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Ac=new F("angularfire2.auth.use-emulator"),xc=new F("angularfire2.auth.settings"),Mc=new F("angularfire2.auth.tenant-id"),Rc=new F("angularfire2.auth.langugage-code"),Nc=new F("angularfire2.auth.use-device-language"),Pc=new F("angularfire.auth.persistence"),kc=(t,e,n,r,i,s,o,a)=>ga(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(let[c,l]of Object.entries(o))u.settings[c]=l;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]),Bf=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,c,l,d,h,f){let p=new Ye,g=U(void 0).pipe(gn(o.outsideAngular),Oe(()=>s.runOutsideAngular(()=>import("./chunk-2UTFESB6.js"))),j(()=>bs(n,s,r)),j(_=>kc(_,s,a,c,l,d,u,h)),uh({bufferSize:1,refCount:!1}));if(ws(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=U(null);else{g.pipe(mn()).subscribe();let _=g.pipe(Oe(A=>A.getRedirectResult().then(H=>H,()=>null)),Ge,uh({bufferSize:1,refCount:!1})),T=g.pipe(Oe(A=>new ne(H=>({unsubscribe:s.runOutsideAngular(()=>A.onAuthStateChanged(G=>H.next(G),G=>H.error(G),()=>H.complete()))})))),P=g.pipe(Oe(A=>new ne(H=>({unsubscribe:s.runOutsideAngular(()=>A.onIdTokenChanged(G=>H.next(G),G=>H.error(G),()=>H.complete()))}))));this.authState=_.pipe(ch(T),Pn(o.outsideAngular),gn(o.insideAngular)),this.user=_.pipe(ch(P),Pn(o.outsideAngular),gn(o.insideAngular)),this.idToken=this.user.pipe(Oe(A=>A?_e(A.getIdToken()):U(null))),this.idTokenResult=this.user.pipe(Oe(A=>A?_e(A.getIdTokenResult()):U(null))),this.credential=Mo(_,p,this.authState.pipe(It(A=>!A))).pipe(j(A=>A?.user?A:null),Pn(o.outsideAngular),gn(o.insideAngular))}return fM(this,g,s,{spy:{apply:(_,T,P)=>{(_.startsWith("signIn")||_.startsWith("createUser"))&&P.then(A=>p.next(A))}}})}static \u0275fac=function(r){return new(r||t)(I(wi),I(Ei,8),I(xt),I(le),I(pa),I(Ac,8),I(xc,8),I(Mc,8),I(Rc,8),I(Nc,8),I(Pc,8),I(jr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var iq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$n={},R,Ow=Ow||{},Q=iq||self;function tp(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Kc(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function sq(t){return Object.prototype.hasOwnProperty.call(t,pw)&&t[pw]||(t[pw]=++oq)}var pw="closure_uid_"+(1e9*Math.random()>>>0),oq=0;function aq(t,e,n){return t.call.apply(t.bind,arguments)}function uq(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Mt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Mt=aq:Mt=uq,Mt.apply(null,arguments)}function $f(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function pt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Ii(){this.s=this.s,this.o=this.o}var cq=0;Ii.prototype.s=!1;Ii.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),cq!=0)&&sq(this)};Ii.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var AM=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Fw(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function mM(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(tp(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Rt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Rt.prototype.h=function(){this.defaultPrevented=!0};var lq=function(){if(!Q.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};Q.addEventListener("test",n,e),Q.removeEventListener("test",n,e)}catch{}return t}();function Uc(t){return/^[\s\xa0]*$/.test(t)}function np(){var t=Q.navigator;return t&&(t=t.userAgent)?t:""}function cr(t){return np().indexOf(t)!=-1}function Vw(t){return Vw[" "](t),t}Vw[" "]=function(){};function dq(t,e){var n=Xq;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var hq=cr("Opera"),va=cr("Trident")||cr("MSIE"),xM=cr("Edge"),vw=xM||va,MM=cr("Gecko")&&!(np().toLowerCase().indexOf("webkit")!=-1&&!cr("Edge"))&&!(cr("Trident")||cr("MSIE"))&&!cr("Edge"),fq=np().toLowerCase().indexOf("webkit")!=-1&&!cr("Edge");function RM(){var t=Q.document;return t?t.documentMode:void 0}var ww;e:{if(Hf="",qf=function(){var t=np();if(MM)return/rv:([^\);]+)(\)|;)/.exec(t);if(xM)return/Edge\/([\d\.]+)/.exec(t);if(va)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(fq)return/WebKit\/(\S+)/.exec(t);if(hq)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),qf&&(Hf=qf?qf[1]:""),va&&(Gf=RM(),Gf!=null&&Gf>parseFloat(Hf))){ww=String(Gf);break e}ww=Hf}var Hf,qf,Gf,Ew;Q.document&&va?(gw=RM(),Ew=gw||parseInt(ww,10)||void 0):Ew=void 0;var gw,pq=Ew;function Bc(t,e){if(Rt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(MM){e:{try{Vw(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:gq[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Bc.$.h.call(this)}}pt(Bc,Rt);var gq={2:"touch",3:"pen",4:"mouse"};Bc.prototype.h=function(){Bc.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Qc="closure_listenable_"+(1e6*Math.random()|0),mq=0;function yq(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++mq,this.fa=this.ia=!1}function rp(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Lw(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function _q(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function NM(t){let e={};for(let n in t)e[n]=t[n];return e}var yM="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function PM(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<yM.length;s++)n=yM[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ip(t){this.src=t,this.g={},this.h=0}ip.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Cw(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new yq(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Iw(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=AM(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(rp(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Cw(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var jw="closure_lm_"+(1e6*Math.random()|0),mw={};function kM(t,e,n,r,i){if(r&&r.once)return FM(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)kM(t,e[s],n,r,i);return null}return n=$w(n),t&&t[Qc]?t.O(e,n,Kc(r)?!!r.capture:!!r,i):OM(t,e,n,!1,r,i)}function OM(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Kc(i)?!!i.capture:!!i,a=Bw(t);if(a||(t[jw]=a=new ip(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=vq(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)lq||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(LM(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function vq(){function t(n){return e.call(t.src,t.listener,n)}let e=wq;return t}function FM(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)FM(t,e[s],n,r,i);return null}return n=$w(n),t&&t[Qc]?t.P(e,n,Kc(r)?!!r.capture:!!r,i):OM(t,e,n,!0,r,i)}function VM(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)VM(t,e[s],n,r,i);else r=Kc(r)?!!r.capture:!!r,n=$w(n),t&&t[Qc]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Cw(s,n,r,i),-1<n&&(rp(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=Bw(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Cw(e,n,r,i)),(n=-1<t?e[t]:null)&&Uw(n))}function Uw(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Qc])Iw(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(LM(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Bw(e))?(Iw(n,t),n.h==0&&(n.src=null,e[jw]=null)):rp(t)}}}function LM(t){return t in mw?mw[t]:mw[t]="on"+t}function wq(t,e){if(t.fa)t=!0;else{e=new Bc(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Uw(t),t=n.call(r,e)}return t}function Bw(t){return t=t[jw],t instanceof ip?t:null}var yw="__closure_events_fn_"+(1e9*Math.random()>>>0);function $w(t){return typeof t=="function"?t:(t[yw]||(t[yw]=function(e){return t.handleEvent(e)}),t[yw])}function ft(){Ii.call(this),this.i=new ip(this),this.S=this,this.J=null}pt(ft,Ii);ft.prototype[Qc]=!0;ft.prototype.removeEventListener=function(t,e,n,r){VM(this,t,e,n,r)};function Tt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Rt(e,t);else if(e instanceof Rt)e.target=e.target||t;else{var i=e;e=new Rt(r,t),PM(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=zf(o,r,!0,e)&&i}if(o=e.g=t,i=zf(o,r,!0,e)&&i,i=zf(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=zf(o,r,!1,e)&&i}ft.prototype.N=function(){if(ft.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)rp(n[r]);delete t.g[e],t.h--}}this.J=null};ft.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};ft.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function zf(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&Iw(t.i,o),i=a.call(u,r)!==!1&&i}}return i&&!r.defaultPrevented}var Hw=Q.JSON.stringify,Dw=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function Eq(){var t=qw;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Tw=class{constructor(){this.h=this.g=null}add(e,n){let r=jM.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},jM=new Dw(()=>new bw,t=>t.reset()),bw=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function Iq(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Cq(t){Q.setTimeout(()=>{throw t},0)}var $c,Hc=!1,qw=new Tw,UM=()=>{let t=Q.Promise.resolve(void 0);$c=()=>{t.then(Dq)}},Dq=()=>{for(var t;t=Eq();){try{t.h.call(t.g)}catch(n){Cq(n)}var e=jM;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Hc=!1};function sp(t,e){ft.call(this),this.h=t||1,this.g=e||Q,this.j=Mt(this.qb,this),this.l=Date.now()}pt(sp,ft);R=sp.prototype;R.ga=!1;R.T=null;R.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Tt(this,"tick"),this.ga&&(Gw(this),this.start()))}};R.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Gw(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}R.N=function(){sp.$.N.call(this),Gw(this),delete this.g};function zw(t,e,n){if(typeof t=="function")n&&(t=Mt(t,n));else if(t&&typeof t.handleEvent=="function")t=Mt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Q.setTimeout(t,e||0)}function BM(t){t.g=zw(()=>{t.g=null,t.i&&(t.i=!1,BM(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var Sw=class extends Ii{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:BM(this)}N(){super.N(),this.g&&(Q.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function qc(t){Ii.call(this),this.h=t,this.g={}}pt(qc,Ii);var _M=[];function $M(t,e,n,r){Array.isArray(n)||(n&&(_M[0]=n.toString()),n=_M);for(var i=0;i<n.length;i++){var s=kM(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function HM(t){Lw(t.g,function(e,n){this.g.hasOwnProperty(n)&&Uw(e)},t),t.g={}}qc.prototype.N=function(){qc.$.N.call(this),HM(this)};qc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function op(){this.g=!0}op.prototype.Ea=function(){this.g=!1};function Tq(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+c+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function bq(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function ya(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Aq(t,n)+(r?" "+r:"")})}function Sq(t,e){t.info(function(){return"TIMEOUT: "+e})}op.prototype.info=function(){};function Aq(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return Hw(n)}catch{return e}}var Ms={},vM=null;function ap(){return vM=vM||new ft}Ms.Ta="serverreachability";function qM(t){Rt.call(this,Ms.Ta,t)}pt(qM,Rt);function Gc(t){let e=ap();Tt(e,new qM(e))}Ms.STAT_EVENT="statevent";function GM(t,e){Rt.call(this,Ms.STAT_EVENT,t),this.stat=e}pt(GM,Rt);function jt(t){let e=ap();Tt(e,new GM(e,t))}Ms.Ua="timingevent";function zM(t,e){Rt.call(this,Ms.Ua,t),this.size=e}pt(zM,Rt);function Yc(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Q.setTimeout(function(){t()},e)}var up={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},WM={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Ww(){}Ww.prototype.h=null;function wM(t){return t.h||(t.h=t.i())}function KM(){}var Zc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Kw(){Rt.call(this,"d")}pt(Kw,Rt);function Qw(){Rt.call(this,"c")}pt(Qw,Rt);var Aw;function cp(){}pt(cp,Ww);cp.prototype.g=function(){return new XMLHttpRequest};cp.prototype.i=function(){return{}};Aw=new cp;function Jc(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new qc(this),this.P=xq,t=vw?125:void 0,this.V=new sp(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new QM}function QM(){this.i=null,this.g="",this.h=!1}var xq=45e3,YM={},xw={};R=Jc.prototype;R.setTimeout=function(t){this.P=t};function Mw(t,e,n){t.L=1,t.A=dp(Br(e)),t.u=n,t.S=!0,ZM(t,null)}function ZM(t,e){t.G=Date.now(),Xc(t),t.B=Br(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),sR(n.i,"t",r),t.o=0,n=t.l.J,t.h=new QM,t.g=bR(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Sw(Mt(t.Pa,t,t.g),t.O)),$M(t.U,t.g,"readystatechange",t.nb),e=t.I?NM(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Gc(),Tq(t.j,t.v,t.B,t.m,t.W,t.u)}R.nb=function(t){t=t.target;let e=this.M;e&&lr(t)==3?e.l():this.Pa(t)};R.Pa=function(t){try{if(t==this.g)e:{let l=lr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||vw||this.g&&(this.h.h||this.g.ja()||DM(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?Gc(3):Gc(2)),lp(this);var n=this.g.da();this.ca=n;t:if(JM(this)){var r=DM(this.g);t="";var i=r.length,s=lr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ss(this),jc(this);var o="";break t}this.h.i=new Q.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,bq(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Uc(a)){var c=a;break t}}c=null}if(n=c)ya(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Rw(this,n);else{this.i=!1,this.s=3,jt(12),Ss(this),jc(this);break e}}this.S?(XM(this,l,o),vw&&this.i&&l==3&&($M(this.U,this.V,"tick",this.mb),this.V.start())):(ya(this.j,this.m,o,null),Rw(this,o)),l==4&&Ss(this),this.i&&!this.J&&(l==4?IR(this.l,this):(this.i=!1,Xc(this)))}else Yq(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,jt(12)):(this.s=0,jt(13)),Ss(this),jc(this)}}}catch{}finally{}};function JM(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function XM(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=Mq(t,n),i==xw){e==4&&(t.s=4,jt(14),r=!1),ya(t.j,t.m,null,"[Incomplete Response]");break}else if(i==YM){t.s=4,jt(15),ya(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else ya(t.j,t.m,i,null),Rw(t,i);JM(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,jt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),tE(e),e.M=!0,jt(11))):(ya(t.j,t.m,n,"[Invalid Chunked Response]"),Ss(t),jc(t))}R.mb=function(){if(this.g){var t=lr(this.g),e=this.g.ja();this.o<e.length&&(lp(this),XM(this,t,e),this.i&&t!=4&&Xc(this))}};function Mq(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?xw:(n=Number(e.substring(n,r)),isNaN(n)?YM:(r+=1,r+n>e.length?xw:(e=e.slice(r,r+n),t.o=r+n,e)))}R.cancel=function(){this.J=!0,Ss(this)};function Xc(t){t.Y=Date.now()+t.P,eR(t,t.P)}function eR(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Yc(Mt(t.lb,t),e)}function lp(t){t.C&&(Q.clearTimeout(t.C),t.C=null)}R.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(Sq(this.j,this.B),this.L!=2&&(Gc(),jt(17)),Ss(this),this.s=2,jc(this)):eR(this,this.Y-t)};function jc(t){t.l.H==0||t.J||IR(t.l,t)}function Ss(t){lp(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,Gw(t.V),HM(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Rw(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Nw(n.i,t))){if(!t.K&&Nw(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Zf(n),pp(n);else break e;eE(n),jt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Yc(Mt(n.ib,n),6e3));if(1>=uR(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else As(n,11)}else if((t.K||n.g==t)&&Zf(n),!Uc(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];let l=c[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=c[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Yw(s,s.h),s.h=null))}if(r.F){let g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,Ne(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=TR(r,r.J?r.pa:null,r.Y),o.K){cR(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&(lp(a),Xc(a)),r.g=o}else wR(r);0<n.j.length&&gp(n)}else c[0]!="stop"&&c[0]!="close"||As(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?As(n,7):Xw(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}Gc(4)}catch{}}function Rq(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(tp(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function Nq(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(tp(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function tR(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(tp(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=Nq(t),r=Rq(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var nR=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pq(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function xs(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof xs){this.h=t.h,Qf(this,t.j),this.s=t.s,this.g=t.g,Yf(this,t.m),this.l=t.l;var e=t.i,n=new zc;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),EM(this,n),this.o=t.o}else t&&(e=String(t).match(nR))?(this.h=!1,Qf(this,e[1]||"",!0),this.s=Vc(e[2]||""),this.g=Vc(e[3]||"",!0),Yf(this,e[4]),this.l=Vc(e[5]||"",!0),EM(this,e[6]||"",!0),this.o=Vc(e[7]||"")):(this.h=!1,this.i=new zc(null,this.h))}xs.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Lc(e,IM,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Lc(e,IM,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Lc(n,n.charAt(0)=="/"?Fq:Oq,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Lc(n,Lq)),t.join("")};function Br(t){return new xs(t)}function Qf(t,e,n){t.j=n?Vc(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Yf(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function EM(t,e,n){e instanceof zc?(t.i=e,jq(t.i,t.h)):(n||(e=Lc(e,Vq)),t.i=new zc(e,t.h))}function Ne(t,e,n){t.i.set(e,n)}function dp(t){return Ne(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Vc(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Lc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,kq),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function kq(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var IM=/[#\/\?@]/g,Oq=/[#\?:]/g,Fq=/[#\?]/g,Vq=/[#\?@]/g,Lq=/#/g;function zc(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ci(t){t.g||(t.g=new Map,t.h=0,t.i&&Pq(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}R=zc.prototype;R.add=function(t,e){Ci(this),this.i=null,t=wa(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function rR(t,e){Ci(t),e=wa(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function iR(t,e){return Ci(t),e=wa(t,e),t.g.has(e)}R.forEach=function(t,e){Ci(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};R.ta=function(){Ci(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};R.Z=function(t){Ci(this);let e=[];if(typeof t=="string")iR(this,t)&&(e=e.concat(this.g.get(wa(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};R.set=function(t,e){return Ci(this),this.i=null,t=wa(this,t),iR(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};R.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function sR(t,e,n){rR(t,e),0<n.length&&(t.i=null,t.g.set(wa(t,e),Fw(n)),t.h+=n.length)}R.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function wa(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function jq(t,e){e&&!t.j&&(Ci(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(rR(this,r),sR(this,i,n))},t)),t.j=e}var Uq=class{constructor(t,e){this.g=t,this.map=e}};function oR(t){this.l=t||Bq,Q.PerformanceNavigationTiming?(t=Q.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Q.g&&Q.g.Ka&&Q.g.Ka()&&Q.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Bq=10;function aR(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function uR(t){return t.h?1:t.g?t.g.size:0}function Nw(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Yw(t,e){t.g?t.g.add(e):t.h=e}function cR(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}oR.prototype.cancel=function(){if(this.i=lR(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function lR(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return Fw(t.i)}var $q=class{stringify(t){return Q.JSON.stringify(t,void 0)}parse(t){return Q.JSON.parse(t,void 0)}};function Hq(){this.g=new $q}function qq(t,e,n){let r=n||"";try{tR(t,function(i,s){let o=i;Kc(i)&&(o=Hw(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Gq(t,e){let n=new op;if(Q.Image){let r=new Image;r.onload=$f(Wf,n,r,"TestLoadImage: loaded",!0,e),r.onerror=$f(Wf,n,r,"TestLoadImage: error",!1,e),r.onabort=$f(Wf,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=$f(Wf,n,r,"TestLoadImage: timeout",!1,e),Q.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Wf(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function el(t){this.l=t.ec||null,this.j=t.ob||!1}pt(el,Ww);el.prototype.g=function(){return new hp(this.l,this.j)};el.prototype.i=function(t){return function(){return t}}({});function hp(t,e){ft.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Zw,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}pt(hp,ft);var Zw=0;R=hp.prototype;R.open=function(t,e){if(this.readyState!=Zw)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Wc(this)};R.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Q).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};R.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,tl(this)),this.readyState=Zw};R.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Wc(this)),this.g&&(this.readyState=3,Wc(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Q.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;dR(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function dR(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}R.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?tl(this):Wc(this),this.readyState==3&&dR(this)}};R.Za=function(t){this.g&&(this.response=this.responseText=t,tl(this))};R.Ya=function(t){this.g&&(this.response=t,tl(this))};R.ka=function(){this.g&&tl(this)};function tl(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Wc(t)}R.setRequestHeader=function(t,e){this.v.append(t,e)};R.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};R.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Wc(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(hp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var zq=Q.JSON.parse;function Be(t){ft.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=hR,this.L=this.M=!1}pt(Be,ft);var hR="",Wq=/^https?$/i,Kq=["POST","PUT"];R=Be.prototype;R.Oa=function(t){this.M=t};R.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Aw.g(),this.C=this.u?wM(this.u):wM(Aw),this.g.onreadystatechange=Mt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){CM(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Q.FormData&&t instanceof Q.FormData,!(0<=AM(Kq,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{gR(this),0<this.B&&((this.L=Qq(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Mt(this.ua,this)):this.A=zw(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){CM(this,s)}};function Qq(t){return va&&typeof t.timeout=="number"&&t.ontimeout!==void 0}R.ua=function(){typeof Ow<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Tt(this,"timeout"),this.abort(8))};function CM(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,fR(t),fp(t)}function fR(t){t.F||(t.F=!0,Tt(t,"complete"),Tt(t,"error"))}R.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Tt(this,"complete"),Tt(this,"abort"),fp(this))};R.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),fp(this,!0)),Be.$.N.call(this)};R.La=function(){this.s||(this.G||this.v||this.l?pR(this):this.kb())};R.kb=function(){pR(this)};function pR(t){if(t.h&&typeof Ow<"u"&&(!t.C[1]||lr(t)!=4||t.da()!=2)){if(t.v&&lr(t)==4)zw(t.La,0,t);else if(Tt(t,"readystatechange"),lr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(nR)[1]||null;!i&&Q.self&&Q.self.location&&(i=Q.self.location.protocol.slice(0,-1)),r=!Wq.test(i?i.toLowerCase():"")}n=r}if(n)Tt(t,"complete"),Tt(t,"success");else{t.m=6;try{var s=2<lr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",fR(t)}}finally{fp(t)}}}}function fp(t,e){if(t.g){gR(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Tt(t,"ready");try{n.onreadystatechange=r}catch{}}}function gR(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Q.clearTimeout(t.A),t.A=null)}R.isActive=function(){return!!this.g};function lr(t){return t.g?t.g.readyState:0}R.da=function(){try{return 2<lr(this)?this.g.status:-1}catch{return-1}};R.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};R.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),zq(e)}};function DM(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case hR:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function Yq(t){let e={};t=(t.g&&2<=lr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Uc(t[r]))continue;var n=Iq(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}_q(e,function(r){return r.join(", ")})}R.Ia=function(){return this.m};R.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function mR(t){let e="";return Lw(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Jw(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=mR(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ne(t,e,n))}function Oc(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function yR(t){this.Ga=0,this.j=[],this.l=new op,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Oc("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Oc("baseRetryDelayMs",5e3,t),this.hb=Oc("retryDelaySeedMs",1e4,t),this.eb=Oc("forwardChannelMaxRetries",2,t),this.xa=Oc("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new oR(t&&t.concurrentRequestLimit),this.Ja=new Hq,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}R=yR.prototype;R.ra=8;R.H=1;function Xw(t){if(_R(t),t.H==3){var e=t.W++,n=Br(t.I);if(Ne(n,"SID",t.K),Ne(n,"RID",e),Ne(n,"TYPE","terminate"),nl(t,n),e=new Jc(t,t.l,e),e.L=2,e.A=dp(Br(n)),n=!1,Q.navigator&&Q.navigator.sendBeacon)try{n=Q.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Q.Image&&(new Image().src=e.A,n=!0),n||(e.g=bR(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Xc(e)}DR(t)}function pp(t){t.g&&(tE(t),t.g.cancel(),t.g=null)}function _R(t){pp(t),t.u&&(Q.clearTimeout(t.u),t.u=null),Zf(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Q.clearTimeout(t.m),t.m=null)}function gp(t){if(!aR(t.i)&&!t.m){t.m=!0;var e=t.Na;$c||UM(),Hc||($c(),Hc=!0),qw.add(e,t),t.C=0}}function Zq(t,e){return uR(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Yc(Mt(t.Na,t,e),CR(t,t.C)),t.C++,!0)}R.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Jc(this,this.l,t),s=this.s;if(this.U&&(s?(s=NM(s),PM(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=vR(this,i,e),n=Br(this.I),Ne(n,"RID",t),Ne(n,"CVER",22),this.F&&Ne(n,"X-HTTP-Session-Id",this.F),nl(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(mR(s)))+"&"+e:this.o&&Jw(n,this.o,s)),Yw(this.i,i),this.bb&&Ne(n,"TYPE","init"),this.P?(Ne(n,"$req",e),Ne(n,"SID","null"),i.aa=!0,Mw(i,n,null)):Mw(i,n,e),this.H=2}}else this.H==3&&(t?TM(this,t):this.j.length==0||aR(this.i)||TM(this))};function TM(t,e){var n;e?n=e.m:n=t.W++;let r=Br(t.I);Ne(r,"SID",t.K),Ne(r,"RID",n),Ne(r,"AID",t.V),nl(t,r),t.o&&t.s&&Jw(r,t.o,t.s),n=new Jc(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=vR(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Yw(t.i,n),Mw(n,r,e)}function nl(t,e){t.na&&Lw(t.na,function(n,r){Ne(e,r,n)}),t.h&&tR({},function(n,r){Ne(e,r,n)})}function vR(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Mt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let c=i[u].g,l=i[u].map;if(c-=s,0>c)s=Math.max(0,i[u].g-100),a=!1;else try{qq(l,o,"req"+c+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function wR(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;$c||UM(),Hc||($c(),Hc=!0),qw.add(e,t),t.A=0}}function eE(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Yc(Mt(t.Ma,t),CR(t,t.A)),t.A++,!0)}R.Ma=function(){if(this.u=null,ER(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Yc(Mt(this.jb,this),t)}};R.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,jt(10),pp(this),ER(this))};function tE(t){t.B!=null&&(Q.clearTimeout(t.B),t.B=null)}function ER(t){t.g=new Jc(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Br(t.wa);Ne(e,"RID","rpc"),Ne(e,"SID",t.K),Ne(e,"AID",t.V),Ne(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Ne(e,"TO",t.qa),Ne(e,"TYPE","xmlhttp"),nl(t,e),t.o&&t.s&&Jw(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=dp(Br(e)),n.u=null,n.S=!0,ZM(n,t)}R.ib=function(){this.v!=null&&(this.v=null,pp(this),eE(this),jt(19))};function Zf(t){t.v!=null&&(Q.clearTimeout(t.v),t.v=null)}function IR(t,e){var n=null;if(t.g==e){Zf(t),tE(t),t.g=null;var r=2}else if(Nw(t.i,e))n=e.F,cR(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=ap(),Tt(r,new zM(r,n)),gp(t)}else wR(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&Zq(t,e)||r==2&&eE(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:As(t,5);break;case 4:As(t,10);break;case 3:As(t,6);break;default:As(t,2)}}}function CR(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function As(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Mt(t.pb,t);n||(n=new xs("//www.google.com/images/cleardot.gif"),Q.location&&Q.location.protocol=="http"||Qf(n,"https"),dp(n)),Gq(n.toString(),r)}else jt(2);t.H=0,t.h&&t.h.za(e),DR(t),_R(t)}R.pb=function(t){t?(this.l.info("Successfully pinged google.com"),jt(2)):(this.l.info("Failed to ping google.com"),jt(1))};function DR(t){if(t.H=0,t.ma=[],t.h){let e=lR(t.i);(e.length!=0||t.j.length!=0)&&(mM(t.ma,e),mM(t.ma,t.j),t.i.i.length=0,Fw(t.j),t.j.length=0),t.h.ya()}}function TR(t,e,n){var r=n instanceof xs?Br(n):new xs(n);if(r.g!="")e&&(r.g=e+"."+r.g),Yf(r,r.m);else{var i=Q.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new xs(null);r&&Qf(s,r),e&&(s.g=e),i&&Yf(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Ne(r,n,e),Ne(r,"VER",t.ra),nl(t,r),r}function bR(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new Be(new el({ob:n})):new Be(t.va),e.Oa(t.J),e}R.isActive=function(){return!!this.h&&this.h.isActive(this)};function SR(){}R=SR.prototype;R.Ba=function(){};R.Aa=function(){};R.za=function(){};R.ya=function(){};R.isActive=function(){return!0};R.Va=function(){};function Jf(){if(va&&!(10<=Number(pq)))throw Error("Environmental error: no available transport.")}Jf.prototype.g=function(t,e){return new sn(t,e)};function sn(t,e){ft.call(this),this.g=new yR(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Uc(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Uc(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Ea(this)}pt(sn,ft);sn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;jt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=TR(t,null,t.Y),gp(t)};sn.prototype.close=function(){Xw(this.g)};sn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Hw(t),t=n);e.j.push(new Uq(e.fb++,t)),e.H==3&&gp(e)};sn.prototype.N=function(){this.g.h=null,delete this.j,Xw(this.g),delete this.g,sn.$.N.call(this)};function AR(t){Kw.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}pt(AR,Kw);function xR(){Qw.call(this),this.status=1}pt(xR,Qw);function Ea(t){this.g=t}pt(Ea,SR);Ea.prototype.Ba=function(){Tt(this.g,"a")};Ea.prototype.Aa=function(t){Tt(this.g,new AR(t))};Ea.prototype.za=function(t){Tt(this.g,new xR)};Ea.prototype.ya=function(){Tt(this.g,"b")};function Jq(){this.blockSize=-1}function Bn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}pt(Bn,Jq);Bn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function _w(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Bn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)_w(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){_w(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){_w(this,r),i=0;break}}this.h=i,this.i+=e};Bn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Ce(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var Xq={};function nE(t){return-128<=t&&128>t?dq(t,function(e){return new Ce([e|0],0>e?-1:0)}):new Ce([t|0],0>t?-1:0)}function dr(t){if(isNaN(t)||!isFinite(t))return _a;if(0>t)return Dt(dr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Pw;return new Ce(e,0)}function MR(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Dt(MR(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=dr(Math.pow(e,8)),r=_a,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=dr(Math.pow(e,s)),r=r.R(s).add(dr(o))):(r=r.R(n),r=r.add(dr(o)))}return r}var Pw=4294967296,_a=nE(0),kw=nE(1),bM=nE(16777216);R=Ce.prototype;R.ea=function(){if(Cn(this))return-Dt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Pw+r)*e,e*=Pw}return t};R.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Ur(this))return"0";if(Cn(this))return"-"+Dt(this).toString(t);for(var e=dr(Math.pow(t,6)),n=this,r="";;){var i=ep(n,e).g;n=Xf(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Ur(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};R.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Ur(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Cn(t){return t.h==-1}R.X=function(t){return t=Xf(this,t),Cn(t)?-1:Ur(t)?0:1};function Dt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ce(n,~t.h).add(kw)}R.abs=function(){return Cn(this)?Dt(this):this};R.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Ce(n,n[n.length-1]&-2147483648?-1:0)};function Xf(t,e){return t.add(Dt(e))}R.R=function(t){if(Ur(this)||Ur(t))return _a;if(Cn(this))return Cn(t)?Dt(this).R(Dt(t)):Dt(Dt(this).R(t));if(Cn(t))return Dt(this.R(Dt(t)));if(0>this.X(bM)&&0>t.X(bM))return dr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,u=t.D(i)&65535;n[2*r+2*i]+=o*u,Kf(n,2*r+2*i),n[2*r+2*i+1]+=s*u,Kf(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Kf(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Kf(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ce(n,0)};function Kf(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Fc(t,e){this.g=t,this.h=e}function ep(t,e){if(Ur(e))throw Error("division by zero");if(Ur(t))return new Fc(_a,_a);if(Cn(t))return e=ep(Dt(t),e),new Fc(Dt(e.g),Dt(e.h));if(Cn(e))return e=ep(t,Dt(e)),new Fc(Dt(e.g),e.h);if(30<t.g.length){if(Cn(t)||Cn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=kw,r=e;0>=r.X(t);)n=SM(n),r=SM(r);var i=ma(n,1),s=ma(r,1);for(r=ma(r,2),n=ma(n,2);!Ur(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=ma(r,1),n=ma(n,1)}return e=Xf(t,i.R(e)),new Fc(i,e)}for(i=_a;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=dr(n),o=s.R(e);Cn(o)||0<o.X(t);)n-=r,s=dr(n),o=s.R(e);Ur(s)&&(s=kw),i=i.add(s),t=Xf(t,o)}return new Fc(i,t)}R.gb=function(t){return ep(this,t).h};R.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ce(n,this.h&t.h)};R.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ce(n,this.h|t.h)};R.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ce(n,this.h^t.h)};function SM(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ce(n,t.h)}function ma(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ce(i,t.h)}Jf.prototype.createWebChannel=Jf.prototype.g;sn.prototype.send=sn.prototype.u;sn.prototype.open=sn.prototype.m;sn.prototype.close=sn.prototype.close;up.NO_ERROR=0;up.TIMEOUT=8;up.HTTP_ERROR=6;WM.COMPLETE="complete";KM.EventType=Zc;Zc.OPEN="a";Zc.CLOSE="b";Zc.ERROR="c";Zc.MESSAGE="d";ft.prototype.listen=ft.prototype.O;Be.prototype.listenOnce=Be.prototype.P;Be.prototype.getLastError=Be.prototype.Sa;Be.prototype.getLastErrorCode=Be.prototype.Ia;Be.prototype.getStatus=Be.prototype.da;Be.prototype.getResponseJson=Be.prototype.Wa;Be.prototype.getResponseText=Be.prototype.ja;Be.prototype.send=Be.prototype.ha;Be.prototype.setWithCredentials=Be.prototype.Oa;Bn.prototype.digest=Bn.prototype.l;Bn.prototype.reset=Bn.prototype.reset;Bn.prototype.update=Bn.prototype.j;Ce.prototype.add=Ce.prototype.add;Ce.prototype.multiply=Ce.prototype.R;Ce.prototype.modulo=Ce.prototype.gb;Ce.prototype.compare=Ce.prototype.X;Ce.prototype.toNumber=Ce.prototype.ea;Ce.prototype.toString=Ce.prototype.toString;Ce.prototype.getBits=Ce.prototype.D;Ce.fromNumber=dr;Ce.fromString=MR;var RR=$n.createWebChannelTransport=function(){return new Jf},NR=$n.getStatEventTarget=function(){return ap()},mp=$n.ErrorCode=up,PR=$n.EventType=WM,kR=$n.Event=Ms,rE=$n.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Iee=$n.FetchXmlHttpFactory=el,rl=$n.WebChannel=KM,OR=$n.XhrIo=Be,FR=$n.Md5=Bn,Rs=$n.Integer=Ce;var VR="@firebase/firestore";var st=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};st.UNAUTHENTICATED=new st(null),st.GOOGLE_CREDENTIALS=new st("google-credentials-uid"),st.FIRST_PARTY=new st("first-party-uid"),st.MOCK_USER=new st("mock-user");var Za="10.8.0";var Mi=new ei("@firebase/firestore");function ba(){return Mi.logLevel}function FN(t){Mi.setLogLevel(t)}function C(t,...e){if(Mi.logLevel<=pn.DEBUG){let n=e.map(sC);Mi.debug(`Firestore (${Za}): ${t}`,...n)}}function ze(t,...e){if(Mi.logLevel<=pn.ERROR){let n=e.map(sC);Mi.error(`Firestore (${Za}): ${t}`,...n)}}function Tn(t,...e){if(Mi.logLevel<=pn.WARN){let n=e.map(sC);Mi.warn(`Firestore (${Za}): ${t}`,...n)}}function sC(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function O(t="Unexpected state"){let e=`FIRESTORE (${Za}) INTERNAL ASSERTION FAILED: `+t;throw ze(e),new Error(e)}function L(t,e){t||O()}function VN(t,e){t||O()}function N(t,e){return t}var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},E=class extends lT{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ot=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Sp=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},uE=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(st.UNAUTHENTICATED))}shutdown(){}},cE=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},lE=class{constructor(e){this.t=e,this.currentUser=st.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve(),s=new ot;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ot,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>v(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{C("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(C("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ot)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(C("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(L(typeof r.accessToken=="string"),new Sp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return L(e===null||typeof e=="string"),new st(e)}},dE=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=st.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},hE=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new dE(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(st.FIRST_PARTY))}shutdown(){}invalidateToken(){}},fE=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},pE=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&C("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,C("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{C("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):C("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(L(typeof n.token=="string"),this.R=n.token,new fE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function tG(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Ap=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=tG(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function Z(t,e){return t<e?-1:t>e?1:0}function Oa(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function LN(t){return t+"\0"}var je=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new E(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new E(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new E(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new E(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Z(this.nanoseconds,e.nanoseconds):Z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var B=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new je(0,0))}static max(){return new t(new je(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var xp=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&O(),r===void 0?r=e.length-n:r>e.length-n&&O(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},me=class t extends xp{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new E(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},nG=/^[_a-zA-Z][_a-zA-Z0-9]*$/,We=class t extends xp{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return nG.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new E(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new E(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new E(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new E(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var M=class t{constructor(e){this.path=e}static fromPath(e){return new t(me.fromString(e))}static fromName(e){return new t(me.fromString(e).popFirst(5))}static empty(){return new t(me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return me.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new me(e.slice()))}};var Fa=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function gE(t){return t.fields.find(e=>e.kind===2)}function Ps(t){return t.fields.filter(e=>e.kind!==2)}Fa.UNKNOWN_ID=-1;var Na=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var gl=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,bn.min())}};function jN(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=B.fromTimestamp(r===1e9?new je(n+1,0):new je(n,r));return new bn(i,M.empty(),e)}function UN(t){return new bn(t.readTime,t.key,-1)}var bn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(B.min(),M.empty(),-1)}static max(){return new t(B.max(),M.empty(),-1)}};function oC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=M.comparator(t.documentKey,e.documentKey),n!==0?n:Z(t.largestBatchId,e.largestBatchId))}var BN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Mp=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ui(t){return v(this,null,function*(){if(t.code!==y.FAILED_PRECONDITION||t.message!==BN)throw t;C("LocalStore","Unexpectedly lost primary lease")})}var m=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&O(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let c=u;n(e[c]).next(l=>{o[c]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Rp=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new ot,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new js(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=aC(r.target.error);this.V.reject(new js(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new js(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(C("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new yE(n)}},qr=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(Au())===12.2&&ze("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return C("SimpleDb","Removing database:",e),ks(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Nd())return!1;if(t.C())return!0;let e=Au(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return v(this,null,function*(){return this.db||(C("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new js(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new E(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new E(y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new js(e,o))},i.onupgradeneeded=s=>{C("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{C("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db})}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return v(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=Rp.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),m.reject(c))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,c=u.name!=="FirebaseError"&&o<3;if(C("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}},mE=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return ks(this.k.delete())}},js=class extends E{constructor(e,n){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function Bi(t){return t.name==="IndexedDbTransactionError"}var yE=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(C("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(C("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ks(r)}add(e){return C("SimpleDb","ADD",this.store.name,e,e),ks(this.store.add(e))}get(e){return ks(this.store.get(e)).next(n=>(n===void 0&&(n=null),C("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return C("SimpleDb","DELETE",this.store.name,e),ks(this.store.delete(e))}count(){return C("SimpleDb","COUNT",this.store.name),ks(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new m((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,u)=>{o.push(u)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new m((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){C("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new m((r,i)=>{n.onerror=s=>{let o=aC(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new m((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let u=new mE(a),c=n(a.primaryKey,a.value,u);if(c instanceof m){let l=c.catch(d=>(u.done(),m.reject(d)));r.push(l)}u.isDone?i():u.$===null?a.continue():a.continue(u.$)}}).next(()=>m.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function ks(t){return new m((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=aC(r.target.error);n(i)}})}var LR=!1;function aC(t){let e=qr.S(Au());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new E("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return LR||(LR=!0,setTimeout(()=>{throw r},0)),r}}return t}var _E=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){C("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>v(this,null,function*(){this.task=null;try{C("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){Bi(n)?C("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Ui(n)}yield this.ee(6e4)}))}},vE=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return v(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return m.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return C("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(C("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=UN(s);oC(o,r)>0&&(r=o)}),new bn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var on=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function Ll(t){return t==null}function ml(t){return t===0&&1/t==-1/0}function $N(t){return typeof t=="number"&&Number.isInteger(t)&&!ml(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Ut(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=jR(e)),e=rG(t.get(n),e);return jR(e)}function rG(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function jR(t){return t+""}function hr(t){let e=t.length;if(L(e>=2),e===2)return L(t.charAt(0)===""&&t.charAt(1)===""),me.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&O(),t.charAt(o+1)){case"":let a=t.substring(s,o),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:O()}s=o+2}return new me(r)}var UR=["userId","batchId"];function Ep(t,e){return[t,Ut(e)]}function HN(t,e,n){return[t,Ut(e),n]}var iG={},sG=["prefixPath","collectionGroup","readTime","documentId"],oG=["prefixPath","collectionGroup","documentId"],aG=["collectionGroup","readTime","prefixPath","documentId"],uG=["canonicalId","targetId"],cG=["targetId","path"],lG=["path","targetId"],dG=["collectionId","parent"],hG=["indexId","uid"],fG=["uid","sequenceNumber"],pG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],gG=["indexId","uid","orderedDocumentKey"],mG=["userId","collectionPath","documentId"],yG=["userId","collectionPath","largestBatchId"],_G=["userId","collectionGroup","largestBatchId"],qN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],vG=[...qN,"documentOverlays"],GN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],zN=GN,wG=[...zN,"indexConfiguration","indexState","indexEntries"];var yl=class extends Mp{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function mt(t,e){let n=N(t);return qr.M(n.ae,e)}function BR(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Zs(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function WN(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Pe=class t{constructor(e,n){this.comparator=e,this.root=n||pr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,pr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ra(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ra(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ra(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ra(this.root,e,this.comparator,!0)}},Ra=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},pr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw O();let e=this.left.check();if(e!==this.right.check())throw O();return e+(this.isRed()?0:1)}};pr.EMPTY=null,pr.RED=!0,pr.BLACK=!1;pr.EMPTY=new class{constructor(){this.size=0}get key(){throw O()}get value(){throw O()}get color(){throw O()}get left(){throw O()}get right(){throw O()}copy(e,n,r,i,s){return this}insert(e,n,r){return new pr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Se=class t{constructor(e){this.comparator=e,this.data=new Pe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Np(this.data.getIterator())}getIteratorFrom(e){return new Np(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Np=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ia(t){return t.hasNext()?t.getNext():void 0}var an=class t{constructor(e){this.fields=e,e.sort(We.comparator)}static empty(){return new t([])}unionWith(e){let n=new Se(We.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Oa(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Pp=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function KN(){return typeof atob<"u"}var gt=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Pp("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};gt.EMPTY_BYTE_STRING=new gt("");var EG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ri(t){if(L(!!t),typeof t=="string"){let e=0,n=EG.exec(t);if(L(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:$e(t.seconds),nanos:$e(t.nanos)}}function $e(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ni(t){return typeof t=="string"?gt.fromBase64String(t):gt.fromUint8Array(t)}function Cg(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function uC(t){let e=t.mapValue.fields.__previous_value__;return Cg(e)?uC(e):e}function _l(t){let e=Ri(t.mapValue.fields.__local_write_time__.timestampValue);return new je(e.seconds,e.nanos)}var wE=class{constructor(e,n,r,i,s,o,a,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}},Pi=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Ai={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ip={nullValue:"NULL_VALUE"};function Us(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Cg(t)?4:QN(t)?9007199254740991:10:O()}function yr(t,e){if(t===e)return!0;let n=Us(t);if(n!==Us(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return _l(t).isEqual(_l(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Ri(i.timestampValue),a=Ri(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ni(i.bytesValue).isEqual(Ni(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return $e(i.geoPointValue.latitude)===$e(s.geoPointValue.latitude)&&$e(i.geoPointValue.longitude)===$e(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return $e(i.integerValue)===$e(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=$e(i.doubleValue),a=$e(s.doubleValue);return o===a?ml(o)===ml(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Oa(t.arrayValue.values||[],e.arrayValue.values||[],yr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(BR(o)!==BR(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!yr(o[u],a[u])))return!1;return!0}(t,e);default:return O()}}function vl(t,e){return(t.values||[]).find(n=>yr(n,e))!==void 0}function ki(t,e){if(t===e)return 0;let n=Us(t),r=Us(e);if(n!==r)return Z(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Z(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=$e(s.integerValue||s.doubleValue),u=$e(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return $R(t.timestampValue,e.timestampValue);case 4:return $R(_l(t),_l(e));case 5:return Z(t.stringValue,e.stringValue);case 6:return function(s,o){let a=Ni(s),u=Ni(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){let l=Z(a[c],u[c]);if(l!==0)return l}return Z(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=Z($e(s.latitude),$e(o.latitude));return a!==0?a:Z($e(s.longitude),$e(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],u=o.values||[];for(let c=0;c<a.length&&c<u.length;++c){let l=ki(a[c],u[c]);if(l)return l}return Z(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Ai.mapValue&&o===Ai.mapValue)return 0;if(s===Ai.mapValue)return 1;if(o===Ai.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),c=o.fields||{},l=Object.keys(c);u.sort(),l.sort();for(let d=0;d<u.length&&d<l.length;++d){let h=Z(u[d],l[d]);if(h!==0)return h;let f=ki(a[u[d]],c[l[d]]);if(f!==0)return f}return Z(u.length,l.length)}(t.mapValue,e.mapValue);default:throw O()}}function $R(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Z(t,e);let n=Ri(t),r=Ri(e),i=Z(n.seconds,r.seconds);return i!==0?i:Z(n.nanos,r.nanos)}function Va(t){return EE(t)}function EE(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Ri(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ni(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return M.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=EE(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${EE(n.fields[o])}`;return i+"}"}(t.mapValue):O()}function Bs(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function IE(t){return!!t&&"integerValue"in t}function wl(t){return!!t&&"arrayValue"in t}function HR(t){return!!t&&"nullValue"in t}function qR(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Cp(t){return!!t&&"mapValue"in t}function ll(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return Zs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ll(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ll(t.arrayValue.values[n]);return e}return Object.assign({},t)}function QN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function IG(t){return"nullValue"in t?Ip:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Bs(Pi.empty(),M.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:O()}function CG(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Bs(Pi.empty(),M.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Ai:O()}function GR(t,e){let n=ki(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function zR(t,e){let n=ki(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var Pt=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Cp(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ll(n)}setAll(e){let n=We.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=ll(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Cp(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return yr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Cp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Zs(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(ll(this.value))}};function YN(t){let e=[];return Zs(t.fields,(n,r)=>{let i=new We([n]);if(Cp(r)){let s=YN(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new an(e)}var at=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,B.min(),B.min(),B.min(),Pt.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,B.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,B.min(),B.min(),Pt.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,B.min(),B.min(),Pt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(B.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var _r=class{constructor(e,n){this.position=e,this.inclusive=n}};function WR(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=M.comparator(M.fromName(o.referenceValue),n.key):r=ki(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function KR(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!yr(t.position[n],e.position[n]))return!1;return!0}var $s=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function DG(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var kp=class{},fe=class t extends kp{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new TE(e,n,r):n==="array-contains"?new AE(e,r):n==="in"?new Op(e,r):n==="not-in"?new xE(e,r):n==="array-contains-any"?new ME(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new bE(e,r):new SE(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ki(n,this.value)):n!==null&&Us(this.value)===Us(n)&&this.matchesComparison(ki(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return O()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},De=class t extends kp{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return La(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function La(t){return t.op==="and"}function CE(t){return t.op==="or"}function cC(t){return ZN(t)&&La(t)}function ZN(t){for(let e of t.filters)if(e instanceof De)return!1;return!0}function DE(t){if(t instanceof fe)return t.field.canonicalString()+t.op.toString()+Va(t.value);if(cC(t))return t.filters.map(e=>DE(e)).join(",");{let e=t.filters.map(n=>DE(n)).join(",");return`${t.op}(${e})`}}function JN(t,e){return t instanceof fe?function(r,i){return i instanceof fe&&r.op===i.op&&r.field.isEqual(i.field)&&yr(r.value,i.value)}(t,e):t instanceof De?function(r,i){return i instanceof De&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&JN(o,i.filters[a]),!0):!1}(t,e):void O()}function XN(t,e){let n=t.filters.concat(e);return De.create(n,t.op)}function eP(t){return t instanceof fe?function(n){return`${n.field.canonicalString()} ${n.op} ${Va(n.value)}`}(t):t instanceof De?function(n){return n.op.toString()+" {"+n.getFilters().map(eP).join(" ,")+"}"}(t):"Filter"}var TE=class extends fe{constructor(e,n,r){super(e,n,r),this.key=M.fromName(r.referenceValue)}matches(e){let n=M.comparator(e.key,this.key);return this.matchesComparison(n)}},bE=class extends fe{constructor(e,n){super(e,"in",n),this.keys=tP("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},SE=class extends fe{constructor(e,n){super(e,"not-in",n),this.keys=tP("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function tP(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>M.fromName(r.referenceValue))}var AE=class extends fe{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return wl(n)&&vl(n.arrayValue,this.value)}},Op=class extends fe{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&vl(this.value.arrayValue,n)}},xE=class extends fe{constructor(e,n){super(e,"not-in",n)}matches(e){if(vl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!vl(this.value.arrayValue,n)}},ME=class extends fe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!wl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>vl(this.value.arrayValue,r))}};var RE=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function NE(t,e=null,n=[],r=[],i=null,s=null,o=null){return new RE(t,e,n,r,i,s,o)}function Hs(t){let e=N(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>DE(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ll(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Va(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Va(r)).join(",")),e.ce=n}return e.ce}function jl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!DG(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!JN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!KR(t.startAt,e.startAt)&&KR(t.endAt,e.endAt)}function Fp(t){return M.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Vp(t,e){return t.filters.filter(n=>n instanceof fe&&n.field.isEqual(e))}function QR(t,e,n){let r=Ip,i=!0;for(let s of Vp(t,e)){let o=Ip,a=!0;switch(s.op){case"<":case"<=":o=IG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Ip}GR({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];GR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function YR(t,e,n){let r=Ai,i=!0;for(let s of Vp(t,e)){let o=Ai,a=!0;switch(s.op){case">=":case">":o=CG(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ai}zR({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];zR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var Hn=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function nP(t,e,n,r,i,s,o,a){return new Hn(t,e,n,r,i,s,o,a)}function Ja(t){return new Hn(t)}function ZR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function lC(t){return t.collectionGroup!==null}function Pa(t){let e=N(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Se(We.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new $s(s,r))}),n.has(We.keyField().canonicalString())||e.le.push(new $s(We.keyField(),r))}return e.le}function Bt(t){let e=N(t);return e.he||(e.he=TG(e,Pa(t))),e.he}function TG(t,e){if(t.limitType==="F")return NE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new $s(i.field,s)});let n=t.endAt?new _r(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new _r(t.startAt.position,t.startAt.inclusive):null;return NE(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function PE(t,e){let n=t.filters.concat([e]);return new Hn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Lp(t,e,n){return new Hn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ul(t,e){return jl(Bt(t),Bt(e))&&t.limitType===e.limitType}function rP(t){return`${Hs(Bt(t))}|lt:${t.limitType}`}function Sa(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>eP(i)).join(", ")}]`),Ll(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Va(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Va(i)).join(",")),`Target(${r})`}(Bt(t))}; limitType=${t.limitType})`}function Bl(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):M.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Pa(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let c=WR(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,Pa(r),i)||r.endAt&&!function(o,a,u){let c=WR(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,Pa(r),i))}(t,e)}function iP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function sP(t){return(e,n)=>{let r=!1;for(let i of Pa(t)){let s=bG(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function bG(t,e,n){let r=t.field.isKeyField()?M.comparator(e.key,n.key):function(s,o,a){let u=o.data.field(s),c=a.data.field(s);return u!==null&&c!==null?ki(u,c):O()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return O()}}var vr=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Zs(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return WN(this.inner)}size(){return this.innerSize}};var SG=new Pe(M.comparator);function Jt(){return SG}var oP=new Pe(M.comparator);function ul(...t){let e=oP;for(let n of t)e=e.insert(n.key,n);return e}function aP(t){let e=oP;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function fr(){return dl()}function uP(){return dl()}function dl(){return new vr(t=>t.toString(),(t,e)=>t.isEqual(e))}var AG=new Pe(M.comparator),xG=new Se(M.comparator);function ee(...t){let e=xG;for(let n of t)e=e.add(n);return e}var MG=new Se(Z);function dC(){return MG}function cP(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ml(e)?"-0":e}}function lP(t){return{integerValue:""+t}}function dP(t,e){return $N(e)?lP(e):cP(t,e)}var ja=class{constructor(){this._=void 0}};function RG(t,e,n){return t instanceof Oi?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Cg(s)&&(s=uC(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Gr?fP(t,e):t instanceof zr?pP(t,e):function(i,s){let o=hP(i,s),a=JR(o)+JR(i.Ie);return IE(o)&&IE(i.Ie)?lP(a):cP(i.serializer,a)}(t,e)}function NG(t,e,n){return t instanceof Gr?fP(t,e):t instanceof zr?pP(t,e):n}function hP(t,e){return t instanceof Fi?function(r){return IE(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Oi=class extends ja{},Gr=class extends ja{constructor(e){super(),this.elements=e}};function fP(t,e){let n=gP(e);for(let r of t.elements)n.some(i=>yr(i,r))||n.push(r);return{arrayValue:{values:n}}}var zr=class extends ja{constructor(e){super(),this.elements=e}};function pP(t,e){let n=gP(e);for(let r of t.elements)n=n.filter(i=>!yr(i,r));return{arrayValue:{values:n}}}var Fi=class extends ja{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function JR(t){return $e(t.integerValue||t.doubleValue)}function gP(t){return wl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var qs=class{constructor(e,n){this.field=e,this.transform=n}};function PG(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Gr&&i instanceof Gr||r instanceof zr&&i instanceof zr?Oa(r.elements,i.elements,yr):r instanceof Fi&&i instanceof Fi?yr(r.Ie,i.Ie):r instanceof Oi&&i instanceof Oi}(t.transform,e.transform)}var kE=class{constructor(e,n){this.version=e,this.transformResults=n}},He=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Dp(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Ua=class{};function mP(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Li(t.key,He.none()):new Vi(t.key,t.data,He.none());{let n=t.data,r=Pt.empty(),i=new Se(We.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new qn(t.key,r,new an(i.toArray()),He.none())}}function kG(t,e,n){t instanceof Vi?function(i,s,o){let a=i.value.clone(),u=eN(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof qn?function(i,s,o){if(!Dp(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=eN(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(yP(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function hl(t,e,n,r){return t instanceof Vi?function(s,o,a,u){if(!Dp(s.precondition,o))return a;let c=s.value.clone(),l=tN(s.fieldTransforms,u,o);return c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof qn?function(s,o,a,u){if(!Dp(s.precondition,o))return a;let c=tN(s.fieldTransforms,u,o),l=o.data;return l.setAll(yP(s)),l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Dp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function OG(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=hP(r.transform,i||null);s!=null&&(n===null&&(n=Pt.empty()),n.set(r.field,s))}return n||null}function XR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Oa(r,i,(s,o)=>PG(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Vi=class extends Ua{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},qn=class extends Ua{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function yP(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function eN(t,e,n){let r=new Map;L(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,NG(o,a,n[i]))}return r}function tN(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,RG(s,o,e))}return r}var Li=class extends Ua{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},El=class extends Ua{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Il=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&kG(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=hl(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=hl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=uP();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let u=mP(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(B.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ee())}isEqual(e){return this.batchId===e.batchId&&Oa(this.mutations,e.mutations,(n,r)=>XR(n,r))&&Oa(this.baseMutations,e.baseMutations,(n,r)=>XR(n,r))}},OE=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){L(e.mutations.length===r.length);let i=function(){return AG}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var Cl=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var FE=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var rt,ge;function _P(t){switch(t){default:return O();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function vP(t){if(t===void 0)return ze("GRPC error has no .code"),y.UNKNOWN;switch(t){case rt.OK:return y.OK;case rt.CANCELLED:return y.CANCELLED;case rt.UNKNOWN:return y.UNKNOWN;case rt.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case rt.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case rt.INTERNAL:return y.INTERNAL;case rt.UNAVAILABLE:return y.UNAVAILABLE;case rt.UNAUTHENTICATED:return y.UNAUTHENTICATED;case rt.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case rt.NOT_FOUND:return y.NOT_FOUND;case rt.ALREADY_EXISTS:return y.ALREADY_EXISTS;case rt.PERMISSION_DENIED:return y.PERMISSION_DENIED;case rt.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case rt.ABORTED:return y.ABORTED;case rt.OUT_OF_RANGE:return y.OUT_OF_RANGE;case rt.UNIMPLEMENTED:return y.UNIMPLEMENTED;case rt.DATA_LOSS:return y.DATA_LOSS;default:return O()}}(ge=rt||(rt={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";var nN=null;function wP(){return new TextEncoder}var FG=new Rs([4294967295,4294967295],0);function rN(t){let e=wP().encode(t),n=new FR;return n.update(e),new Uint8Array(n.digest())}function iN(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Rs([n,r],0),new Rs([i,s],0)]}var VE=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ls(`Invalid padding: ${n}`);if(r<0)throw new Ls(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ls(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ls(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Rs.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Rs.fromNumber(r)));return i.compare(FG)===1&&(i=new Rs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=rN(e),[r,i]=iN(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=rN(e),[r,i]=iN(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Ls=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Dl=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,Tl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(B.min(),i,new Pe(Z),Jt(),ee())}},Tl=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,ee(),ee(),ee())}};var ka=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},jp=class{constructor(e,n){this.targetId=e,this.fe=n}},Up=class{constructor(e,n,r=gt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},Bp=class{constructor(){this.ge=0,this.pe=oN(),this.ye=gt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=ee(),n=ee(),r=ee();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:O()}}),new Tl(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=oN()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,L(this.ge>=0)}Be(){this.Se=!0,this.we=!0}},LE=class{constructor(e){this.Le=e,this.ke=new Map,this.qe=Jt(),this.Qe=sN(),this.Ke=new Pe(Z)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:O()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(Fp(s))if(r===0){let o=new M(s.path);this.We(n,o,at.newNoDocument(o,B.min()))}else L(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),u=a?this.et(a,e,o):1;if(u!==0){this.He(n);let c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,c)}nN?.tt(function(l,d,h,f,p){var g,_,T,P,A,H;let G={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},X=d.unchangedNames;return X&&(G.bloomFilter={applied:p===0,hashCount:(g=X?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(P=(T=(_=X?.bits)===null||_===void 0?void 0:_.bitmap)===null||T===void 0?void 0:T.length)!==null&&P!==void 0?P:0,padding:(H=(A=X?.bits)===null||A===void 0?void 0:A.padding)!==null&&H!==void 0?H:0,mightContain:ke=>{var hn;return(hn=f?.mightContain(ke))!==null&&hn!==void 0&&hn}}),G}(o,e.fe,this.Le.nt(),a,u))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=Ni(r).toUint8Array()}catch(u){if(u instanceof Pp)return Tn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new VE(o,i,s)}catch(u){return Tn(u instanceof Ls?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&Fp(a.target)){let u=new M(a.target.path);this.qe.get(u)!==null||this.st(o,u)||this.We(o,u,at.newNoDocument(u,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=ee();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{let c=this.Ye(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new Dl(e,n,this.Ke,this.qe,r);return this.qe=Jt(),this.Qe=sN(),this.Ke=new Pe(Z),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new Bp,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Se(Z),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||C("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Bp),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function sN(){return new Pe(M.comparator)}function oN(){return new Pe(M.comparator)}var VG={asc:"ASCENDING",desc:"DESCENDING"},LG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jG={and:"AND",or:"OR"},jE=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function UE(t,e){return t.useProto3Json||Ll(e)?e:{value:e}}function Ba(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function EP(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function UG(t,e){return Ba(t,e.toTimestamp())}function Ke(t){return L(!!t),B.fromTimestamp(function(n){let r=Ri(n);return new je(r.seconds,r.nanos)}(t))}function hC(t,e){return BE(t,e).canonicalString()}function BE(t,e){let n=function(i){return new me(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function IP(t){let e=me.fromString(t);return L(NP(e)),e}function bl(t,e){return hC(t.databaseId,e.path)}function gr(t,e){let n=IP(e);if(n.get(1)!==t.databaseId.projectId)throw new E(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new E(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new M(TP(n))}function CP(t,e){return hC(t.databaseId,e)}function DP(t){let e=IP(t);return e.length===4?me.emptyPath():TP(e)}function $E(t){return new me(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function TP(t){return L(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function aN(t,e,n){return{name:bl(t,e),fields:n.value.mapValue.fields}}function bP(t,e,n){let r=gr(t,e.name),i=Ke(e.updateTime),s=e.createTime?Ke(e.createTime):B.min(),o=new Pt({mapValue:{fields:e.fields}}),a=at.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function BG(t,e){return"found"in e?function(r,i){L(!!i.found),i.found.name,i.found.updateTime;let s=gr(r,i.found.name),o=Ke(i.found.updateTime),a=i.found.createTime?Ke(i.found.createTime):B.min(),u=new Pt({mapValue:{fields:i.found.fields}});return at.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){L(!!i.missing),L(!!i.readTime);let s=gr(r,i.missing),o=Ke(i.readTime);return at.newNoDocument(s,o)}(t,e):O()}function $G(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:O()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(L(l===void 0||typeof l=="string"),gt.fromBase64String(l||"")):(L(l===void 0||l instanceof Uint8Array),gt.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let l=c.code===void 0?y.UNKNOWN:vP(c.code);return new E(l,c.message||"")}(o);n=new Up(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=gr(t,r.document.name),s=Ke(r.document.updateTime),o=r.document.createTime?Ke(r.document.createTime):B.min(),a=new Pt({mapValue:{fields:r.document.fields}}),u=at.newFoundDocument(i,s,o,a),c=r.targetIds||[],l=r.removedTargetIds||[];n=new ka(c,l,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=gr(t,r.document),s=r.readTime?Ke(r.readTime):B.min(),o=at.newNoDocument(i,s),a=r.removedTargetIds||[];n=new ka([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=gr(t,r.document),s=r.removedTargetIds||[];n=new ka([],s,i,null)}else{if(!("filter"in e))return O();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new FE(i,s),a=r.targetId;n=new jp(a,o)}}return n}function Sl(t,e){let n;if(e instanceof Vi)n={update:aN(t,e.key,e.value)};else if(e instanceof Li)n={delete:bl(t,e.key)};else if(e instanceof qn)n={update:aN(t,e.key,e.data),updateMask:KG(e.fieldMask)};else{if(!(e instanceof El))return O();n={verify:bl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Oi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Gr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof zr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Fi)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw O()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:UG(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:O()}(t,e.precondition)),n}function HE(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?He.updateTime(Ke(s.updateTime)):s.exists!==void 0?He.exists(s.exists):He.none()}(e.currentDocument):He.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)L(a.setToServerValue==="REQUEST_TIME"),u=new Oi;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];u=new Gr(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];u=new zr(l)}else"increment"in a?u=new Fi(o,a.increment):O();let c=We.fromServerFormat(a.fieldPath);return new qs(c,u)}(t,i)):[];if(e.update){e.update.name;let i=gr(t,e.update.name),s=new Pt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(u){let c=u.fieldPaths||[];return new an(c.map(l=>We.fromServerFormat(l)))}(e.updateMask);return new qn(i,s,o,n,r)}return new Vi(i,s,n,r)}if(e.delete){let i=gr(t,e.delete);return new Li(i,n)}if(e.verify){let i=gr(t,e.verify);return new El(i,n)}return O()}function HG(t,e){return t&&t.length>0?(L(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Ke(i.updateTime):Ke(s);return o.isEqual(B.min())&&(o=Ke(s)),new kE(o,i.transformResults||[])}(n,e))):[]}function SP(t,e){return{documents:[CP(t,e.path)]}}function AP(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=CP(t,i);let s=function(c){if(c.length!==0)return RP(De.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(c){if(c.length!==0)return c.map(l=>function(h){return{field:Aa(h.field),direction:GG(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=UE(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ut:n,parent:i}}function xP(t){let e=DP(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){L(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=MP(d);return h instanceof De&&cC(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new $s(xa(p.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Ll(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(d){let h=!!d.before,f=d.values||[];return new _r(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){let h=!d.before,f=d.values||[];return new _r(f,h)}(n.endAt)),nP(e,i,o,s,a,"F",u,c)}function qG(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return O()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function MP(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=xa(n.unaryFilter.field);return fe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=xa(n.unaryFilter.field);return fe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=xa(n.unaryFilter.field);return fe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=xa(n.unaryFilter.field);return fe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return O()}}(t):t.fieldFilter!==void 0?function(n){return fe.create(xa(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return O()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return De.create(n.compositeFilter.filters.map(r=>MP(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return O()}}(n.compositeFilter.op))}(t):O()}function GG(t){return VG[t]}function zG(t){return LG[t]}function WG(t){return jG[t]}function Aa(t){return{fieldPath:t.canonicalString()}}function xa(t){return We.fromServerFormat(t.fieldPath)}function RP(t){return t instanceof fe?function(n){if(n.op==="=="){if(qR(n.value))return{unaryFilter:{field:Aa(n.field),op:"IS_NAN"}};if(HR(n.value))return{unaryFilter:{field:Aa(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(qR(n.value))return{unaryFilter:{field:Aa(n.field),op:"IS_NOT_NAN"}};if(HR(n.value))return{unaryFilter:{field:Aa(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Aa(n.field),op:zG(n.op),value:n.value}}}(t):t instanceof De?function(n){let r=n.getFilters().map(i=>RP(i));return r.length===1?r[0]:{compositeFilter:{op:WG(n.op),filters:r}}}(t):O()}function KG(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function NP(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var $a=class t{constructor(e,n,r,i,s=B.min(),o=B.min(),a=gt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var $p=class{constructor(e){this.ct=e}};function QG(t,e){let n;if(e.document)n=bP(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=M.fromSegments(e.noDocument.path),i=zs(e.noDocument.readTime);n=at.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return O();{let r=M.fromSegments(e.unknownDocument.path),i=zs(e.unknownDocument.version);n=at.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new je(i[0],i[1]);return B.fromTimestamp(s)}(e.readTime)),n}function uN(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Hp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:bl(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ba(s,o.version.toTimestamp()),createTime:Ba(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Gs(e.version)};else{if(!e.isUnknownDocument())return O();r.unknownDocument={path:n.path.toArray(),version:Gs(e.version)}}return r}function Hp(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Gs(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function zs(t){let e=new je(t.seconds,t.nanoseconds);return B.fromTimestamp(e)}function Os(t,e){let n=(e.baseMutations||[]).map(s=>HE(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>HE(t.ct,s)),i=je.fromMillis(e.localWriteTimeMs);return new Il(e.batchId,i,n,r)}function cl(t){let e=zs(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?zs(t.lastLimboFreeSnapshotVersion):B.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return L(s.documents.length===1),Bt(Ja(DP(s.documents[0])))}(t.query):function(s){return Bt(xP(s))}(t.query),new $a(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,gt.fromBase64String(t.resumeToken))}function PP(t,e){let n=Gs(e.snapshotVersion),r=Gs(e.lastLimboFreeSnapshotVersion),i;i=Fp(e.target)?SP(t.ct,e.target):AP(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Hs(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function fC(t){let e=xP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Lp(e,e.limit,"L"):e}function iE(t,e){return new Cl(e.largestBatchId,HE(t.ct,e.overlayMutation))}function cN(t,e){let n=e.path.lastSegment();return[t,Ut(e.path.popLast()),n]}function lN(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Gs(r.readTime),documentKey:Ut(r.documentKey.path),largestBatchId:r.largestBatchId}}var qE=class{getBundleMetadata(e,n){return dN(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:zs(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return dN(e).put(function(i){return{bundleId:i.id,createTime:Gs(Ke(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return hN(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:fC(s.bundledQuery),readTime:zs(s.readTime)}}(r)})}saveNamedQuery(e,n){return hN(e).put(function(i){return{name:i.name,readTime:Gs(Ke(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function dN(t){return mt(t,"bundles")}function hN(t){return mt(t,"namedQueries")}var qp=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return il(e).get(cN(this.userId,n)).next(r=>r?iE(this.serializer,r):null)}getOverlays(e,n){let r=fr();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new Cl(n,o);i.push(this.ht(e,a))}),m.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(Ut(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(il(e).H("collectionPathOverlayIndex",a))}),m.waitFor(s)}getOverlaysForCollection(e,n,r){let i=fr(),s=Ut(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return il(e).W("collectionPathOverlayIndex",o).next(a=>{for(let u of a){let c=iE(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=fr(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return il(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,c,l)=>{let d=iE(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}ht(e,n){return il(e).put(function(i,s,o){let[a,u,c]=cN(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Sl(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function il(t){return mt(t,"documentOverlays")}var $r=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt($e(e.integerValue));else if("doubleValue"in e){let r=$e(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),ml(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(Ni(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?QN(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):O()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),M.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};$r.bt=new $r;function YG(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function fN(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=YG(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var GE=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Bt(e){let n=this.Lt(e),r=fN(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Lt(e),r=fN(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},zE=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}},WE=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Fs=class{constructor(){this.Gt=new GE,this.zt=new zE(this.Gt),this.jt=new WE(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Vs=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function Di(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=pN(t.arrayValue,e.arrayValue),n!==0?n:(n=pN(t.directionalValue,e.directionalValue),n!==0?n:M.comparator(t.documentKey,e.documentKey)))}function pN(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var Gp=class{constructor(e){this.Yt=new Se((n,r)=>We.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(L(e.collectionGroup===this.collectionId),this.en)return!1;let n=gE(e);if(n!==void 0&&!this.nn(n))return!1;let r=Ps(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[s];if(!this.rn(a,u)||!this.sn(this.Zt[o++],u))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Se(We.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Na(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Na(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Na(r.field,r.dir==="asc"?0:1)));return new Fa(Fa.UNKNOWN_ID,this.collectionId,n,gl.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function kP(t){var e,n;if(L(t instanceof fe||t instanceof De),t instanceof fe){if(t instanceof Op){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>fe.create(t.field,"==",s)))||[];return De.create(i,"or")}return t}let r=t.filters.map(i=>kP(i));return De.create(r,t.op)}function ZG(t){if(t.getFilters().length===0)return[];let e=YE(kP(t));return L(OP(e)),KE(e)||QE(e)?[e]:e.getFilters()}function KE(t){return t instanceof fe}function QE(t){return t instanceof De&&cC(t)}function OP(t){return KE(t)||QE(t)||function(n){if(n instanceof De&&CE(n)){for(let r of n.getFilters())if(!KE(r)&&!QE(r))return!1;return!0}return!1}(t)}function YE(t){if(L(t instanceof fe||t instanceof De),t instanceof fe)return t;if(t.filters.length===1)return YE(t.filters[0]);let e=t.filters.map(r=>YE(r)),n=De.create(e,t.op);return n=zp(n),OP(n)?n:(L(n instanceof De),L(La(n)),L(n.filters.length>1),n.filters.reduce((r,i)=>pC(r,i)))}function pC(t,e){let n;return L(t instanceof fe||t instanceof De),L(e instanceof fe||e instanceof De),n=t instanceof fe?e instanceof fe?function(i,s){return De.create([i,s],"and")}(t,e):gN(t,e):e instanceof fe?gN(e,t):function(i,s){if(L(i.filters.length>0&&s.filters.length>0),La(i)&&La(s))return XN(i,s.getFilters());let o=CE(i)?i:s,a=CE(i)?s:i,u=o.filters.map(c=>pC(c,a));return De.create(u,"or")}(t,e),zp(n)}function gN(t,e){if(La(e))return XN(e,t.getFilters());{let n=e.filters.map(r=>pC(t,r));return De.create(n,"or")}}function zp(t){if(L(t instanceof fe||t instanceof De),t instanceof fe)return t;let e=t.getFilters();if(e.length===1)return zp(e[0]);if(ZN(t))return t;let n=e.map(i=>zp(i)),r=[];return n.forEach(i=>{i instanceof fe?r.push(i):i instanceof De&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:De.create(r,t.op)}var ZE=class{constructor(){this._n=new Al}addToCollectionParentIndex(e,n){return this._n.add(n),m.resolve()}getCollectionParents(e,n){return m.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return m.resolve()}deleteFieldIndex(e,n){return m.resolve()}deleteAllFieldIndexes(e){return m.resolve()}createTargetIndexes(e,n){return m.resolve()}getDocumentsMatchingTarget(e,n){return m.resolve(null)}getIndexType(e,n){return m.resolve(0)}getFieldIndexes(e,n){return m.resolve([])}getNextCollectionGroupToUpdate(e){return m.resolve(null)}getMinOffset(e,n){return m.resolve(bn.min())}getMinOffsetFromCollectionGroup(e,n){return m.resolve(bn.min())}updateCollectionGroup(e,n,r){return m.resolve()}updateIndexEntries(e,n){return m.resolve()}},Al=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Se(me.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Se(me.comparator)).toArray()}};var yp=new Uint8Array(0),JE=class{constructor(e,n){this.databaseId=n,this.an=new Al,this.un=new vr(r=>Hs(r),(r,i)=>jl(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:Ut(i)};return mN(e).put(s)}return m.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[LN(n),""],!1,!0);return mN(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(hr(o.parent))}return r})}addFieldIndex(e,n){let r=sl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=Da(e);return s.next(a=>{o.put(lN(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=sl(e),i=Da(e),s=Ca(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=sl(e),r=Ca(e),i=Da(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return m.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Gp(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=Ca(e),i=!0,s=new Map;return m.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ee(),a=[];return m.forEach(s,(u,c)=>{C("IndexedDbIndexManager",`Using index ${function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map(H=>`${H.fieldPath}:${H.kind}`).join(",")}`}(u)} to execute ${Hs(n)}`);let l=function(A,H){let G=gE(H);if(G===void 0)return null;for(let X of Vp(A,G.fieldPath))switch(X.op){case"array-contains-any":return X.value.arrayValue.values||[];case"array-contains":return[X.value]}return null}(c,u),d=function(A,H){let G=new Map;for(let X of Ps(H))for(let ke of Vp(A,X.fieldPath))switch(ke.op){case"==":case"in":G.set(X.fieldPath.canonicalString(),ke.value);break;case"not-in":case"!=":return G.set(X.fieldPath.canonicalString(),ke.value),Array.from(G.values())}return null}(c,u),h=function(A,H){let G=[],X=!0;for(let ke of Ps(H)){let hn=ke.kind===0?QR(A,ke.fieldPath,A.startAt):YR(A,ke.fieldPath,A.startAt);G.push(hn.value),X&&(X=hn.inclusive)}return new _r(G,X)}(c,u),f=function(A,H){let G=[],X=!0;for(let ke of Ps(H)){let hn=ke.kind===0?YR(A,ke.fieldPath,A.endAt):QR(A,ke.fieldPath,A.endAt);G.push(hn.value),X&&(X=hn.inclusive)}return new _r(G,X)}(c,u),p=this.hn(u,c,h),g=this.hn(u,c,f),_=this.Pn(u,c,d),T=this.In(u.indexId,l,p,h.inclusive,g,f.inclusive,_);return m.forEach(T,P=>r.j(P,n.limit).next(A=>{A.forEach(H=>{let G=M.fromSegments(H.documentKey);o.has(G)||(o=o.add(G),a.push(G))})}))}).next(()=>a)}return m.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=ZG(De.create(e.filters,"and")).map(r=>NE(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let u=(n!=null?n.length:1)*Math.max(r.length,s.length),c=u/(n!=null?n.length:1),l=[];for(let d=0;d<u;++d){let h=n?this.Tn(n[d/c]):yp,f=this.En(e,h,r[d%c],i),p=this.dn(e,h,s[d%c],o),g=a.map(_=>this.En(e,h,_,!0));l.push(...this.createRange(f,p,g))}return l}En(e,n,r,i){let s=new Vs(e,M.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new Vs(e,M.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new Gp(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return m.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new Se(We.comparator),l=!1;for(let d of u.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:c=c.add(h.field));for(let d of u.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new Fs;for(let i of Ps(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);$r.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new Fs;return $r.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new Fs;return $r.bt.Pt(Bs(this.databaseId,n),r.Ht(function(s){let o=Ps(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new Fs);let s=0;for(let o of Ps(e)){let a=r[s++];for(let u of i)if(this.Vn(n,o.fieldPath)&&wl(a))i=this.mn(i,o,a);else{let c=u.Ht(o.kind);$r.bt.Pt(a,c)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let u=new Fs;u.seed(a.Wt()),$r.bt.Pt(o,u.Ht(n.kind)),s.push(u)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof fe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=sl(e),i=Da(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return m.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(l,d){let h=d?new gl(d.sequenceNumber,new bn(zs(d.readTime),new M(hr(d.documentKey)),d.largestBatchId)):gl.empty(),f=l.fields.map(([p,g])=>new Na(We.fromServerFormat(p),g));return new Fa(l.indexId,l.collectionGroup,f,h)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Z(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=sl(e),s=Da(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>m.forEach(a,u=>s.put(lN(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return m.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?m.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),m.forEach(a,u=>this.pn(e,i,u).next(c=>{let l=this.yn(s,u);return c.isEqual(l)?m.resolve():this.wn(e,s,u,c,l)}))))})}Sn(e,n,r,i){return Ca(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return Ca(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=Ca(e),s=new Se(Di);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new Vs(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new Se(Di),i=this.An(n,e);if(i==null)return r;let s=gE(n);if(s!=null){let o=e.data.field(s.fieldPath);if(wl(o))for(let a of o.arrayValue.values||[])r=r.add(new Vs(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new Vs(n.indexId,e.key,yp,i));return r}wn(e,n,r,i,s){C("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(u,c,l,d,h){let f=u.getIterator(),p=c.getIterator(),g=Ia(f),_=Ia(p);for(;g||_;){let T=!1,P=!1;if(g&&_){let A=l(g,_);A<0?P=!0:A>0&&(T=!0)}else g!=null?P=!0:T=!0;T?(d(_),_=Ia(p)):P?(h(g),g=Ia(f)):(g=Ia(f),_=Ia(p))}}(i,s,Di,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),m.waitFor(o)}gn(e){let n=1;return Da(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Di(o,a)).filter((o,a,u)=>!a||Di(o,u[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Di(o,e),u=Di(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&u<0)i.push(o),i.push(o.Jt());else if(u>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,yp,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,yp,[]];s.push(IDBKeyRange.bound(a,u))}return s}Dn(e,n){return Di(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(yN)}getMinOffset(e,n){return m.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||O())).next(yN)}};function mN(t){return mt(t,"collectionParents")}function Ca(t){return mt(t,"indexEntries")}function sl(t){return mt(t,"indexConfiguration")}function Da(t){return mt(t,"indexState")}function yN(t){L(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;oC(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new bn(e.readTime,e.documentKey,n)}var _N={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Dn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function FP(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,u=r.Y({range:o},(l,d,h)=>(a++,h.delete()));s.push(u.next(()=>{L(a===1)}));let c=[];for(let l of n.mutations){let d=HN(e,l.key.path,n.batchId);s.push(i.delete(d)),c.push(l.key)}return m.waitFor(s).next(()=>c)}function Wp(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw O();e=t.noDocument}return JSON.stringify(e).length}Dn.DEFAULT_COLLECTION_PERCENTILE=10,Dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dn.DEFAULT=new Dn(41943040,Dn.DEFAULT_COLLECTION_PERCENTILE,Dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dn.DISABLED=new Dn(-1,0,0);var Kp=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){L(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ti(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=Ma(e),o=Ti(e);return o.add({}).next(a=>{L(typeof a=="number");let u=new Il(a,n,r,i),c=function(f,p,g){let _=g.baseMutations.map(P=>Sl(f.ct,P)),T=g.mutations.map(P=>Sl(f.ct,P));return{userId:p,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:_,mutations:T}}(this.serializer,this.userId,u),l=[],d=new Se((h,f)=>Z(h.canonicalString(),f.canonicalString()));for(let h of i){let f=HN(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(c)),l.push(s.put(f,iG))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=u.keys()}),m.waitFor(l).next(()=>u)})}lookupMutationBatch(e,n){return Ti(e).get(n).next(r=>r?(L(r.userId===this.userId),Os(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?m.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Ti(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(L(a.batchId>=r),s=Os(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Ti(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ti(e).W("userMutationsIndex",n).next(r=>r.map(i=>Os(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=Ep(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ma(e).Y({range:i},(o,a,u)=>{let[c,l,d]=o,h=hr(l);if(c===this.userId&&n.path.isEqual(h))return Ti(e).get(d).next(f=>{if(!f)throw O();L(f.userId===this.userId),s.push(Os(this.serializer,f))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(Z),i=[];return n.forEach(s=>{let o=Ep(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=Ma(e).Y({range:a},(c,l,d)=>{let[h,f,p]=c,g=hr(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(u)}),m.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=Ep(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Se(Z);return Ma(e).Y({range:o},(u,c,l)=>{let[d,h,f]=u,p=hr(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(Ti(e).get(s).next(o=>{if(o===null)throw O();L(o.userId===this.userId),r.push(Os(this.serializer,o))}))}),m.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return FP(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),m.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return m.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ma(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let u=hr(s[1]);i.push(u)}else a.done()}).next(()=>{L(i.length===0)})})}containsKey(e,n){return VP(e,this.userId,n)}xn(e){return LP(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function VP(t,e,n){let r=Ep(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Ma(t).Y({range:s,J:!0},(a,u,c)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function Ti(t){return mt(t,"mutations")}function Ma(t){return mt(t,"documentMutations")}function LP(t){return mt(t,"mutationQueues")}var Ha=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Bn(){return new t(-1)}};var XE=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{let r=new Ha(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>B.fromTimestamp(new je(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ta(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>(L(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return Ta(e).Y((o,a)=>{let u=cl(a);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>m.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Ta(e).Y((r,i)=>{let s=cl(i);n(s)})}Ln(e){return vN(e).get("targetGlobalKey").next(n=>(L(n!==null),n))}kn(e,n){return vN(e).put("targetGlobalKey",n)}qn(e,n){return Ta(e).put(PP(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){let r=Hs(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Ta(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{let c=cl(a);jl(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=bi(e);return n.forEach(o=>{let a=Ut(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),m.waitFor(i)}removeMatchingKeys(e,n,r){let i=bi(e);return m.forEach(n,s=>{let o=Ut(s.path);return m.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=bi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=bi(e),s=ee();return i.Y({range:r,J:!0},(o,a,u)=>{let c=hr(o[1]),l=new M(c);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=Ut(n.path),i=IDBKeyRange.bound([r],[LN(r)],!1,!0),s=0;return bi(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}_t(e,n){return Ta(e).get(n).next(r=>r?cl(r):null)}};function Ta(t){return mt(t,"targets")}function vN(t){return mt(t,"targetGlobal")}function bi(t){return mt(t,"targetDocuments")}function wN([t,e],[n,r]){let i=Z(t,n);return i===0?Z(e,r):i}var eI=class{constructor(e){this.Kn=e,this.buffer=new Se(wN),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();wN(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},tI=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){C("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>v(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Bi(n)?C("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Ui(n)}yield this.zn(3e5)}))}},nI=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return m.resolve(on._e);let r=new eI(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(C("LruGarbageCollector","Garbage collection skipped; disabled"),m.resolve(_N)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(C("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_N):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,u,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(C("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),ba()<=pn.DEBUG&&C("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${d} documents in `+(c-u)+`ms
Total Duration: ${c-l}ms`),m.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function JG(t,e){return new nI(t,e)}var rI=class{constructor(e,n){this.db=e,this.garbageCollector=JG(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return _p(e,r)}removeReference(e,n,r){return _p(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return _p(e,n)}er(e,n){return function(i,s){let o=!1;return LP(i).Z(a=>VP(i,a,s).next(u=>(u&&(o=!0),m.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let u=this.er(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,B.min()),bi(e).delete(function(d){return[0,Ut(d.path)]}(o))))});i.push(u)}}).next(()=>m.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return _p(e,n)}Xn(e,n){let r=bi(e),i,s=on._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(s!==on._e&&n(new M(hr(i)),s),s=c,i=u):s=on._e}).next(()=>{s!==on._e&&n(new M(hr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function _p(t,e){return bi(t).put(function(r,i){return{targetId:0,path:Ut(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var Qp=class{constructor(){this.changes=new vr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,at.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?m.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var iI=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ns(e).put(r)}removeEntry(e,n,r){return Ns(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Hp(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=at.newInvalidDocument(n);return Ns(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(ol(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:at.newInvalidDocument(n)};return Ns(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(ol(n))},(i,s)=>{r={document:this.nr(n,s),size:Wp(s)}}).next(()=>r)}getEntries(e,n){let r=Jt();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=Jt(),i=new Pe(M.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,Wp(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return m.resolve();let i=new Se(CN);n.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound(ol(i.first()),ol(i.last())),o=i.getIterator(),a=o.getNext();return Ns(e).Y({index:"documentKeyIndex",range:s},(u,c,l)=>{let d=M.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&CN(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?l.U(ol(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Hp(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ns(e).W(IDBKeyRange.bound(a,u,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let l=Jt();for(let d of c){let h=this.nr(M.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(Bl(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=Jt(),o=IN(n,r),a=IN(n,bn.max());return Ns(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,l)=>{let d=this.nr(M.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new sI(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return EN(e).get("remoteDocumentGlobalKey").next(n=>(L(!!n),n))}tr(e,n){return EN(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=QG(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(B.min())))return r}return at.newInvalidDocument(e)}};function jP(t){return new iI(t)}var sI=class extends Qp{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new vr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new Se((s,o)=>Z(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let u=uN(this.ar.serializer,o);i=i.add(s.path.popLast());let c=Wp(u);r+=c-a.size,n.push(this.ar.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){let u=uN(this.ar.serializer,o.convertToNoDocument(B.min()));n.push(this.ar.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),m.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function EN(t){return mt(t,"remoteDocumentGlobal")}function Ns(t){return mt(t,"remoteDocumentsV14")}function ol(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function IN(t,e){let n=e.documentKey.path.toArray();return[t,Hp(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function CN(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Z(n[s],r[s]),i)return i;return i=Z(n.length,r.length),i||(i=Z(n[n.length-2],r[r.length-2]),i||Z(n[n.length-1],r[r.length-1]))}var oI=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Yp=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&hl(r.mutation,i,an.empty(),je.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ee()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ee()){let i=fr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ul();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=fr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ee()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Jt(),o=dl(),a=function(){return dl()}();return n.forEach((u,c)=>{let l=r.get(c.key);i.has(c.key)&&(l===void 0||l.mutation instanceof qn)?s=s.insert(c.key,c):l!==void 0?(o.set(c.key,l.mutation.getFieldMask()),hl(l.mutation,c,l.mutation.getFieldMask(),je.now())):o.set(c.key,an.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,l)=>o.set(c,l)),n.forEach((c,l)=>{var d;return a.set(c,new oI(l,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=dl(),i=new Pe((o,a)=>o-a),s=ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(u=>{let c=n.get(u);if(c===null)return;let l=r.get(u)||an.empty();l=a.applyToLocalView(c,l),r.set(u,l);let d=(i.get(a.batchId)||ee()).add(u);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),c=u.key,l=u.value,d=uP();l.forEach(h=>{if(!s.has(h)){let f=mP(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return m.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return M.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):lC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):m.resolve(fr()),a=-1,u=s;return o.next(c=>m.forEach(c,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?m.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{u=u.insert(l,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,ee())).next(l=>({batchId:a,changes:aP(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new M(n)).next(r=>{let i=ul();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=ul();return this.indexManager.getCollectionParents(e,s).next(a=>m.forEach(a,u=>{let c=function(d,h){return new Hn(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{let l=c.getKey();o.get(l)===null&&(o=o.insert(l,at.newInvalidDocument(l)))});let a=ul();return o.forEach((u,c)=>{let l=s.get(u);l!==void 0&&hl(l.mutation,c,an.empty(),je.now()),Bl(n,c)&&(a=a.insert(u,c))}),a})}};var aI=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return m.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ke(i.createTime)}}(n)),m.resolve()}getNamedQuery(e,n){return m.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:fC(i.bundledQuery),readTime:Ke(i.readTime)}}(n)),m.resolve()}};var uI=class{constructor(){this.overlays=new Pe(M.comparator),this.hr=new Map}getOverlay(e,n){return m.resolve(this.overlays.get(n))}getOverlays(e,n){let r=fr();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),m.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),m.resolve()}getOverlaysForCollection(e,n,r){let i=fr(),s=n.length+1,o=new M(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return m.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Pe((c,l)=>c-l),o=this.overlays.getIterator();for(;o.hasNext();){let c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let l=s.get(c.largestBatchId);l===null&&(l=fr(),s=s.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}let a=fr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(c,l)),!(a.size()>=i)););return m.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Cl(n,r));let s=this.hr.get(n);s===void 0&&(s=ee(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var xl=class{constructor(){this.Pr=new Se(it.Ir),this.Tr=new Se(it.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new it(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new it(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new M(new me([])),r=new it(n,e),i=new it(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new M(new me([])),r=new it(n,e),i=new it(n,e+1),s=ee();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new it(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},it=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return M.comparator(e.key,n.key)||Z(e.pr,n.pr)}static Er(e,n){return Z(e.pr,n.pr)||M.comparator(e.key,n.key)}};var cI=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Se(it.Ir)}checkEmpty(e){return m.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Il(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new it(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return m.resolve(o)}lookupMutationBatch(e,n){return m.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return m.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return m.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return m.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new it(n,0),i=new it(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),m.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(Z);return n.forEach(i=>{let s=new it(i,0),o=new it(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),m.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;M.isDocumentKey(s)||(s=s.child(""));let o=new it(new M(s),0),a=new Se(Z);return this.wr.forEachWhile(u=>{let c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.pr)),!0)},o),m.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){L(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return m.forEach(n.mutations,i=>{let s=new it(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new it(n,0),i=this.wr.firstAfterOrEqual(r);return m.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,m.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var lI=class{constructor(e){this.vr=e,this.docs=function(){return new Pe(M.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return m.resolve(r?r.document.mutableCopy():at.newInvalidDocument(n))}getEntries(e,n){let r=Jt();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():at.newInvalidDocument(i))}),m.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Jt(),o=n.path,a=new M(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:c,value:{document:l}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||oC(UN(l),r)<=0||(i.has(l.key)||Bl(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return m.resolve(s)}getAllFromCollectionGroup(e,n,r,i){O()}Fr(e,n){return m.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new dI(this)}getSize(e){return m.resolve(this.size)}},dI=class extends Qp{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),m.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var hI=class{constructor(e){this.persistence=e,this.Mr=new vr(n=>Hs(n),jl),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.Or=0,this.Nr=new xl,this.targetCount=0,this.Br=Ha.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),m.resolve()}getLastRemoteSnapshotVersion(e){return m.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return m.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),m.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),m.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Br=new Ha(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,m.resolve()}updateTargetData(e,n){return this.qn(n),m.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,m.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),m.waitFor(s).next(()=>i)}getTargetCount(e){return m.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return m.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),m.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),m.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),m.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return m.resolve(r)}containsKey(e,n){return m.resolve(this.Nr.containsKey(n))}};var Zp=class{constructor(e,n){this.Lr={},this.overlays={},this.kr=new on(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new hI(this),this.indexManager=new ZE,this.remoteDocumentCache=function(i){return new lI(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new $p(n),this.$r=new aI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new uI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new cI(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){C("MemoryPersistence","Starting transaction:",e);let i=new fI(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return m.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}},fI=class extends Mp{constructor(e){super(),this.currentSequenceNumber=e}},Jp=class t{constructor(e){this.persistence=e,this.zr=new xl,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw O()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),m.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),m.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),m.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return m.forEach(this.Jr,r=>{let i=M.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,B.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return m.or([()=>m.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var pI=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new Rp("createOrUpgrade",n);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",UR,{unique:!0}),u.createObjectStore("documentMutations")}(e),DN(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=m.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),DN(e)),o=o.next(()=>function(u){let c=u.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:B.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").W().next(l=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",UR,{unique:!0});let d=c.store("mutations"),h=l.map(f=>d.put(f));return m.waitFor(h)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){let c=u.createObjectStore("documentOverlays",{keyPath:mG});c.createIndex("collectionPathOverlayIndex",yG,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",_G,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){let c=u.createObjectStore("remoteDocumentsV14",{keyPath:sG});c.createIndex("documentKeyIndex",oG),c.createIndex("collectionGroupIndex",aG)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:hG}).createIndex("sequenceNumberIndex",fG,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:pG}).createIndex("documentKeyIndex",gG,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=Wp(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>m.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>m.forEach(a,u=>{L(u.userId===s.userId);let c=Os(this.serializer,u);return FP(e,s.userId,c).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let u=new me(o),c=function(d){return[0,Ut(d)]}(u);s.push(n.get(c).next(l=>l?m.resolve():(d=>n.put({targetId:0,path:Ut(d),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>m.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:dG});let r=n.store("collectionParents"),i=new Al,s=o=>{if(i.add(o)){let a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Ut(u)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let u=new me(o);return s(u.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,u],c)=>{let l=hr(a);return s(l.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=cl(i),o=PP(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),u=function(d){return d.document?new M(me.fromString(d.document.name).popFirst(5)):d.noDocument?M.fromSegments(d.noDocument.path):d.unknownDocument?M.fromSegments(d.unknownDocument.path):O()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>m.waitFor(i))}si(e,n){let r=n.store("mutations"),i=jP(this.serializer),s=new Zp(Jp.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(u=>{var c;let l=(c=a.get(u.userId))!==null&&c!==void 0?c:ee();Os(this.serializer,u).keys().forEach(d=>l=l.add(d)),a.set(u.userId,l)}),m.forEach(a,(u,c)=>{let l=new st(c),d=qp.lt(this.serializer,l),h=s.getIndexManager(l),f=Kp.lt(l,this.serializer,h,s.referenceDelegate);return new Yp(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new yl(n,on._e),u).next()})})}};function DN(t){t.createObjectStore("targetDocuments",{keyPath:cG}).createIndex("documentTargetsIndex",lG,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",uG,{unique:!0}),t.createObjectStore("targetGlobal")}var sE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",gI=class t{constructor(e,n,r,i,s,o,a,u,c,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=c,this.ai=l,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new E(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new rI(this,i),this.Ti=n+"main",this.serializer=new $p(u),this.Ei=new qr(this.Ti,this.ui,new pI(this.serializer)),this.Qr=new XE(this.referenceDelegate,this.serializer),this.remoteDocumentCache=jP(this.serializer),this.$r=new qE,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,l===!1&&ze("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new E(y.FAILED_PRECONDITION,sE);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new on(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>v(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(n=>v(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>v(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>vp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(Bi(e))return C("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return C("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return al(e).get("owner").next(n=>m.resolve(this.Si(n)))}bi(e){return vp(e).delete(this.clientId)}Di(){return v(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=mt(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return m.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?m.resolve(!0):al(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new E(y.FAILED_PRECONDITION,sE);return!1}}return!(!this.networkEnabled||!this.inForeground)||vp(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&C("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return v(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new yl(e,on._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Bi()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>vp(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return Kp.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new JE(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return qp.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){C("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(u){return u===15?wG:u===14?zN:u===13?GN:u===12?vG:u===11?qN:void O()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new yl(a,this.kr?this.kr.next():on._e),n==="readwrite-primary"?this.gi(o).next(u=>!!u||this.pi(o)).next(u=>{if(!u)throw ze(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new E(y.FAILED_PRECONDITION,BN);return r(o)}).next(u=>this.wi(o).next(()=>u)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return al(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new E(y.FAILED_PRECONDITION,sE)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return al(e).put("owner",n)}static D(){return qr.D()}yi(e){let n=al(e);return n.get("owner").next(r=>this.Si(r)?(C("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):m.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(ze(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;jm()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return C("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ze("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){ze("Failed to set zombie client id.",e)}}Bi(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function al(t){return mt(t,"owner")}function vp(t){return mt(t,"clientMetadata")}function gC(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var mI=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=ee(),i=ee();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var yI=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Xp=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return jm()?8:qr.v(Au())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new yI;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(ba()<=pn.DEBUG&&C("QueryEngine","SDK will not create cache indexes for query:",Sa(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),m.resolve()):(ba()<=pn.DEBUG&&C("QueryEngine","Query:",Sa(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(ba()<=pn.DEBUG&&C("QueryEngine","The SDK decides to create cache indexes for query:",Sa(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bt(n))):m.resolve())}ji(e,n){if(ZR(n))return m.resolve(null);let r=Bt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Lp(n,null,"F"),r=Bt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ee(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let c=this.Zi(n,a);return this.Xi(n,c,o,u.readTime)?this.ji(e,Lp(n,null,"F")):this.es(e,c,n,u)}))})))}Hi(e,n,r,i){return ZR(n)||i.isEqual(B.min())?m.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?m.resolve(null):(ba()<=pn.DEBUG&&C("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Sa(n)),this.es(e,o,n,jN(i,-1)).next(a=>a))})}Zi(e,n){let r=new Se(sP(e));return n.forEach((i,s)=>{Bl(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return ba()<=pn.DEBUG&&C("QueryEngine","Using full collection scan to execute query:",Sa(n)),this.zi.getDocumentsMatchingQuery(e,n,bn.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var _I=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new Pe(Z),this.rs=new vr(s=>Hs(s),jl),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Yp(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function UP(t,e,n,r){return new _I(t,e,n,r)}function BP(t,e){return v(this,null,function*(){let n=N(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=ee();for(let c of i){o.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}for(let c of s){a.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}return n.localDocuments.getDocuments(r,u).next(c=>({us:c,removedBatchIds:o,addedBatchIds:a}))})})})}function XG(t,e){let n=N(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,u,c,l){let d=c.batch,h=d.keys(),f=m.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(u,p)).next(g=>{let _=c.docVersions.get(p);L(_!==null),g.version.compareTo(_)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),l.addEntry(g)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(u,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=ee();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function $P(t){let e=N(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function ez(t,e){let n=N(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(gt.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(g,_,T){return g.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(h,f,l)&&a.push(n.Qr.updateTargetData(s,f))});let u=Jt(),c=ee();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(HP(s,o,e.documentUpdates).next(l=>{u=l.cs,c=l.ls})),!r.isEqual(B.min())){let l=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return m.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.ns=i,s))}function HP(t,e,n){let r=ee(),i=ee();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Jt();return n.forEach((a,u)=>{let c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(B.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):C("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{cs:o,ls:i}})}function tz(t,e){let n=N(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function qa(t,e){let n=N(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,m.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new $a(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function Ga(t,e,n){return v(this,null,function*(){let r=N(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Bi(o))throw o;C("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function eg(t,e,n){let r=N(t),i=B.min(),s=ee();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,l){let d=N(u),h=d.rs.get(l);return h!==void 0?m.resolve(d.ns.get(h)):d.Qr.getTargetData(c,l)}(r,o,Bt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:B.min(),n?s:ee())).next(a=>(zP(r,iP(e),a),{documents:a,hs:s})))}function qP(t,e){let n=N(t),r=N(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function GP(t,e){let n=N(t),r=n.ss.get(e)||B.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,jN(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(zP(n,e,i),i))}function zP(t,e,n){let r=t.ss.get(e)||B.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function nz(t,e,n,r){return v(this,null,function*(){let i=N(t),s=ee(),o=Jt();for(let c of n){let l=e.Ps(c.metadata.name);c.document&&(s=s.add(l));let d=e.Is(c);d.setReadTime(e.Ts(c.metadata.readTime)),o=o.insert(l,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),u=yield qa(i,function(l){return Bt(Ja(me.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>HP(c,a,o).next(l=>(a.apply(c),l)).next(l=>i.Qr.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.Qr.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,l.cs,l.ls)).next(()=>l.cs)))})}function rz(r,i){return v(this,arguments,function*(t,e,n=ee()){let s=yield qa(t,Bt(fC(e.bundledQuery))),o=N(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let u=Ke(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.$r.saveNamedQuery(a,e);let c=s.withResumeToken(gt.EMPTY_BYTE_STRING,u);return o.ns=o.ns.insert(c.targetId,c),o.Qr.updateTargetData(a,c).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function TN(t,e){return`firestore_clients_${t}_${e}`}function bN(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function oE(t,e){return`firestore_targets_${t}_${e}`}var tg=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new E(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(ze("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},fl=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new E(r.error.code,r.error.message))),s?new t(e,r.state,i):(ze("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},ng=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=dC();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=$N(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(ze("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},vI=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(ze("SharedClientState",`Failed to parse online state: ${e}`),null)}},Ml=class{constructor(){this.activeTargetIds=dC()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},pl=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Pe(Z),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=TN(this.persistenceKey,this.Vs),this.Ss=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Ml),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Fs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return v(this,null,function*(){let e=yield this.syncEngine.Li();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(TN(this.persistenceKey,r));if(i){let s=ng.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Bs(e,"pending")}updateMutationState(e,n,r){this.Bs(e,n,r),this.Ls(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(oE(this.persistenceKey,e));if(r){let i=fl.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(oE(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Ls(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return C("SharedClientState","READ",e,n),n}setItem(e,n){C("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){C("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(C("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void ze("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>v(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=on._e;if(s!=null)try{let a=JSON.parse(s);L(typeof a=="number"),o=a}catch(a){ze("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==on._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Bs(e,n,r){let i=new tg(this.currentUser,e,n,r),s=bN(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Ls(e){let n=bN(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=oE(this.persistenceKey,e),s=new fl(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return ng.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return tg.Es(new st(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return fl.Es(i,n)}xs(e){return vI.Es(e)}Js(e){return JSON.parse(e)}zs(e){return v(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);C("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=dC();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},rg=class{constructor(){this.no=new Ml,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Ml,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var wI=class{io(e){}shutdown(){}};var ig=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){C("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){C("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var wp=null;function aE(){return wp===null?wp=function(){return 268435456+Math.round(2147483648*Math.random())}():wp++,"0x"+wp.toString(16)}var iz={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var EI=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var Nt="WebChannelConnection",II=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=aE(),u=this.bo(n,r.toUriEncodedString());C("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);let c={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(c,s,o),this.Co(n,u,c,i).then(l=>(C("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Tn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",u,"request:",i),l})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Za}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=iz[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=aE();return new Promise((o,a)=>{let u=new OR;u.setWithCredentials(!0),u.listenOnce(PR.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case mp.NO_ERROR:let l=u.getResponseJson();C(Nt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case mp.TIMEOUT:C(Nt,`RPC '${e}' ${s} timed out`),a(new E(y.DEADLINE_EXCEEDED,"Request time out"));break;case mp.HTTP_ERROR:let d=u.getStatus();if(C(Nt,`RPC '${e}' ${s} failed with status:`,d,"response text:",u.getResponseText()),d>0){let h=u.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(_){let T=_.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(T)>=0?T:y.UNKNOWN}(f.status);a(new E(p,f.message))}else a(new E(y.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new E(y.UNAVAILABLE,"Connection failed."));break;default:O()}}finally{C(Nt,`RPC '${e}' ${s} completed.`)}});let c=JSON.stringify(i);C(Nt,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}Fo(e,n,r){let i=aE(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=RR(),a=NR(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Do(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;let l=s.join("");C(Nt,`Creating RPC '${e}' stream ${i}: ${l}`,u);let d=o.createWebChannel(l,u),h=!1,f=!1,p=new EI({lo:_=>{f?C(Nt,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(h||(C(Nt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),C(Nt,`RPC '${e}' stream ${i} sending:`,_),d.send(_))},ho:()=>d.close()}),g=(_,T,P)=>{_.listen(T,A=>{try{P(A)}catch(H){setTimeout(()=>{throw H},0)}})};return g(d,rl.EventType.OPEN,()=>{f||C(Nt,`RPC '${e}' stream ${i} transport opened.`)}),g(d,rl.EventType.CLOSE,()=>{f||(f=!0,C(Nt,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),g(d,rl.EventType.ERROR,_=>{f||(f=!0,Tn(Nt,`RPC '${e}' stream ${i} transport errored:`,_),p.Vo(new E(y.UNAVAILABLE,"The operation could not be completed")))}),g(d,rl.EventType.MESSAGE,_=>{var T;if(!f){let P=_.data[0];L(!!P);let A=P,H=A.error||((T=A[0])===null||T===void 0?void 0:T.error);if(H){C(Nt,`RPC '${e}' stream ${i} received error:`,H);let G=H.status,X=function(Fm){let rT=rt[Fm];if(rT!==void 0)return vP(rT)}(G),ke=H.message;X===void 0&&(X=y.INTERNAL,ke="Unknown error status: "+G+" with message "+H.message),f=!0,p.Vo(new E(X,ke)),d.close()}else C(Nt,`RPC '${e}' stream ${i} received:`,P),p.mo(P)}}),g(a,kR.STAT_EVENT,_=>{_.stat===rE.PROXY?C(Nt,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===rE.NOPROXY&&C(Nt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function WP(){return typeof window<"u"?window:null}function Tp(){return typeof document<"u"?document:null}function $l(t){return new jE(t,!0)}var Rl=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),i=Math.max(0,n-r);i>0&&C("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Lo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Bo!==null&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){this.Bo!==null&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}};var sg=class{constructor(e,n,r,i,s,o,a,u){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Rl(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return v(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return v(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return v(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===y.RESOURCE_EXHAUSTED?(ze(n.toString()),ze("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new E(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>v(this,null,function*(){this.state=0,this.start()}))}__(e){return C("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(C("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},CI=class extends sg{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=$G(this.serializer,e),r=function(s){if(!("targetChange"in s))return B.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?B.min():o.readTime?Ke(o.readTime):B.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=$E(this.serializer),n.addTarget=function(s,o){let a,u=o.target;if(a=Fp(u)?{documents:SP(s,u)}:{query:AP(s,u).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=EP(s,o.resumeToken);let c=UE(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(B.min())>0){a.readTime=Ba(s,o.snapshotVersion.toTimestamp());let c=UE(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=qG(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=$E(this.serializer),n.removeTarget=e,this.t_(n)}},DI=class extends sg{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(L(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=HG(e.writeResults,e.commitTime),r=Ke(e.commitTime);return this.listener.T_(r,n)}return L(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=$E(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>Sl(this.serializer,r))};this.t_(n)}};var TI=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new E(y.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,BE(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new E(y.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,BE(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new E(y.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var bI=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(ze(n),this.g_=!1):C("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var SI=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>v(this,null,function*(){$i(this)&&(C("RemoteStore","Restarting streams for network reachability change."),yield function(u){return v(this,null,function*(){let c=N(u);c.v_.add(4),yield Xa(c),c.x_.set("Unknown"),c.v_.delete(4),yield Hl(c)})}(this))}))}),this.x_=new bI(r,i)}};function Hl(t){return v(this,null,function*(){if($i(t))for(let e of t.F_)yield e(!0)})}function Xa(t){return v(this,null,function*(){for(let e of t.F_)yield e(!1)})}function Dg(t,e){let n=N(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),_C(n)?yC(n):tu(n).Jo()&&mC(n,e))}function Nl(t,e){let n=N(t),r=tu(n);n.C_.delete(e),r.Jo()&&KP(n,e),n.C_.size===0&&(r.Jo()?r.Xo():$i(n)&&n.x_.set("Unknown"))}function mC(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(B.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}tu(t).c_(e)}function KP(t,e){t.O_.Oe(e),tu(t).l_(e)}function yC(t){t.O_=new LE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),tu(t).start(),t.x_.p_()}function _C(t){return $i(t)&&!tu(t).Ho()&&t.C_.size>0}function $i(t){return N(t).v_.size===0}function QP(t){t.O_=void 0}function sz(t){return v(this,null,function*(){t.C_.forEach((e,n)=>{mC(t,e)})})}function oz(t,e){return v(this,null,function*(){QP(t),_C(t)?(t.x_.S_(e),yC(t)):t.x_.set("Unknown")})}function az(t,e,n){return v(this,null,function*(){if(t.x_.set("Online"),e instanceof Up&&e.state===2&&e.cause)try{yield function(i,s){return v(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){C("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield og(t,r)}else if(e instanceof ka?t.O_.$e(e):e instanceof jp?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(B.min()))try{let r=yield $P(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){let l=s.C_.get(c);l&&s.C_.set(c,l.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{let l=s.C_.get(u);if(!l)return;s.C_.set(u,l.withResumeToken(gt.EMPTY_BYTE_STRING,l.snapshotVersion)),KP(s,u);let d=new $a(l.target,u,c,l.sequenceNumber);mC(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){C("RemoteStore","Failed to raise snapshot:",r),yield og(t,r)}})}function og(t,e,n){return v(this,null,function*(){if(!Bi(e))throw e;t.v_.add(1),yield Xa(t),t.x_.set("Offline"),n||(n=()=>$P(t.localStore)),t.asyncQueue.enqueueRetryable(()=>v(this,null,function*(){C("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield Hl(t)}))})}function YP(t,e){return e().catch(n=>og(t,n,e))}function eu(t){return v(this,null,function*(){let e=N(t),n=ji(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;uz(e);)try{let i=yield tz(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,cz(e,i)}catch(i){yield og(e,i)}ZP(e)&&JP(e)})}function uz(t){return $i(t)&&t.D_.length<10}function cz(t,e){t.D_.push(e);let n=ji(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function ZP(t){return $i(t)&&!ji(t).Ho()&&t.D_.length>0}function JP(t){ji(t).start()}function lz(t){return v(this,null,function*(){ji(t).d_()})}function dz(t){return v(this,null,function*(){let e=ji(t);for(let n of t.D_)e.I_(n.mutations)})}function hz(t,e,n){return v(this,null,function*(){let r=t.D_.shift(),i=OE.from(r,e,n);yield YP(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield eu(t)})}function fz(t,e){return v(this,null,function*(){e&&ji(t).P_&&(yield function(r,i){return v(this,null,function*(){if(function(o){return _P(o)&&o!==y.ABORTED}(i.code)){let s=r.D_.shift();ji(r).Zo(),yield YP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield eu(r)}})}(t,e)),ZP(t)&&JP(t)})}function SN(t,e){return v(this,null,function*(){let n=N(t);n.asyncQueue.verifyOperationInProgress(),C("RemoteStore","RemoteStore received new credentials");let r=$i(n);n.v_.add(3),yield Xa(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield Hl(n)})}function AI(t,e){return v(this,null,function*(){let n=N(t);e?(n.v_.delete(2),yield Hl(n)):e||(n.v_.add(2),yield Xa(n),n.x_.set("Unknown"))})}function tu(t){return t.N_||(t.N_=function(n,r,i){let s=N(n);return s.R_(),new CI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:sz.bind(null,t),To:oz.bind(null,t),u_:az.bind(null,t)}),t.F_.push(e=>v(this,null,function*(){e?(t.N_.Zo(),_C(t)?yC(t):t.x_.set("Unknown")):(yield t.N_.stop(),QP(t))}))),t.N_}function ji(t){return t.B_||(t.B_=function(n,r,i){let s=N(n);return s.R_(),new DI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:lz.bind(null,t),To:fz.bind(null,t),E_:dz.bind(null,t),T_:hz.bind(null,t)}),t.F_.push(e=>v(this,null,function*(){e?(t.B_.Zo(),yield eu(t)):(yield t.B_.stop(),t.D_.length>0&&(C("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}var xI=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ot,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new E(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function nu(t,e){if(ze("AsyncQueue",`${e}: ${t}`),Bi(t))return new E(y.UNAVAILABLE,`${e}: ${t}`);throw t}var ag=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||M.comparator(n.key,r.key):(n,r)=>M.comparator(n.key,r.key),this.keyedMap=ul(),this.sortedSet=new Pe(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var ug=class{constructor(){this.L_=new Pe(M.comparator)}track(e){let n=e.doc.key,r=this.L_.get(n);r?e.type!==0&&r.type===3?this.L_=this.L_.insert(n,e):e.type===3&&r.type!==1?this.L_=this.L_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.L_=this.L_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.L_=this.L_.remove(n):e.type===1&&r.type===2?this.L_=this.L_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):O():this.L_=this.L_.insert(n,e)}k_(){let e=[];return this.L_.inorderTraversal((n,r)=>{e.push(r)}),e}},za=class t{constructor(e,n,r,i,s,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,ag.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ul(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var MI=class{constructor(){this.q_=void 0,this.Q_=[]}},RI=class{constructor(){this.queries=new vr(e=>rP(e),Ul),this.onlineState="Unknown",this.K_=new Set}};function vC(t,e){return v(this,null,function*(){let n=N(t),r=e.query,i=!1,s=n.queries.get(r);if(s||(i=!0,s=new MI),i)try{s.q_=yield n.onListen(r)}catch(o){let a=nu(o,`Initialization of query '${Sa(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.Q_.push(e),e.U_(n.onlineState),s.q_&&e.W_(s.q_)&&EC(n)})}function wC(t,e){return v(this,null,function*(){let n=N(t),r=e.query,i=!1,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),i=s.Q_.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}function pz(t,e){let n=N(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.W_(i)&&(r=!0);o.q_=i}}r&&EC(n)}function gz(t,e,n){let r=N(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function EC(t){t.K_.forEach(e=>{e.next()})}var Pl=class{constructor(e,n,r){this.query=e,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}W_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new za(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.z_?this.H_(e)&&(this.G_.next(e),n=!0):this.J_(e,this.onlineState)&&(this.Y_(e),n=!0),this.j_=e,n}onError(e){this.G_.error(e)}U_(e){this.onlineState=e;let n=!1;return this.j_&&!this.z_&&this.J_(this.j_,e)&&(this.Y_(this.j_),n=!0),n}J_(e,n){if(!e.fromCache)return!0;let r=n!=="Offline";return(!this.options.Z_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}H_(e){if(e.docChanges.length>0)return!0;let n=this.j_&&this.j_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Y_(e){e=za.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.z_=!0,this.G_.next(e)}};var NI=class{constructor(e,n){this.X_=e,this.byteLength=n}ea(){return"metadata"in this.X_}};var cg=class{constructor(e){this.serializer=e}Ps(e){return gr(this.serializer,e)}Is(e){return e.metadata.exists?bP(this.serializer,e.document,!1):at.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Ke(e)}},PI=class{constructor(e,n,r){this.ta=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=XP(e)}na(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.X_.namedQuery)this.queries.push(e.X_.namedQuery);else if(e.X_.documentMetadata){this.documents.push({metadata:e.X_.documentMetadata}),e.X_.documentMetadata.exists||++n;let r=me.fromString(e.X_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.X_.document&&(this.documents[this.documents.length-1].document=e.X_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ra(e){let n=new Map,r=new cg(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||ee()).add(s);n.set(o,a)}}return n}complete(){return v(this,null,function*(){let e=yield nz(this.localStore,new cg(this.serializer),this.documents,this.ta.id),n=this.ra(this.documents);for(let r of this.queries)yield rz(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ia:this.collectionGroups,sa:e}})}};function XP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var lg=class{constructor(e){this.key=e}},dg=class{constructor(e){this.key=e}},hg=class{constructor(e,n){this.query=e,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=ee(),this.mutatedKeys=ee(),this.ua=sP(e),this.ca=new ag(this.ua)}get la(){return this.oa}ha(e,n){let r=n?n.Pa:new ug,i=n?n.ca:this.ca,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=Bl(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),_=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),_=!0):this.Ia(h,f)||(r.track({type:2,doc:f}),_=!0,(u&&this.ua(f,u)>0||c&&this.ua(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),_=!0):h&&!f&&(r.track({type:1,doc:h}),_=!0,(u||c)&&(a=!0)),_&&(f?(o=o.add(f),s=g?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{ca:o,Pa:r,Xi:a,mutatedKeys:s}}Ia(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.ca;this.ca=e.ca,this.mutatedKeys=e.mutatedKeys;let o=e.Pa.k_();o.sort((l,d)=>function(f,p){let g=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return O()}};return g(f)-g(p)}(l.type,d.type)||this.ua(l.doc,d.doc)),this.Ta(r),i=i!=null&&i;let a=n&&!i?this.Ea():[],u=this.aa.size===0&&this.current&&!i?1:0,c=u!==this._a;return this._a=u,o.length!==0||c?{snapshot:new za(this.query,e.ca,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),da:a}:{da:a}}U_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new ug,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(e){return!this.oa.has(e)&&!!this.ca.has(e)&&!this.ca.get(e).hasLocalMutations}Ta(e){e&&(e.addedDocuments.forEach(n=>this.oa=this.oa.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.oa=this.oa.delete(n)),this.current=e.current)}Ea(){if(!this.current)return[];let e=this.aa;this.aa=ee(),this.ca.forEach(r=>{this.Aa(r.key)&&(this.aa=this.aa.add(r.key))});let n=[];return e.forEach(r=>{this.aa.has(r)||n.push(new dg(r))}),this.aa.forEach(r=>{e.has(r)||n.push(new lg(r))}),n}Ra(e){this.oa=e.hs,this.aa=ee();let n=this.ha(e.documents);return this.applyChanges(n,!0)}Va(){return za.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,this._a===0,this.hasCachedResults)}},kI=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},OI=class{constructor(e){this.key=e,this.ma=!1}},FI=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.fa={},this.ga=new vr(a=>rP(a),Ul),this.pa=new Map,this.ya=new Set,this.wa=new Pe(M.comparator),this.Sa=new Map,this.ba=new xl,this.Da={},this.Ca=new Map,this.va=Ha.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return this.Fa===!0}};function mz(t,e){return v(this,null,function*(){let n=bC(t),r,i,s=n.ga.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Va();else{let o=yield qa(n.localStore,Bt(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield IC(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&Dg(n.remoteStore,o)}return i})}function IC(t,e,n,r,i){return v(this,null,function*(){t.Ma=(d,h,f)=>function(g,_,T,P){return v(this,null,function*(){let A=_.view.ha(T);A.Xi&&(A=yield eg(g.localStore,_.query,!1).then(({documents:ke})=>_.view.ha(ke,A)));let H=P&&P.targetChanges.get(_.targetId),G=P&&P.targetMismatches.get(_.targetId)!=null,X=_.view.applyChanges(A,g.isPrimaryClient,H,G);return VI(g,_.targetId,X.da),X.snapshot})}(t,d,h,f);let s=yield eg(t.localStore,e,!0),o=new hg(e,s.hs),a=o.ha(s.documents),u=Tl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,u);VI(t,n,c.da);let l=new kI(e,n,o);return t.ga.set(e,l),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),c.snapshot})}function yz(t,e){return v(this,null,function*(){let n=N(t),r=n.ga.get(e),i=n.pa.get(r.targetId);if(i.length>1)return n.pa.set(r.targetId,i.filter(s=>!Ul(s,e))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Ga(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Nl(n.remoteStore,r.targetId),Wa(n,r.targetId)}).catch(Ui))):(Wa(n,r.targetId),yield Ga(n.localStore,r.targetId,!0))})}function _z(t,e,n){return v(this,null,function*(){let r=SC(t);try{let i=yield function(o,a){let u=N(o),c=je.now(),l=a.reduce((f,p)=>f.add(p.key),ee()),d,h;return u.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=Jt(),g=ee();return u.os.getEntries(f,l).next(_=>{p=_,p.forEach((T,P)=>{P.isValidDocument()||(g=g.add(T))})}).next(()=>u.localDocuments.getOverlayedDocuments(f,p)).next(_=>{d=_;let T=[];for(let P of a){let A=OG(P,d.get(P.key).overlayedDocument);A!=null&&T.push(new qn(P.key,A,YN(A.value.mapValue),He.exists(!0)))}return u.mutationQueue.addMutationBatch(f,c,T,a)}).next(_=>{h=_;let T=_.applyToLocalDocumentSet(d,g);return u.documentOverlayCache.saveOverlays(f,_.batchId,T)})}).then(()=>({batchId:h.batchId,changes:aP(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.Da[o.currentUser.toKey()];c||(c=new Pe(Z)),c=c.insert(a,u),o.Da[o.currentUser.toKey()]=c}(r,i.batchId,n),yield Qr(r,i.changes),yield eu(r.remoteStore)}catch(i){let s=nu(i,"Failed to persist write");n.reject(s)}})}function ek(t,e){return v(this,null,function*(){let n=N(t);try{let r=yield ez(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Sa.get(s);o&&(L(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.ma=!0:i.modifiedDocuments.size>0?L(o.ma):i.removedDocuments.size>0&&(L(o.ma),o.ma=!1))}),yield Qr(n,r,e)}catch(r){yield Ui(r)}})}function AN(t,e,n){let r=N(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ga.forEach((s,o)=>{let a=o.view.U_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=N(o);u.onlineState=a;let c=!1;u.queries.forEach((l,d)=>{for(let h of d.Q_)h.U_(a)&&(c=!0)}),c&&EC(u)}(r.eventManager,e),i.length&&r.fa.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function vz(t,e,n){return v(this,null,function*(){let r=N(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Sa.get(e),s=i&&i.key;if(s){let o=new Pe(M.comparator);o=o.insert(s,at.newNoDocument(s,B.min()));let a=ee().add(s),u=new Dl(B.min(),new Map,new Pe(Z),o,a);yield ek(r,u),r.wa=r.wa.remove(s),r.Sa.delete(e),TC(r)}else yield Ga(r.localStore,e,!1).then(()=>Wa(r,e,n)).catch(Ui)})}function wz(t,e){return v(this,null,function*(){let n=N(t),r=e.batch.batchId;try{let i=yield XG(n.localStore,e);DC(n,r,null),CC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Qr(n,i)}catch(i){yield Ui(i)}})}function Ez(t,e,n){return v(this,null,function*(){let r=N(t);try{let i=yield function(o,a){let u=N(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return u.mutationQueue.lookupMutationBatch(c,a).next(d=>(L(d!==null),l=d.keys(),u.mutationQueue.removeMutationBatch(c,d))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,l,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>u.localDocuments.getDocuments(c,l))})}(r.localStore,e);DC(r,e,n),CC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield Qr(r,i)}catch(i){yield Ui(i)}})}function Iz(t,e){return v(this,null,function*(){let n=N(t);$i(n.remoteStore)||C("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=N(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ca.get(r)||[];i.push(e),n.Ca.set(r,i)}catch(r){let i=nu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function CC(t,e){(t.Ca.get(e)||[]).forEach(n=>{n.resolve()}),t.Ca.delete(e)}function DC(t,e,n){let r=N(t),i=r.Da[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Da[r.currentUser.toKey()]=i}}function Wa(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.pa.get(e))t.ga.delete(r),n&&t.fa.xa(r,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach(r=>{t.ba.containsKey(r)||tk(t,r)})}function tk(t,e){t.ya.delete(e.path.canonicalString());let n=t.wa.get(e);n!==null&&(Nl(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),TC(t))}function VI(t,e,n){for(let r of n)r instanceof lg?(t.ba.addReference(r.key,e),Cz(t,r)):r instanceof dg?(C("SyncEngine","Document no longer in limbo: "+r.key),t.ba.removeReference(r.key,e),t.ba.containsKey(r.key)||tk(t,r.key)):O()}function Cz(t,e){let n=e.key,r=n.path.canonicalString();t.wa.get(n)||t.ya.has(r)||(C("SyncEngine","New document in limbo: "+n),t.ya.add(r),TC(t))}function TC(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){let e=t.ya.values().next().value;t.ya.delete(e);let n=new M(me.fromString(e)),r=t.va.next();t.Sa.set(r,new OI(n)),t.wa=t.wa.insert(n,r),Dg(t.remoteStore,new $a(Bt(Ja(n.path)),r,"TargetPurposeLimboResolution",on._e))}}function Qr(t,e,n){return v(this,null,function*(){let r=N(t),i=[],s=[],o=[];r.ga.isEmpty()||(r.ga.forEach((a,u)=>{o.push(r.Ma(u,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c?.fromCache?"not-current":"current"),c){i.push(c);let l=mI.Ki(u.targetId,c);s.push(l)}}))}),yield Promise.all(o),r.fa.u_(i),yield function(u,c){return v(this,null,function*(){let l=N(u);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>m.forEach(c,h=>m.forEach(h.qi,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>m.forEach(h.Qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Bi(d))throw d;C("LocalStore","Failed to update sequence numbers: "+d)}for(let d of c){let h=d.targetId;if(!d.fromCache){let f=l.ns.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);l.ns=l.ns.insert(h,g)}}})}(r.localStore,s))})}function Dz(t,e){return v(this,null,function*(){let n=N(t);if(!n.currentUser.isEqual(e)){C("SyncEngine","User change. New user:",e.toKey());let r=yield BP(n.localStore,e);n.currentUser=e,function(s,o){s.Ca.forEach(a=>{a.forEach(u=>{u.reject(new E(y.CANCELLED,o))})}),s.Ca.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Qr(n,r.us)}})}function Tz(t,e){let n=N(t),r=n.Sa.get(e);if(r&&r.ma)return ee().add(r.key);{let i=ee(),s=n.pa.get(e);if(!s)return i;for(let o of s){let a=n.ga.get(o);i=i.unionWith(a.view.la)}return i}}function bz(t,e){return v(this,null,function*(){let n=N(t),r=yield eg(n.localStore,e.query,!0),i=e.view.Ra(r);return n.isPrimaryClient&&VI(n,e.targetId,i.da),i})}function Sz(t,e){return v(this,null,function*(){let n=N(t);return GP(n.localStore,e).then(r=>Qr(n,r))})}function Az(t,e,n,r){return v(this,null,function*(){let i=N(t),s=yield function(a,u){let c=N(a),l=N(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.vn(d,u).next(h=>h?c.localDocuments.getDocuments(d,h):m.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield eu(i.remoteStore):n==="acknowledged"||n==="rejected"?(DC(i,e,r||null),CC(i,e),function(a,u){N(N(a).mutationQueue).Mn(u)}(i.localStore,e)):O(),yield Qr(i,s)):C("SyncEngine","Cannot apply mutation batch with id: "+e)})}function xz(t,e){return v(this,null,function*(){let n=N(t);if(bC(n),SC(n),e===!0&&n.Fa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield xN(n,r.toArray());n.Fa=!0,yield AI(n.remoteStore,!0);for(let s of i)Dg(n.remoteStore,s)}else if(e===!1&&n.Fa!==!1){let r=[],i=Promise.resolve();n.pa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Wa(n,o),Ga(n.localStore,o,!0))),Nl(n.remoteStore,o)}),yield i,yield xN(n,r),function(o){let a=N(o);a.Sa.forEach((u,c)=>{Nl(a.remoteStore,c)}),a.ba.mr(),a.Sa=new Map,a.wa=new Pe(M.comparator)}(n),n.Fa=!1,yield AI(n.remoteStore,!1)}})}function xN(t,e,n){return v(this,null,function*(){let r=N(t),i=[],s=[];for(let o of e){let a,u=r.pa.get(o);if(u&&u.length!==0){a=yield qa(r.localStore,Bt(u[0]));for(let c of u){let l=r.ga.get(c),d=yield bz(r,l);d.snapshot&&s.push(d.snapshot)}}else{let c=yield qP(r.localStore,o);a=yield qa(r.localStore,c),yield IC(r,nk(c),o,!1,a.resumeToken)}i.push(a)}return r.fa.u_(s),i})}function nk(t){return nP(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Mz(t){return function(n){return N(N(n).persistence).Li()}(N(t).localStore)}function Rz(t,e,n,r){return v(this,null,function*(){let i=N(t);if(i.Fa)return void C("SyncEngine","Ignoring unexpected query state notification.");let s=i.pa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield GP(i.localStore,iP(s[0])),a=Dl.createSynthesizedRemoteEventForCurrentChange(e,n==="current",gt.EMPTY_BYTE_STRING);yield Qr(i,o,a);break}case"rejected":yield Ga(i.localStore,e,!0),Wa(i,e,r);break;default:O()}})}function Nz(t,e,n){return v(this,null,function*(){let r=bC(t);if(r.Fa){for(let i of e){if(r.pa.has(i)){C("SyncEngine","Adding an already active target "+i);continue}let s=yield qP(r.localStore,i),o=yield qa(r.localStore,s);yield IC(r,nk(s),o.targetId,!1,o.resumeToken),Dg(r.remoteStore,o)}for(let i of n)r.pa.has(i)&&(yield Ga(r.localStore,i,!1).then(()=>{Nl(r.remoteStore,i),Wa(r,i)}).catch(Ui))}})}function bC(t){let e=N(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ek.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Tz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vz.bind(null,e),e.fa.u_=pz.bind(null,e.eventManager),e.fa.xa=gz.bind(null,e.eventManager),e}function SC(t){let e=N(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ez.bind(null,e),e}function Pz(t,e,n){let r=N(t);(function(s,o,a){return v(this,null,function*(){try{let u=yield o.getMetadata();if(yield function(f,p){let g=N(f),_=Ke(p.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",T=>g.$r.getBundleMetadata(T,p.id)).then(T=>!!T&&T.createTime.compareTo(_)>=0)}(s.localStore,u))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(XP(u));let c=new PI(u,s.localStore,o.serializer),l=yield o.Oa();for(;l;){let h=yield c.na(l);h&&a._updateProgress(h),l=yield o.Oa()}let d=yield c.complete();return yield Qr(s,d.sa,void 0),yield function(f,p){let g=N(f);return g.persistence.runTransaction("Save bundle","readwrite",_=>g.$r.saveBundleMetadata(_,p))}(s.localStore,u),a._completeWith(d.progress),Promise.resolve(d.ia)}catch(u){return Tn("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var kl=class{constructor(){this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){this.serializer=$l(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return UP(this.persistence,new Xp,e.initialUser,this.serializer)}createPersistence(e){return new Zp(Jp.Hr,this.serializer)}createSharedClientState(e){return new rg}terminate(){return v(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var fg=class t extends kl{constructor(e,n,r){super(),this.Na=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){yield Vm(t.prototype,this,"initialize").call(this,e),yield this.Na.initialize(this,e),yield SC(this.Na.syncEngine),yield eu(this.Na.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return UP(this.persistence,new Xp,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new tI(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new vE(n,this.persistence);return new _E(e.asyncQueue,r)}createPersistence(e){let n=gC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Dn.withCacheSize(this.cacheSizeBytes):Dn.DEFAULT;return new gI(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,WP(),Tp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new rg}},LI=class t extends fg{constructor(e,n){super(e,n,!1),this.Na=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return v(this,null,function*(){yield Vm(t.prototype,this,"initialize").call(this,e);let n=this.Na.syncEngine;this.sharedClientState instanceof pl&&(this.sharedClientState.syncEngine={Zs:Az.bind(null,n),Xs:Rz.bind(null,n),eo:Nz.bind(null,n),Li:Mz.bind(null,n),Ys:Sz.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>v(this,null,function*(){yield xz(this.Na.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=WP();if(!pl.D(n))throw new E(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=gC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new pl(n,e.asyncQueue,r,e.clientId,e.initialUser)}},Ol=class{initialize(e,n){return v(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>AN(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Dz.bind(null,this.syncEngine),yield AI(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new RI}()}createDatastore(e){let n=$l(e.databaseInfo.databaseId),r=function(s){return new II(s)}(e.databaseInfo);return function(s,o,a,u){return new TI(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new SI(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>AN(this.syncEngine,n,0),function(){return ig.D()?new ig:new wI}())}createSyncEngine(e,n){return function(i,s,o,a,u,c,l){let d=new FI(i,s,o,a,u,c);return l&&(d.Fa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return v(this,null,function*(){var e;yield function(r){return v(this,null,function*(){let i=N(r);C("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield Xa(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function MN(t,e=10240){let n=0;return{read(){return v(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return v(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Ka=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ba(this.observer.next,e)}error(e){this.observer.error?this.Ba(this.observer.error,e):ze("Uncaught Error in snapshot listener:",e.toString())}La(){this.muted=!0}Ba(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var jI=class{constructor(e,n){this.ka=e,this.serializer=n,this.metadata=new ot,this.buffer=new Uint8Array,this.qa=function(){return new TextDecoder("utf-8")}(),this.Qa().then(r=>{r&&r.ea()?this.metadata.resolve(r.X_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.X_)}`))},r=>this.metadata.reject(r))}close(){return this.ka.cancel()}getMetadata(){return v(this,null,function*(){return this.metadata.promise})}Oa(){return v(this,null,function*(){return yield this.getMetadata(),this.Qa()})}Qa(){return v(this,null,function*(){let e=yield this.Ka();if(e===null)return null;let n=this.qa.decode(e),r=Number(n);isNaN(r)&&this.$a(`length string (${n}) is not valid number`);let i=yield this.Ua(r);return new NI(JSON.parse(i),e.length+r)})}Wa(){return this.buffer.findIndex(e=>e===123)}Ka(){return v(this,null,function*(){for(;this.Wa()<0&&!(yield this.Ga()););if(this.buffer.length===0)return null;let e=this.Wa();e<0&&this.$a("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ua(e){return v(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ga())&&this.$a("Reached the end of bundle when more is expected.");let n=this.qa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}$a(e){throw this.ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ga(){return v(this,null,function*(){let e=yield this.ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var UI=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new E(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return v(this,null,function*(){let o=N(i),a={documents:s.map(d=>bl(o.serializer,d))},u=yield o.vo("BatchGetDocuments",o.serializer.databaseId,me.emptyPath(),a,s.length),c=new Map;u.forEach(d=>{let h=BG(o.serializer,d);c.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=c.get(d.toString());L(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Li(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=M.fromPath(r);this.mutations.push(new El(i,this.precondition(i)))}),yield function(r,i){return v(this,null,function*(){let s=N(r),o={writes:i.map(a=>Sl(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,me.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw O();n=B.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new E(y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(B.min())?He.exists(!1):He.updateTime(n):He.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(B.min()))throw new E(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return He.updateTime(n)}return He.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var BI=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.za=r.maxAttempts,this.jo=new Rl(this.asyncQueue,"transaction_retry")}ja(){this.za-=1,this.Ha()}Ha(){this.jo.qo(()=>v(this,null,function*(){let e=new UI(this.datastore),n=this.Ja(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Ya(i)}))}).catch(r=>{this.Ya(r)})}))}Ja(e){try{let n=this.updateFunction(e);return!Ll(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Ya(e){this.za>0&&this.Za(e)?(this.za-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ha(),Promise.resolve()))):this.deferred.reject(e)}Za(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!_P(n)}return!1}};var $I=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=st.UNAUTHENTICATED,this.clientId=Ap.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>v(this,null,function*(){C("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(C("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new E(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ot;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=nu(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function bp(t,e){return v(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),C("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>v(this,null,function*(){r.isEqual(i)||(yield BP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function HI(t,e){return v(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield AC(t);C("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>SN(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>SN(e.remoteStore,i)),t._onlineComponents=e})}function rk(t){return t.name==="FirebaseError"?t.code===y.FAILED_PRECONDITION||t.code===y.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function AC(t){return v(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){C("FirestoreClient","Using user provided OfflineComponentProvider");try{yield bp(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!rk(n))throw n;Tn("Error using user provided cache. Falling back to memory cache: "+n),yield bp(t,new kl)}}else C("FirestoreClient","Using default OfflineComponentProvider"),yield bp(t,new kl);return t._offlineComponents})}function Tg(t){return v(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(C("FirestoreClient","Using user provided OnlineComponentProvider"),yield HI(t,t._uninitializedComponentsProvider._online)):(C("FirestoreClient","Using default OnlineComponentProvider"),yield HI(t,new Ol))),t._onlineComponents})}function ik(t){return AC(t).then(e=>e.persistence)}function xC(t){return AC(t).then(e=>e.localStore)}function sk(t){return Tg(t).then(e=>e.remoteStore)}function MC(t){return Tg(t).then(e=>e.syncEngine)}function kz(t){return Tg(t).then(e=>e.datastore)}function Qa(t){return v(this,null,function*(){let e=yield Tg(t),n=e.eventManager;return n.onListen=mz.bind(null,e.syncEngine),n.onUnlisten=yz.bind(null,e.syncEngine),n})}function Oz(t){return t.asyncQueue.enqueue(()=>v(this,null,function*(){let e=yield ik(t),n=yield sk(t);return e.setNetworkEnabled(!0),function(i){let s=N(i);return s.v_.delete(0),Hl(s)}(n)}))}function Fz(t){return t.asyncQueue.enqueue(()=>v(this,null,function*(){let e=yield ik(t),n=yield sk(t);return e.setNetworkEnabled(!1),function(i){return v(this,null,function*(){let s=N(i);s.v_.add(0),yield Xa(s),s.x_.set("Offline")})}(n)}))}function Vz(t,e){let n=new ot;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s,o){return v(this,null,function*(){try{let a=yield function(c,l){let d=N(c);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new E(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=nu(a,`Failed to get document '${s} from cache`);o.reject(u)}})}(yield xC(t),e,n)})),n.promise}function ok(t,e,n={}){let r=new ot;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,o,a,u,c){let l=new Ka({next:h=>{o.enqueueAndForget(()=>wC(s,d));let f=h.docs.has(a);!f&&h.fromCache?c.reject(new E(y.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&u&&u.source==="server"?c.reject(new E(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new Pl(Ja(a.path),l,{includeMetadataChanges:!0,Z_:!0});return vC(s,d)}(yield Qa(t),t.asyncQueue,e,n,r)})),r.promise}function Lz(t,e){let n=new ot;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s,o){return v(this,null,function*(){try{let a=yield eg(i,s,!0),u=new hg(s,a.hs),c=u.ha(a.documents),l=u.applyChanges(c,!1);o.resolve(l.snapshot)}catch(a){let u=nu(a,`Failed to execute query '${s} against cache`);o.reject(u)}})}(yield xC(t),e,n)})),n.promise}function ak(t,e,n={}){let r=new ot;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,o,a,u,c){let l=new Ka({next:h=>{o.enqueueAndForget(()=>wC(s,d)),h.fromCache&&u.source==="server"?c.reject(new E(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new Pl(a,l,{includeMetadataChanges:!0,Z_:!0});return vC(s,d)}(yield Qa(t),t.asyncQueue,e,n,r)})),r.promise}function jz(t,e){let n=new Ka(e);return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s){N(i).K_.add(s),s.next()}(yield Qa(t),n)})),()=>{n.La(),t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s){N(i).K_.delete(s)}(yield Qa(t),n)}))}}function Uz(t,e,n,r){let i=function(o,a){let u;return u=typeof o=="string"?wP().encode(o):o,function(l,d){return new jI(l,d)}(function(l,d){if(l instanceof Uint8Array)return MN(l,d);if(l instanceof ArrayBuffer)return MN(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(n,$l(e));t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){Pz(yield MC(t),i,r)}))}function Bz(t,e){return t.asyncQueue.enqueue(()=>v(this,null,function*(){return function(r,i){let s=N(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield xC(t),e)}))}function uk(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var RN=new Map;function RC(t,e,n){if(!n)throw new E(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function NC(t,e,n,r){if(e===!0&&r===!0)throw new E(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function NN(t){if(!M.isDocumentKey(t))throw new E(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function PN(t){if(M.isDocumentKey(t))throw new E(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function bg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":O()}function ye(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new E(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=bg(t);throw new E(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function ck(t,e){if(e<=0)throw new E(y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var pg=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new E(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new E(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}NC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uk((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new E(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new E(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new E(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ws=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new pg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new E(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new E(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new pg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new uE;switch(r.type){case"firstParty":return new hE(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new E(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=RN.get(n);r&&(C("ComponentProvider","Removing Datastore"),RN.delete(n),r.terminate())}(this),Promise.resolve()}};function lk(t,e,n,r={}){var i;let s=(t=ye(t,Ws))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Tn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=st.MOCK_USER;else{a=Rd(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new E(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new st(c)}t._authCredentials=new cE(new Sp(a,u))}}var bt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Me=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},mr=class t extends bt{constructor(e,n,r){super(e,n,Ja(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new M(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function PC(t,e,...n){if(t=ce(t),RC("collection","path",e),t instanceof Ws){let r=me.fromString(e,...n);return PN(r),new mr(t,null,r)}{if(!(t instanceof Me||t instanceof mr))throw new E(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(me.fromString(e,...n));return PN(r),new mr(t.firestore,null,r)}}function dk(t,e){if(t=ye(t,Ws),RC("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new E(y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new bt(t,null,function(r){return new Hn(me.emptyPath(),r)}(e))}function ql(t,e,...n){if(t=ce(t),arguments.length===1&&(e=Ap.newId()),RC("doc","path",e),t instanceof Ws){let r=me.fromString(e,...n);return NN(r),new Me(t,null,new M(r))}{if(!(t instanceof Me||t instanceof mr))throw new E(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(me.fromString(e,...n));return NN(r),new Me(t.firestore,t instanceof mr?t.converter:null,new M(r))}}function kC(t,e){return t=ce(t),e=ce(e),(t instanceof Me||t instanceof mr)&&(e instanceof Me||e instanceof mr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function OC(t,e){return t=ce(t),e=ce(e),t instanceof bt&&e instanceof bt&&t.firestore===e.firestore&&Ul(t._query,e._query)&&t.converter===e.converter}var qI=class{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new Rl(this,"async_queue_retry"),this._u=()=>{let n=Tp();n&&C("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=Tp();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.au(),this.uu(e)}enterRestrictedMode(e){if(!this.tu){this.tu=!0,this.su=e||!1;let n=Tp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._u)}}enqueue(e){if(this.au(),this.tu)return new Promise(()=>{});let n=new ot;return this.uu(()=>this.tu&&this.su?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.eu.push(e),this.cu()))}cu(){return v(this,null,function*(){if(this.eu.length!==0){try{yield this.eu[0](),this.eu.shift(),this.jo.reset()}catch(e){if(!Bi(e))throw e;C("AsyncQueue","Operation failed with retryable error: "+e)}this.eu.length>0&&this.jo.qo(()=>this.cu())}})}uu(e){let n=this.Xa.then(()=>(this.iu=!0,e().catch(r=>{this.ru=r,this.iu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw ze("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.iu=!1,r))));return this.Xa=n,n}enqueueAfterDelay(e,n,r){this.au(),this.ou.indexOf(e)>-1&&(n=0);let i=xI.createAndSchedule(this,e,n,r,s=>this.lu(s));return this.nu.push(i),i}au(){this.ru&&O()}verifyOperationInProgress(){}hu(){return v(this,null,function*(){let e;do e=this.Xa,yield e;while(e!==this.Xa)})}Pu(e){for(let n of this.nu)if(n.timerId===e)return!0;return!1}Iu(e){return this.hu().then(()=>{this.nu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.nu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.hu()})}Tu(e){this.ou.push(e)}lu(e){let n=this.nu.indexOf(e);this.nu.splice(n,1)}};function GI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var zI=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new ot,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var hk=-1,Fe=class extends Ws{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new qI}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||fk(this),this._firestoreClient.terminate()}};function lt(t){return t._firestoreClient||fk(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function fk(t){var e,n,r;let i=t._freezeSettings(),s=function(a,u,c,l){return new wE(a,u,c,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,uk(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new $I(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function pk(t,e){Ck(t=ye(t,Fe));let n=lt(t);if(n._uninitializedComponentsProvider)throw new E(y.FAILED_PRECONDITION,"SDK cache is already specified.");Tn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new Ol;return mk(n,i,new fg(i,r.cacheSizeBytes,e?.forceOwnership))}function gk(t){Ck(t=ye(t,Fe));let e=lt(t);if(e._uninitializedComponentsProvider)throw new E(y.FAILED_PRECONDITION,"SDK cache is already specified.");Tn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new Ol;return mk(e,r,new LI(r,n.cacheSizeBytes))}function mk(t,e,n){let r=new ot;return t.asyncQueue.enqueue(()=>v(this,null,function*(){try{yield bp(t,n),yield HI(t,e),r.resolve()}catch(i){let s=i;if(!rk(s))throw s;Tn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function yk(t){if(t._initialized&&!t._terminated)throw new E(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new ot;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{yield function(r){return v(this,null,function*(){if(!qr.D())return Promise.resolve();let i=r+"main";yield qr.delete(i)})}(gC(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function _k(t){return function(n){let r=new ot;return n.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return Iz(yield MC(n),r)})),r.promise}(lt(t=ye(t,Fe)))}function vk(t){return Oz(lt(t=ye(t,Fe)))}function wk(t){return Fz(lt(t=ye(t,Fe)))}function Ek(t,e){let n=lt(t=ye(t,Fe)),r=new zI;return Uz(n,t._databaseId,e,r),r}function Ik(t,e){return Bz(lt(t=ye(t,Fe)),e).then(n=>n?new bt(t,null,n.query):null)}function Ck(t){if(t._initialized||t._terminated)throw new E(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var wr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(gt.fromBase64String(e))}catch(n){throw new E(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(gt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Gn=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new E(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new We(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Wr=class{constructor(e){this._methodName=e}};var Ks=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new E(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new E(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Z(this._lat,e._lat)||Z(this._long,e._long)}};var $z=/^__.*__$/,WI=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new qn(e,this.data,this.fieldMask,n,this.fieldTransforms):new Vi(e,this.data,n,this.fieldTransforms)}},gg=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new qn(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function Dk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw O()}}var mg=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Eu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.mu(e),i}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.Eu(),i}gu(e){return this.Au({path:void 0,Vu:!0})}pu(e){return yg(e,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Eu(){if(this.path)for(let e=0;e<this.path.length;e++)this.mu(this.path.get(e))}mu(e){if(e.length===0)throw this.pu("Document fields must not be empty");if(Dk(this.du)&&$z.test(e))throw this.pu('Document fields cannot begin and end with "__"')}},KI=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||$l(e)}Su(e,n,r,i=!1){return new mg({du:e,methodName:n,wu:r,path:We.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Js(t){let e=t._freezeSettings(),n=$l(t._databaseId);return new KI(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Sg(t,e,n,r,i,s={}){let o=t.Su(s.merge||s.mergeFields?2:0,e,n,i);LC("Data must be an object, but it was:",o,r);let a=Sk(r,o),u,c;if(s.merge)u=new an(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=XI(e,d,n);if(!o.contains(h))throw new E(y.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);xk(l,h)||l.push(h)}u=new an(l),c=o.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,c=o.fieldTransforms;return new WI(new Pt(a),u,c)}var Fl=class t extends Wr{_toFieldTransform(e){if(e.du!==2)throw e.du===1?e.pu(`${this._methodName}() can only appear at the top level of your update data`):e.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function Tk(t,e,n){return new mg({du:3,wu:e.settings.wu,methodName:t._methodName,Vu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var QI=class t extends Wr{_toFieldTransform(e){return new qs(e.path,new Oi)}isEqual(e){return e instanceof t}},YI=class t extends Wr{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=Tk(this,e,!0),r=this.bu.map(s=>Xs(s,n)),i=new Gr(r);return new qs(e.path,i)}isEqual(e){return e instanceof t&&Um(this.bu,e.bu)}},ZI=class t extends Wr{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=Tk(this,e,!0),r=this.bu.map(s=>Xs(s,n)),i=new zr(r);return new qs(e.path,i)}isEqual(e){return e instanceof t&&Um(this.bu,e.bu)}},JI=class t extends Wr{constructor(e,n){super(e),this.Du=n}_toFieldTransform(e){let n=new Fi(e.serializer,dP(e.serializer,this.Du));return new qs(e.path,n)}isEqual(e){return e instanceof t&&this.Du===e.Du}};function FC(t,e,n,r){let i=t.Su(1,e,n);LC("Data must be an object, but it was:",i,r);let s=[],o=Pt.empty();Zs(r,(u,c)=>{let l=jC(e,u,n);c=ce(c);let d=i.fu(l);if(c instanceof Fl)s.push(l);else{let h=Xs(c,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new an(s);return new gg(o,a,i.fieldTransforms)}function VC(t,e,n,r,i,s){let o=t.Su(1,e,n),a=[XI(e,r,n)],u=[i];if(s.length%2!=0)throw new E(y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(XI(e,s[h])),u.push(s[h+1]);let c=[],l=Pt.empty();for(let h=a.length-1;h>=0;--h)if(!xk(c,a[h])){let f=a[h],p=u[h];p=ce(p);let g=o.fu(f);if(p instanceof Fl)c.push(f);else{let _=Xs(p,g);_!=null&&(c.push(f),l.set(f,_))}}let d=new an(c);return new gg(l,d,o.fieldTransforms)}function bk(t,e,n,r=!1){return Xs(n,t.Su(r?4:3,e))}function Xs(t,e){if(Ak(t=ce(t)))return LC("Unsupported field value:",e,t),Sk(t,e);if(t instanceof Wr)return function(r,i){if(!Dk(i.du))throw i.pu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.pu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&e.du!==4)throw e.pu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=Xs(a,i.gu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ce(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return dP(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=je.fromDate(r);return{timestampValue:Ba(i.serializer,s)}}if(r instanceof je){let s=new je(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ba(i.serializer,s)}}if(r instanceof Ks)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof wr)return{bytesValue:EP(i.serializer,r._byteString)};if(r instanceof Me){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.pu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:hC(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.pu(`Unsupported field value: ${bg(r)}`)}(t,e)}function Sk(t,e){let n={};return WN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zs(t,(r,i)=>{let s=Xs(i,e.Ru(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function Ak(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof je||t instanceof Ks||t instanceof wr||t instanceof Me||t instanceof Wr)}function LC(t,e,n){if(!Ak(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=bg(n);throw r==="an object"?e.pu(t+" a custom object"):e.pu(t+" "+r)}}function XI(t,e,n){if((e=ce(e))instanceof Gn)return e._internalPath;if(typeof e=="string")return jC(t,e);throw yg("Field path arguments must be of type string or ",t,!1,void 0,n)}var Hz=new RegExp("[~\\*/\\[\\]]");function jC(t,e,n){if(e.search(Hz)>=0)throw yg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Gn(...e.split("."))._internalPath}catch{throw yg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function yg(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new E(y.INVALID_ARGUMENT,a+t+u)}function xk(t,e){return t.some(n=>n.isEqual(e))}var Qs=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new eC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(Ag("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},eC=class extends Qs{data(){return super.data()}};function Ag(t,e){return typeof e=="string"?jC(t,e):e instanceof Gn?e._internalPath:e._delegate._internalPath}function Mk(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new E(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Vl=class{},Ys=class extends Vl{};function Yr(t,e,...n){let r=[];e instanceof Vl&&r.push(e),r=r.concat(n),function(s){let o=s.filter(u=>u instanceof tC).length,a=s.filter(u=>u instanceof _g).length;if(o>1||o>0&&a>0)throw new E(y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var _g=class t extends Ys{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return Uk(e._query,n),new bt(e.firestore,e.converter,PE(e._query,n))}_parse(e){let n=Js(e.firestore);return function(s,o,a,u,c,l,d){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new E(y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){ON(d,l);let f=[];for(let p of d)f.push(kN(u,s,p));h={arrayValue:{values:f}}}else h=kN(u,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||ON(d,l),h=bk(a,o,d,l==="in"||l==="not-in");return fe.create(c,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function Rk(t,e,n){let r=e,i=Ag("where",t);return _g._create(i,r,n)}var tC=class t extends Vl{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:De.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let u of a)Uk(o,u),o=PE(o,u)}(e._query,n),new bt(e.firestore,e.converter,PE(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var nC=class t extends Ys{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new E(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new E(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new $s(s,o)}(e._query,this._field,this._direction);return new bt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Hn(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function Nk(t,e="asc"){let n=e,r=Ag("orderBy",t);return nC._create(r,n)}var vg=class t extends Ys{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new bt(e.firestore,e.converter,Lp(e._query,this._limit,this._limitType))}};function Pk(t){return ck("limit",t),vg._create("limit",t,"F")}function kk(t){return ck("limitToLast",t),vg._create("limitToLast",t,"L")}var wg=class t extends Ys{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=jk(e,this.type,this._docOrFields,this._inclusive);return new bt(e.firestore,e.converter,function(i,s){return new Hn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function Ok(...t){return wg._create("startAt",t,!0)}function Fk(...t){return wg._create("startAfter",t,!1)}var Eg=class t extends Ys{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=jk(e,this.type,this._docOrFields,this._inclusive);return new bt(e.firestore,e.converter,function(i,s){return new Hn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function Vk(...t){return Eg._create("endBefore",t,!1)}function Lk(...t){return Eg._create("endAt",t,!0)}function jk(t,e,n,r){if(n[0]=ce(n[0]),n[0]instanceof Qs)return function(s,o,a,u,c){if(!u)throw new E(y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of Pa(s))if(d.field.isKeyField())l.push(Bs(o,u.key));else{let h=u.data.field(d.field);if(Cg(h))throw new E(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new E(y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new _r(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=Js(t.firestore);return function(o,a,u,c,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new E(y.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let g=l[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new E(y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!lC(o)&&g.indexOf("/")!==-1)throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);let _=o.path.child(me.fromString(g));if(!M.isDocumentKey(_))throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${_}' is not because it contains an odd number of segments.`);let T=new M(_);f.push(Bs(a,T))}else{let _=bk(u,c,g);f.push(_)}}return new _r(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function kN(t,e,n){if(typeof(n=ce(n))=="string"){if(n==="")throw new E(y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lC(e)&&n.indexOf("/")!==-1)throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(me.fromString(n));if(!M.isDocumentKey(r))throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Bs(t,new M(r))}if(n instanceof Me)return Bs(t,n._key);throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bg(n)}.`)}function ON(t,e){if(!Array.isArray(t)||t.length===0)throw new E(y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Uk(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new E(y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new E(y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var Ya=class{convertValue(e,n="none"){switch(Us(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $e(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ni(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw O()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return Zs(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Ks($e(e.latitude),$e(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=uC(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(_l(e));default:return null}}convertTimestamp(e){let n=Ri(e);return new je(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=me.fromString(e);L(NP(r));let i=new Pi(r.get(1),r.get(3)),s=new M(r.popFirst(5));return i.isEqual(n)||ze(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function xg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var rC=class extends Ya{constructor(e){super(),this.firestore=e}convertBytes(e){return new wr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,n)}};var Hr=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Sn=class extends Qs{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new xi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(Ag("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},xi=class extends Sn{data(e={}){return super.data(e)}},zn=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Hr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new xi(this._firestore,this._userDataWriter,r.key,r,new Hr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new E(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let u=new xi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Hr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let u=new xi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Hr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,l=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:qz(a.type),doc:u,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function qz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return O()}}function UC(t,e){return t instanceof Sn&&e instanceof Sn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof zn&&e instanceof zn&&t._firestore===e._firestore&&OC(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Bk(t){t=ye(t,Me);let e=ye(t.firestore,Fe);return ok(lt(e),t._key).then(n=>qC(e,t,n))}var Kr=class extends Ya{constructor(e){super(),this.firestore=e}convertBytes(e){return new wr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,n)}};function $k(t){t=ye(t,Me);let e=ye(t.firestore,Fe),n=lt(e),r=new Kr(e);return Vz(n,t._key).then(i=>new Sn(e,r,t._key,i,new Hr(i!==null&&i.hasLocalMutations,!0),t.converter))}function Hk(t){t=ye(t,Me);let e=ye(t.firestore,Fe);return ok(lt(e),t._key,{source:"server"}).then(n=>qC(e,t,n))}function qk(t){t=ye(t,bt);let e=ye(t.firestore,Fe),n=lt(e),r=new Kr(e);return Mk(t._query),ak(n,t._query).then(i=>new zn(e,r,t,i))}function Gk(t){t=ye(t,bt);let e=ye(t.firestore,Fe),n=lt(e),r=new Kr(e);return Lz(n,t._query).then(i=>new zn(e,r,t,i))}function zk(t){t=ye(t,bt);let e=ye(t.firestore,Fe),n=lt(e),r=new Kr(e);return ak(n,t._query,{source:"server"}).then(i=>new zn(e,r,t,i))}function BC(t,e,n){t=ye(t,Me);let r=ye(t.firestore,Fe),i=xg(t.converter,e,n);return ru(r,[Sg(Js(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,He.none())])}function $C(t,e,n,...r){t=ye(t,Me);let i=ye(t.firestore,Fe),s=Js(i),o;return o=typeof(e=ce(e))=="string"||e instanceof Gn?VC(s,"updateDoc",t._key,e,n,r):FC(s,"updateDoc",t._key,e),ru(i,[o.toMutation(t._key,He.exists(!0))])}function Wk(t){return ru(ye(t.firestore,Fe),[new Li(t._key,He.none())])}function Kk(t,e){let n=ye(t.firestore,Fe),r=ql(t),i=xg(t.converter,e);return ru(n,[Sg(Js(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,He.exists(!1))]).then(()=>r)}function HC(t,...e){var n,r,i;t=ce(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||GI(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(GI(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let u,c,l;if(t instanceof Me)c=ye(t.firestore,Fe),l=Ja(t._key.path),u={next:d=>{e[o]&&e[o](qC(c,t,d))},error:e[o+1],complete:e[o+2]};else{let d=ye(t,bt);c=ye(d.firestore,Fe),l=d._query;let h=new Kr(c);u={next:f=>{e[o]&&e[o](new zn(c,h,d,f))},error:e[o+1],complete:e[o+2]},Mk(t._query)}return function(h,f,p,g){let _=new Ka(g),T=new Pl(f,_,p);return h.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return vC(yield Qa(h),T)})),()=>{_.La(),h.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return wC(yield Qa(h),T)}))}}(lt(c),l,a,u)}function Qk(t,e){return jz(lt(t=ye(t,Fe)),GI(e)?e:{next:e})}function ru(t,e){return function(r,i){let s=new ot;return r.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return _z(yield MC(r),i,s)})),s.promise}(lt(t),e)}function qC(t,e,n){let r=n.docs.get(e._key),i=new Kr(t);return new Sn(t,i,e._key,r,new Hr(n.hasPendingWrites,n.fromCache),e.converter)}var Gz={maxAttempts:5};var Ig=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Js(e)}set(e,n,r){this._verifyNotCommitted();let i=Si(e,this._firestore),s=xg(i.converter,n,r),o=Sg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,He.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=Si(e,this._firestore),o;return o=typeof(n=ce(n))=="string"||n instanceof Gn?VC(this._dataReader,"WriteBatch.update",s._key,n,r,i):FC(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,He.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=Si(e,this._firestore);return this._mutations=this._mutations.concat(new Li(n._key,He.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new E(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Si(t,e){if((t=ce(t)).firestore!==e)throw new E(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var iC=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Js(n)}get(n){let r=Si(n,this._firestore),i=new rC(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return O();let o=s[0];if(o.isFoundDocument())return new Qs(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Qs(this._firestore,i,r._key,null,r.converter);throw O()})}set(n,r,i){let s=Si(n,this._firestore),o=xg(s.converter,r,i),a=Sg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=Si(n,this._firestore),a;return a=typeof(r=ce(r))=="string"||r instanceof Gn?VC(this._dataReader,"Transaction.update",o._key,r,i,s):FC(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=Si(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=Si(e,this._firestore),r=new Kr(this._firestore);return super.get(e).then(i=>new Sn(this._firestore,r,n._key,i._document,new Hr(!1,!1),n.converter))}};function Yk(t,e,n){t=ye(t,Fe);let r=Object.assign(Object.assign({},Gz),n);return function(s){if(s.maxAttempts<1)throw new E(y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let u=new ot;return s.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){let c=yield kz(s);new BI(s.asyncQueue,c,a,o,u).ja()})),u.promise}(lt(t),i=>e(new iC(t,i)),r)}function Zk(){return new Fl("deleteField")}function Jk(){return new QI("serverTimestamp")}function Xk(...t){return new YI("arrayUnion",t)}function eO(...t){return new ZI("arrayRemove",t)}function tO(t){return new JI("increment",t)}(function(e,n=!0){(function(i){Za=i})(Fd),Xi(new Xt("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Fe(new lE(r.getProvider("auth-internal")),new pE(r.getProvider("app-check-internal")),function(c,l){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new E(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pi(c.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Rn(VR,"4.4.2",e),Rn(VR,"4.4.2","esm2017")})();var zz="@firebase/firestore-compat",Wz="0.3.25";function YC(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new E("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function nO(){if(typeof Uint8Array>"u")throw new E("unimplemented","Uint8Arrays are not available in this environment.")}function rO(){if(!KN())throw new E("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Mg=class t{constructor(e){this._delegate=e}static fromBase64String(e){return rO(),new t(wr.fromBase64String(e))}static fromUint8Array(e){return nO(),new t(wr.fromUint8Array(e))}toBase64(){return rO(),this._delegate.toBase64()}toUint8Array(){return nO(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function GC(t){return Kz(t,["next","error","complete"])}function Kz(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var zC=class{enableIndexedDbPersistence(e,n){return pk(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return gk(e._delegate)}clearIndexedDbPersistence(e){return yk(e._delegate)}},Rg=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Pi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Tn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){lk(this._delegate,e,n,r)}enableNetwork(){return vk(this._delegate)}disableNetwork(){return wk(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,NC("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return _k(this._delegate)}onSnapshotsInSync(e){return Qk(this._delegate,e)}get app(){if(!this._appCompat)throw new E("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ou(this,PC(this._delegate,e))}catch(n){throw $t(n,"collection()","Firestore.collection()")}}doc(e){try{return new Er(this,ql(this._delegate,e))}catch(n){throw $t(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ro(this,dk(this._delegate,e))}catch(n){throw $t(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Yk(this._delegate,n=>e(new Ng(this,n)))}batch(){return lt(this._delegate),new Pg(new Ig(this._delegate,e=>ru(this._delegate,e)))}loadBundle(e){return Ek(this._delegate,e)}namedQuery(e){return Ik(this._delegate,e).then(n=>n?new ro(this,n):null)}},iu=class extends Ya{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mg(new wr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return Er.forKey(n,this.firestore,null)}};function Qz(t){FN(t)}var Ng=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new iu(e)}get(e){let n=eo(e);return this._delegate.get(n).then(r=>new to(this._firestore,new Sn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=eo(e);return r?(YC("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=eo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=eo(e);return this._delegate.delete(n),this}},Pg=class{constructor(e){this._delegate=e}set(e,n,r){let i=eo(e);return r?(YC("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=eo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=eo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},su=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new xi(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new no(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new iu(e),n),i.set(n,s)),s}};su.INSTANCES=new WeakMap;var Er=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new iu(e)}static forPath(e,n,r){if(e.length%2!==0)throw new E("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new Me(n._delegate,r,new M(e)))}static forKey(e,n,r){return new t(n,new Me(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ou(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ou(this.firestore,PC(this._delegate,e))}catch(n){throw $t(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ce(e),e instanceof Me?kC(this._delegate,e):!1}set(e,n){n=YC("DocumentReference.set",n);try{return n?BC(this._delegate,e,n):BC(this._delegate,e)}catch(r){throw $t(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?$C(this._delegate,e):$C(this._delegate,e,n,...r)}catch(i){throw $t(i,"updateDoc()","DocumentReference.update()")}}delete(){return Wk(this._delegate)}onSnapshot(...e){let n=iO(e),r=sO(e,i=>new to(this.firestore,new Sn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return HC(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=$k(this._delegate):e?.source==="server"?n=Hk(this._delegate):n=Bk(this._delegate),n.then(r=>new to(this.firestore,new Sn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(su.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function $t(t,e,n){return t.message=t.message.replace(e,n),t}function iO(t){for(let e of t)if(typeof e=="object"&&!GC(e))return e;return{}}function sO(t,e){var n,r;let i;return GC(t[0])?i=t[0]:GC(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var to=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Er(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return UC(this._delegate,e._delegate)}},no=class extends to{data(e){let n=this._delegate.data(e);return this._delegate._converter||VN(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},ro=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new iu(e)}where(e,n,r){try{return new t(this.firestore,Yr(this._delegate,Rk(e,n,r)))}catch(i){throw $t(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,Yr(this._delegate,Nk(e,n)))}catch(r){throw $t(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,Yr(this._delegate,Pk(e)))}catch(n){throw $t(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,Yr(this._delegate,kk(e)))}catch(n){throw $t(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,Yr(this._delegate,Ok(...e)))}catch(n){throw $t(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,Yr(this._delegate,Fk(...e)))}catch(n){throw $t(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,Yr(this._delegate,Vk(...e)))}catch(n){throw $t(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,Yr(this._delegate,Lk(...e)))}catch(n){throw $t(n,"endAt()","Query.endAt()")}}isEqual(e){return OC(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=Gk(this._delegate):e?.source==="server"?n=zk(this._delegate):n=qk(this._delegate),n.then(r=>new Gl(this.firestore,new zn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=iO(e),r=sO(e,i=>new Gl(this.firestore,new zn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return HC(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(su.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},WC=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new no(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Gl=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new ro(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new no(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new WC(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new no(this._firestore,r))})}isEqual(e){return UC(this._delegate,e._delegate)}},ou=class t extends ro{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Er(this.firestore,e):null}doc(e){try{return e===void 0?new Er(this.firestore,ql(this._delegate)):new Er(this.firestore,ql(this._delegate,e))}catch(n){throw $t(n,"doc()","CollectionReference.doc()")}}add(e){return Kk(this._delegate,e).then(n=>new Er(this.firestore,n))}isEqual(e){return kC(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(su.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function eo(t){return ye(t,Me)}var KC=class t{constructor(...e){this._delegate=new Gn(...e)}static documentId(){return new t(We.keyField().canonicalString())}isEqual(e){return e=ce(e),e instanceof Gn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var QC=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=Jk();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=Zk();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=Xk(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=eO(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=tO(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var Yz={Firestore:Rg,GeoPoint:Ks,Timestamp:je,Blob:Mg,Transaction:Ng,WriteBatch:Pg,DocumentReference:Er,DocumentSnapshot:to,Query:ro,QueryDocumentSnapshot:no,QuerySnapshot:Gl,CollectionReference:ou,FieldPath:KC,FieldValue:QC,setLogLevel:Qz,CACHE_SIZE_UNLIMITED:hk};function Zz(t,e){t.INTERNAL.registerComponent(new Xt("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Yz)))}function Jz(t){Zz(t,(e,n)=>new Rg(e,n,new zC)),t.registerVersion(zz,Wz)}Jz(vt);function Xz(t,e=is){return new ne(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function oO(t,e){return Xz(t,e)}function e3(t,e){return oO(t,e).pipe(os(void 0),Fu(),j(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function XC(t,e){return oO(t,e).pipe(j(n=>({payload:n,type:"query"})))}var kg=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=cO(r,n);return new Fg(i,s,this.afs)}snapshotChanges(){return e3(this.ref,this.afs.schedulers.outsideAngular).pipe(Ge)}valueChanges(e={}){return this.snapshotChanges().pipe(j(({payload:n})=>e.idField?ue(x({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return _e(this.ref.get(e)).pipe(Ge)}};function Og(t,e){return XC(t,e).pipe(os(void 0),Fu(),j(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let c=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function aO(t,e,n){return Og(t,n).pipe(Zn((r,i)=>t3(r,i.map(s=>s.payload),e),[]),ku(),j(r=>r.map(i=>({type:i.type,payload:i}))))}function t3(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=n3(t,r))}),t}function ZC(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function n3(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return ZC(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return ZC(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return ZC(t,e.oldIndex,1);break}return t}function uO(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var Fg=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Og(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(j(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(os(void 0),Fu(),It(([r,i])=>i.length>0||!r),j(([,r])=>r),Ge)}auditTrail(e){return this.stateChanges(e).pipe(Zn((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=uO(e);return aO(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ge)}valueChanges(e={}){return XC(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.payload.docs.map(r=>e.idField?ue(x({},r.data()),{[e.idField]:r.id}):r.data())),Ge)}get(e){return _e(this.query.get(e)).pipe(Ge)}add(e){return this.ref.add(e)}doc(e){return new kg(this.ref.doc(e),this.afs)}},JC=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Og(this.query,this.afs.schedulers.outsideAngular).pipe(Ge):Og(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.filter(r=>e.indexOf(r.type)>-1)),It(n=>n.length>0),Ge)}auditTrail(e){return this.stateChanges(e).pipe(Zn((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=uO(e);return aO(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ge)}valueChanges(e={}){return XC(this.query,this.afs.schedulers.outsideAngular).pipe(j(r=>r.payload.docs.map(i=>e.idField?x({[e.idField]:i.id},i.data()):i.data())),Ge)}get(e){return _e(this.query.get(e)).pipe(Ge)}},r3=new F("angularfire2.enableFirestorePersistence"),i3=new F("angularfire2.firestore.persistenceSettings"),s3=new F("angularfire2.firestore.settings"),o3=new F("angularfire2.firestore.use-emulator");function cO(t,e=n=>n){return{query:e(t),ref:t}}var au=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,_,T,P){this.schedulers=u;let A=bs(n,a,r),H=l;d&&kc(A,a,h,p,g,_,f,T),[this.firestore,this.persistenceEnabled$]=ga(`${A.name}.firestore`,"AngularFirestore",A.name,()=>{let G=a.runOutsideAngular(()=>A.firestore());if(s&&G.settings(s),H&&G.useEmulator(...H),i&&!ws(o)){let X=()=>{try{return _e(G.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(ke){return typeof console<"u"&&console.warn(ke),U(!1)}};return[G,a.runOutsideAngular(X)]}else return[G,U(!1)]},[s,H,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=cO(i,r),a=this.schedulers.ngZone.run(()=>s);return new Fg(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new JC(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new kg(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(I(wi),I(Ei,8),I(r3,8),I(s3,8),I(xt),I(le),I(pa),I(i3,8),I(o3,8),I(Bf,8),I(Ac,8),I(xc,8),I(Mc,8),I(Rc,8),I(Nc,8),I(Pc,8),I(jr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var lO=(()=>{let e=class e{constructor(r){this.firestore=r}getLibros(){return this.firestore.collection("libros").snapshotChanges()}createLibro(r){return this.firestore.collection("libros").add(Object.assign({},r))}updateLibro(r){this.firestore.doc("libros/"+r.id).update(r)}deleteLibro(r){this.firestore.doc("libros/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(I(au))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var vO=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(oe(Or),oe(ir))},e.\u0275dir=At({type:e});let t=e;return t})(),Ug=(()=>{let e=class e extends vO{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=hi(e)))(s||e)}})(),e.\u0275dir=At({type:e,features:[Fr]});let t=e;return t})(),Ql=new F("");var u3={provide:Ql,useExisting:li(()=>Hi),multi:!0};function c3(){let t=sr()?sr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var l3=new F(""),Hi=(()=>{let e=class e extends vO{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!c3())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(oe(Or),oe(ir),oe(l3,8))},e.\u0275dir=At({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&he("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[ta([u3]),Fr]});let t=e;return t})();var d3=new F(""),h3=new F("");function wO(t){return t!=null}function EO(t){return _s(t)?_e(t):t}function IO(t){let e={};return t.forEach(n=>{e=n!=null?x(x({},e),n):e}),Object.keys(e).length===0?null:e}function CO(t,e){return e.map(n=>n(t))}function f3(t){return!t.validate}function DO(t){return t.map(e=>f3(e)?e:n=>e.validate(n))}function p3(t){if(!t)return null;let e=t.filter(wO);return e.length==0?null:function(n){return IO(CO(n,e))}}function TO(t){return t!=null?p3(DO(t)):null}function g3(t){if(!t)return null;let e=t.filter(wO);return e.length==0?null:function(n){let r=CO(n,e).map(EO);return sy(r).pipe(j(IO))}}function bO(t){return t!=null?g3(DO(t)):null}function dO(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function m3(t){return t._rawValidators}function y3(t){return t._rawAsyncValidators}function tD(t){return t?Array.isArray(t)?t:[t]:[]}function Lg(t,e){return Array.isArray(t)?t.includes(e):t===e}function hO(t,e){let n=tD(e);return tD(t).forEach(i=>{Lg(n,i)||n.push(i)}),n}function fO(t,e){return tD(e).filter(n=>!Lg(t,n))}var jg=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=TO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=bO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},nD=class extends jg{get formDirective(){return null}get path(){return null}},Kl=class extends jg{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},rD=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},_3={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},wte=ue(x({},_3),{"[class.ng-submitted]":"isSubmitted"}),cu=(()=>{let e=class e extends rD{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(oe(Kl,2))},e.\u0275dir=At({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Q_("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Fr]});let t=e;return t})();var zl="VALID",Vg="INVALID",uu="PENDING",Wl="DISABLED";function v3(t){return(Bg(t)?t.validators:t)||null}function w3(t){return Array.isArray(t)?TO(t):t||null}function E3(t,e){return(Bg(e)?e.asyncValidators:t)||null}function I3(t){return Array.isArray(t)?bO(t):t||null}function Bg(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var iD=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===zl}get invalid(){return this.status===Vg}get pending(){return this.status==uu}get disabled(){return this.status===Wl}get enabled(){return this.status!==Wl}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(hO(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(hO(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(fO(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(fO(e,this._rawAsyncValidators))}hasValidator(e){return Lg(this._rawValidators,e)}hasAsyncValidator(e){return Lg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=uu,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Wl,this.errors=null,this._forEachChild(r=>{r.disable(ue(x({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ue(x({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=zl,this._forEachChild(r=>{r.enable(ue(x({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ue(x({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===zl||this.status===uu)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Wl:zl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=uu,this._hasOwnPendingAsyncValidator=!0;let n=EO(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ct,this.statusChanges=new ct}_calculateStatus(){return this._allControlsDisabled()?Wl:this.errors?Vg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(uu)?uu:this._anyControlsHaveStatus(Vg)?Vg:zl}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Bg(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=w3(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=I3(this._rawAsyncValidators)}};var SO=new F("CallSetDisabledState",{providedIn:"root",factory:()=>sD}),sD="always";function C3(t,e){return[...e.path,t]}function D3(t,e,n=sD){b3(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),S3(t,e),x3(t,e),A3(t,e),T3(t,e)}function pO(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function T3(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function b3(t,e){let n=m3(t);e.validator!==null?t.setValidators(dO(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=y3(t);e.asyncValidator!==null?t.setAsyncValidators(dO(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();pO(e._rawValidators,i),pO(e._rawAsyncValidators,i)}function S3(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&AO(t,e)})}function A3(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&AO(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function AO(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function x3(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function M3(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function R3(t){return Object.getPrototypeOf(t.constructor)===Ug}function N3(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===Hi?n=s:R3(s)?r=s:i=s}),i||r||n||null}function gO(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function mO(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var P3=class extends iD{constructor(e=null,n,r){super(v3(n),E3(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Bg(n)&&(n.nonNullable||n.initialValueIsDefault)&&(mO(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){gO(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){gO(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){mO(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var k3={provide:Kl,useExisting:li(()=>io)},yO=Promise.resolve(),io=(()=>{let e=class e extends Kl{constructor(r,i,s,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this.control=new P3,this._registered=!1,this.name="",this.update=new ct,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=N3(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),M3(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){D3(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){yO.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&vs(i);yO.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?C3(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(oe(nD,9),oe(d3,10),oe(h3,10),oe(Ql,10),oe(Jo,8),oe(SO,8))},e.\u0275dir=At({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Vt.None,"disabled","isDisabled"],model:[Vt.None,"ngModel","model"],options:[Vt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ta([k3]),Fr,ms]});let t=e;return t})();var O3={provide:Ql,useExisting:li(()=>oD),multi:!0},oD=(()=>{let e=class e extends Ug{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=hi(e)))(s||e)}})(),e.\u0275dir=At({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&he("input",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},features:[ta([O3]),Fr]});let t=e;return t})();var F3={provide:Ql,useExisting:li(()=>lu),multi:!0};function xO(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function V3(t){return t.split(":")[0]}var lu=(()=>{let e=class e extends Ug{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=xO(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=V3(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=hi(e)))(s||e)}})(),e.\u0275dir=At({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&he("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[ta([F3]),Fr]});let t=e;return t})(),$g=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(xO(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(oe(ir),oe(Or),oe(lu,9))},e.\u0275dir=At({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),L3={provide:Ql,useExisting:li(()=>MO),multi:!0};function _O(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function j3(t){return t.split(":")[0]}var MO=(()=>{let e=class e extends Ug{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let u=0;u<a.length;u++){let c=a[u],l=this._getOptionValue(c.value);s.push(l)}}else{let a=i.options;for(let u=0;u<a.length;u++){let c=a[u];if(c.selected){let l=this._getOptionValue(c.value);s.push(l)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=j3(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=hi(e)))(s||e)}})(),e.\u0275dir=At({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&he("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[ta([L3]),Fr]});let t=e;return t})(),Hg=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(_O(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(_O(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(oe(ir),oe(Or),oe(MO,9))},e.\u0275dir=At({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var U3=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e}),e.\u0275inj=Xe({});let t=e;return t})();var RO=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:SO,useValue:r.callSetDisabledState??sD}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e}),e.\u0275inj=Xe({imports:[U3]});let t=e;return t})();function B3(t,e){if(t&1){let n=Xo();w(0,"tr")(1,"td"),b(2),D(),w(3,"td"),b(4),D(),w(5,"td"),b(6),D(),w(7,"td"),b(8),D(),w(9,"td")(10,"button",4),he("click",function(){let s=Wo(n).$implicit,o=ea();return Ko(o.selectLibro(s))}),b(11,"Seleccionar"),D()()()}if(t&2){let n=e.$implicit;Ee(2),Lt(n.titulo),Ee(2),Lt(n.autor),Ee(2),Lt(n.editorial),Ee(2),Lt(n.year)}}var NO=(()=>{let e=class e{constructor(r){this.libroService=r,this.libros=[],this.libro=new Ds}ngOnInit(){this.libroService.getLibros().subscribe(r=>{this.libros=r.map(i=>ue(x({},i.payload.doc.data()),{id:i.payload.doc.id}))})}insertarLibro(){this.libroService.createLibro(this.libro),this.libro=new Ds}selectLibro(r){this.libro=r}updateLibro(){this.libroService.updateLibro(this.libro),this.libro=new Ds}deleteLibro(r){this.libroService.deleteLibro(r),this.libro=new Ds}};e.\u0275fac=function(i){return new(i||e)(oe(lO))},e.\u0275cmp=Yt({type:e,selectors:[["app-libros"]],decls:45,vars:5,consts:[[1,"container"],[1,"col-sm-4"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],[2,"display","flex","flex-direction","row","gap","1em"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"table","table-striped"],[4,"ngFor","ngForOf"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"h4"),b(2,"Cat\xE1logo de libros"),D(),w(3,"div",1)(4,"label"),b(5," T\xEDtulo "),w(6,"input",2),he("ngModelChange",function(a){return s.libro.titulo=a}),D()(),xe(7,"br"),w(8,"label"),b(9," Autor "),w(10,"input",2),he("ngModelChange",function(a){return s.libro.autor=a}),D()(),xe(11,"br"),w(12,"label"),b(13," Editorial "),w(14,"input",2),he("ngModelChange",function(a){return s.libro.editorial=a}),D()(),xe(15,"br"),w(16,"label"),b(17," A\xF1o de publicaci\xF3n "),w(18,"input",2),he("ngModelChange",function(a){return s.libro.year=a}),D()(),xe(19,"hr"),w(20,"div",3)(21,"button",4),he("click",function(){return s.insertarLibro()}),b(22,"Insertar"),D(),w(23,"button",5),he("click",function(){return s.updateLibro()}),b(24,"Actualizar"),D(),w(25,"button",6),he("click",function(){return s.deleteLibro(s.libro.id)}),b(26,"Eliminar"),D()()()(),xe(27,"hr"),w(28,"div",0)(29,"h1"),b(30,"Cat\xE1logo de libros"),D(),w(31,"table",7)(32,"thead")(33,"th"),b(34,"T\xEDtulo"),D(),w(35,"th"),b(36,"Autor"),D(),w(37,"th"),b(38,"Editorial"),D(),w(39,"th"),b(40,"A\xF1o de publicaci\xF3n"),D(),w(41,"th"),b(42,"Seleccionar"),D()(),w(43,"tbody"),ys(44,B3,12,4,"tr",8),D()()()),i&2&&(Ee(6),tt("ngModel",s.libro.titulo),Ee(4),tt("ngModel",s.libro.autor),Ee(4),tt("ngModel",s.libro.editorial),Ee(4),tt("ngModel",s.libro.year),Ee(26),tt("ngForOf",s.libros))},dependencies:[ia,Hi,cu,io]});let t=e;return t})();var so=class{constructor(){this.id="",this.domicilio="",this.nombre="",this.rfc="",this.tipoCliente=""}};var PO=(()=>{let e=class e{constructor(r){this.firestore=r}getClientes(){return this.firestore.collection("clientes").snapshotChanges()}createCliente(r){return this.firestore.collection("clientes").add(Object.assign({},r))}updateCliente(r){this.firestore.doc("clientes/"+r.id).update(r)}deleteCliente(r){this.firestore.doc("clientes/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(I(au))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function H3(t,e){if(t&1){let n=Xo();w(0,"tr")(1,"td"),b(2),D(),w(3,"td"),b(4),D(),w(5,"td"),b(6),D(),w(7,"td"),b(8),D(),w(9,"td")(10,"button",8),he("click",function(){let s=Wo(n).$implicit,o=ea();return Ko(o.selectCliente(s))}),b(11,"Seleccionar"),D()()()}if(t&2){let n=e.$implicit;Ee(2),Lt(n.nombre),Ee(2),Lt(n.domicilio),Ee(2),Lt(n.rfc),Ee(2),Lt(n.tipoCliente)}}var kO=(()=>{let e=class e{constructor(r){this.clienteService=r,this.clientes=[],this.cliente=new so}ngOnInit(){this.clienteService.getClientes().subscribe(r=>{this.clientes=r.map(i=>ue(x({},i.payload.doc.data()),{id:i.payload.doc.id}))})}insertarCliente(){this.clienteService.createCliente(this.cliente),this.cliente=new so}selectCliente(r){this.cliente=r}updateCliente(){this.clienteService.updateCliente(this.cliente),this.cliente=new so}deleteCliente(r){this.clienteService.deleteCliente(r),this.cliente=new so}};e.\u0275fac=function(i){return new(i||e)(oe(PO))},e.\u0275cmp=Yt({type:e,selectors:[["app-clientes"]],decls:53,vars:5,consts:[[1,"container"],[1,"col-sm-4"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["value","sin definir"],["value","inactivo"],["value","activo"],["value","deudor"],[2,"display","flex","flex-direction","row","gap","1em"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"table","table-striped"],[4,"ngFor","ngForOf"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"h4"),b(2,"Clientes"),D(),w(3,"div",1)(4,"label"),b(5," Nombre "),w(6,"input",2),he("ngModelChange",function(a){return s.cliente.nombre=a}),D()(),xe(7,"br"),w(8,"label"),b(9," Domicilio "),w(10,"input",2),he("ngModelChange",function(a){return s.cliente.domicilio=a}),D()(),xe(11,"br"),w(12,"label"),b(13," RFC "),w(14,"input",2),he("ngModelChange",function(a){return s.cliente.rfc=a}),D()(),xe(15,"br"),w(16,"label"),b(17," Tipo de Cliente "),w(18,"select",2),he("ngModelChange",function(a){return s.cliente.tipoCliente=a}),w(19,"option",3),b(20,"Sin definir"),D(),w(21,"option",4),b(22,"Inactivo"),D(),w(23,"option",5),b(24,"Activo"),D(),w(25,"option",6),b(26,"Deudor"),D()()(),xe(27,"hr"),w(28,"div",7)(29,"button",8),he("click",function(){return s.insertarCliente()}),b(30,"Insertar"),D(),w(31,"button",9),he("click",function(){return s.updateCliente()}),b(32,"Actualizar"),D(),w(33,"button",10),he("click",function(){return s.deleteCliente(s.cliente.id)}),b(34,"Eliminar"),D()()()(),xe(35,"hr"),w(36,"div",0)(37,"h1"),b(38,"Clientes"),D(),w(39,"table",11)(40,"thead")(41,"th"),b(42,"Nombre"),D(),w(43,"th"),b(44,"Domicilio"),D(),w(45,"th"),b(46,"RFC"),D(),w(47,"th"),b(48,"Tipo"),D(),w(49,"th"),b(50,"Seleccionar"),D()(),w(51,"tbody"),ys(52,H3,12,4,"tr",12),D()()()),i&2&&(Ee(6),tt("ngModel",s.cliente.nombre),Ee(4),tt("ngModel",s.cliente.domicilio),Ee(4),tt("ngModel",s.cliente.rfc),Ee(4),tt("ngModel",s.cliente.tipoCliente),Ee(34),tt("ngForOf",s.clientes))},dependencies:[ia,$g,Hg,Hi,lu,cu,io]});let t=e;return t})();var oo=class{constructor(){this.id="",this.nombre="",this.descripcion="",this.genero="",this.plataforma="",this.precio=0}};var OO=(()=>{let e=class e{constructor(r){this.firestore=r}getJuegos(){return this.firestore.collection("juegos").snapshotChanges()}createJuego(r){return this.firestore.collection("juegos").add(Object.assign({},r))}updateJuego(r){this.firestore.doc("juegos/"+r.id).update(r)}deleteJuego(r){this.firestore.doc("juegos/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(I(au))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function G3(t,e){if(t&1){let n=Xo();w(0,"tr")(1,"td"),b(2),D(),w(3,"td"),b(4),D(),w(5,"td"),b(6),D(),w(7,"td")(8,"button",20),he("click",function(){let s=Wo(n).$implicit,o=ea();return Ko(o.selectJuego(s))}),b(9,"Seleccionar"),D()()()}if(t&2){let n=e.$implicit;Ee(2),Lt(n.nombre),Ee(2),Lt(n.descripcion),Ee(2),Lt(n.plataforma)}}var FO=(()=>{let e=class e{constructor(r){this.juegoService=r,this.juegos=[],this.juego=new oo}ngOnInit(){this.juegoService.getJuegos().subscribe(r=>{this.juegos=r.map(i=>ue(x({},i.payload.doc.data()),{id:i.payload.doc.id}))})}insertarJuego(){this.juegoService.createJuego(this.juego),this.juego=new oo}selectJuego(r){this.juego=r}updateJuego(){this.juegoService.updateJuego(this.juego),this.juego=new oo}deleteJuego(r){this.juegoService.deleteJuego(r),this.juego=new oo}};e.\u0275fac=function(i){return new(i||e)(oe(OO))},e.\u0275cmp=Yt({type:e,selectors:[["app-juegos"]],decls:64,vars:6,consts:[[1,"container"],[1,"col-6"],[1,"form-group"],["for","nombre"],["type","text","id","nombre","name","nombre",1,"form-control",3,"ngModel","ngModelChange"],["for","descripcion"],["name","descripcion","id","descripcion","rows","3",1,"form-control",3,"ngModel","ngModelChange"],["for","genero"],["id","genero","name","genero",1,"form-control",3,"ngModel","ngModelChange"],["value","accion"],["value","aventura"],["value","rpg"],["for","plataforma"],["id","plataforma","name","plataforma",1,"form-control",3,"ngModel","ngModelChange"],["value","PC"],["value","PS4"],["value","Xbox One"],["for","precio"],["type","number","id","precio","name","precio",1,"form-control",3,"ngModel","ngModelChange"],[2,"display","flex","flex-direction","row","gap","1em"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"table","table-striped"],[4,"ngFor","ngForOf"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"h2"),b(2,"Juegos"),D(),w(3,"div",1)(4,"div",2)(5,"label",3),b(6,"Nombre"),D(),w(7,"input",4),he("ngModelChange",function(a){return s.juego.nombre=a}),D()(),w(8,"div",2)(9,"label",5),b(10,"Descripci\xF3n"),D(),xe(11,"br"),w(12,"textarea",6),he("ngModelChange",function(a){return s.juego.descripcion=a}),D()(),w(13,"div",2)(14,"label",7),b(15,"G\xE9nero"),D(),w(16,"select",8),he("ngModelChange",function(a){return s.juego.genero=a}),w(17,"option",9),b(18,"Accion"),D(),w(19,"option",10),b(20,"Aventura"),D(),w(21,"option",11),b(22,"RPG"),D(),w(23,"option",11),b(24,"Roguelike"),D()()(),w(25,"div",2)(26,"label",12),b(27,"Plataforma"),D(),w(28,"select",13),he("ngModelChange",function(a){return s.juego.plataforma=a}),w(29,"option",14),b(30,"PC"),D(),w(31,"option",15),b(32,"PS4"),D(),w(33,"option",16),b(34,"Xbox One"),D()()(),w(35,"div",2)(36,"label",17),b(37,"Precio"),D(),w(38,"input",18),he("ngModelChange",function(a){return s.juego.precio=a}),D()(),xe(39,"hr"),w(40,"div",19)(41,"button",20),he("click",function(){return s.insertarJuego()}),b(42,"Insertar"),D(),w(43,"button",21),he("click",function(){return s.updateJuego()}),b(44,"Actualizar"),D(),w(45,"button",22),he("click",function(){return s.deleteJuego(s.juego.id)}),b(46,"Eliminar"),D()()()(),xe(47,"hr"),w(48,"div",0)(49,"h2"),b(50,"Juegos"),D(),w(51,"table",23)(52,"thead")(53,"tr")(54,"th"),b(55,"Nombre"),D(),w(56,"th"),b(57,"Descripci\xF3n"),D(),w(58,"th"),b(59,"Plataforma"),D(),w(60,"th"),b(61,"Acciones"),D()()(),w(62,"tbody"),ys(63,G3,10,3,"tr",24),D()()()),i&2&&(Ee(7),tt("ngModel",s.juego.nombre),Ee(5),tt("ngModel",s.juego.descripcion),Ee(4),tt("ngModel",s.juego.genero),Ee(12),tt("ngModel",s.juego.plataforma),Ee(10),tt("ngModel",s.juego.precio),Ee(25),tt("ngForOf",s.juegos))},dependencies:[ia,$g,Hg,Hi,oD,lu,cu,io]});let t=e;return t})();var VO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Yt({type:e,selectors:[["app-about"]],decls:31,vars:0,consts:[[2,"display","flex","flex-direction","row","gap","5em","flex-wrap","wrap"],["src","https://camo.githubusercontent.com/167a36a1ececb8a83921b6cffebdae1fac5c5c42e7cbdf0b0600864724dd895b/68747470733a2f2f632e74656e6f722e636f6d2f6a33635645506a34627a6b41414141432f6361742d747970696e672e676966","alt","GIF de un gato typeando",1,"w-100"],[1,"display-1"],["href","utsjr.edu.mx"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"picture"),xe(2,"img",1),D(),w(3,"div")(4,"h1",2),b(5,"Hola!"),D(),w(6,"h2"),b(7,"Mi nombre es Miguel \xC1ngel Diosdado"),D(),w(8,"p"),b(9," Actualmente tengo 20 a\xF1os, y estudio en la "),w(10,"a",3),b(11,"UTSJR"),D(),b(12," la ingenier\xEDa en desarrollo y gesti\xF3n de software. "),D(),xe(13,"hr"),w(14,"h3"),b(15,"Hobbies"),D(),w(16,"ul")(17,"li"),b(18,"Programar"),D(),w(19,"li"),b(20,"Videojuegos"),D(),w(21,"li"),b(22,"Arte"),D(),w(23,"li"),b(24,"M\xFAsica"),D()(),xe(25,"hr"),w(26,"h3"),b(27,"Contacto"),D(),w(28,"ul")(29,"li"),b(30,"angeldr.ti21@utsjr.edu.mx"),D()()()())}});let t=e;return t})();var uD=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Yt({type:e,selectors:[["app-home"]],decls:9,vars:0,consts:[[1,"list-group"],["routerLink","libros",1,"list-group-item","list-group-item-action"],["routerLink","/clientes",1,"list-group-item","list-group-item-action"],["routerLink","/juegos",1,"list-group-item","list-group-item-action"],["routerLink","/about",1,"list-group-item","list-group-item-action"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"a",1),b(2,"Ejercicio Libros"),D(),w(3,"a",2),b(4,"Ejercicio Clientes"),D(),w(5,"a",3),b(6,"Ejercicio Juegos"),D(),w(7,"a",4),b(8,"Acerca de"),D()())},dependencies:[Vf]});let t=e;return t})();var z3=[{path:"home",component:uD},{path:"libros",component:NO},{path:"clientes",component:kO},{path:"juegos",component:FO},{path:"about",component:VO},{path:"**",component:uD}],LO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e}),e.\u0275inj=Xe({imports:[rw.forRoot(z3),rw]});let t=e;return t})();var jO=(()=>{let e=class e{constructor(){this.title="libros"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Yt({type:e,selectors:[["app-root"]],decls:12,vars:0,consts:[[1,"navbar","navbar-expand-lg"],[1,"container","py-2"],["href","#",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNavAltMarkup","aria-controls","navbarNavAltMarkup","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNavAltMarkup",1,"collapse","navbar-collapse"],[1,"navbar-nav"],["routerLink","/home",1,"nav-link","active"],[1,"container"]],template:function(i,s){i&1&&(w(0,"nav",0)(1,"div",1)(2,"a",2),b(3,"Evaluaci\xF3n 2do Parcial"),D(),w(4,"button",3),xe(5,"span",4),D(),w(6,"div",5)(7,"div",6)(8,"a",7),b(9,"Home"),D()()()()(),w(10,"div",8),xe(11,"router-outlet"),D())},dependencies:[Yv,Vf]});let t=e;return t})();var UO="@firebase/database",BO="1.0.3";var w0="";function E0(t){w0=t}var mD=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Qe(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Pd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var yD=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return fn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var _1=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new mD(e)}}catch{}return new yD},uo=_1("localStorage"),_D=_1("sessionStorage");var pu=new ei("@firebase/database"),v1=function(){let t=1;return function(){return t++}}(),w1=function(t){let e=mT(t),n=new gT;n.update(e);let r=n.digest();return Md.encodeByteArray(r)},vd=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=vd.apply(null,r):typeof r=="object"?e+=Qe(r):e+=r,e+=" "}return e},co=null,$O=!0,E1=function(t,e){S(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(pu.logLevel=pn.VERBOSE,co=pu.log.bind(pu),e&&_D.set("logging_enabled",!0)):typeof t=="function"?co=t:(co=null,_D.remove("logging_enabled"))},yt=function(...t){if($O===!0&&($O=!1,co===null&&_D.get("logging_enabled")===!0&&E1(!0)),co){let e=vd.apply(null,t);co(e)}},wd=function(t){return function(...e){yt(t,...e)}},vD=function(...t){let e="FIREBASE INTERNAL ERROR: "+vd(...t);pu.error(e)},Dr=function(...t){let e=`FIREBASE FATAL ERROR: ${vd(...t)}`;throw pu.error(e),new Error(e)},kt=function(...t){let e="FIREBASE WARNING: "+vd(...t);pu.warn(e)},W3=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&kt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},ym=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},K3=function(t){if(Qn()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Wi="[MIN_NAME]",Zr="[MAX_NAME]",ho=function(t,e){if(t===e)return 0;if(t===Wi||e===Zr)return-1;if(e===Wi||t===Zr)return 1;{let n=HO(t),r=HO(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},Q3=function(t,e){return t===e?0:t<e?-1:1},Yl=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Qe(e))},I0=function(t){if(typeof t!="object"||t===null)return Qe(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Qe(e[r]),n+=":",n+=I0(t[e[r]]);return n+="}",n},I1=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function _t(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var C1=function(t){S(!ym(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,u;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let c=[];for(u=n;u;u-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();let l=c.join(""),d="";for(u=0;u<64;u+=8){let h=parseInt(l.substr(u,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},Y3=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Z3=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function J3(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var X3=new RegExp("^-?(0*)\\d{1,10}$"),e9=-2147483648,t9=2147483647,HO=function(t){if(X3.test(t)){let e=Number(t);if(e>=e9&&e<=t9)return e}return null},Cu=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw kt("Exception was thrown by user callback.",n),e},Math.floor(0))}},n9=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ed=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var wD=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){kt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var ED=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(yt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',kt(e)}},td=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Gg="5",D1="v",T1="s",b1="r",S1="f",A1=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,x1="ls",M1="p",ID="ac",R1="websocket",N1="long_polling";var zg=class{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=uo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&uo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function r9(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function P1(t,e,n){S(typeof e=="string","typeof type must == string"),S(typeof n=="object","typeof params must == object");let r;if(e===R1)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===N1)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);r9(t)&&(n.ns=t.namespace);let i=[];return _t(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var CD=class{constructor(){this.counters_={}}incrementCounter(e,n=1){fn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return uT(this.counters_)}};var cD={},lD={};function C0(t){let e=t.toString();return cD[e]||(cD[e]=new CD),cD[e]}function i9(t,e){let n=t.toString();return lD[n]||(lD[n]=e()),lD[n]}var DD=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Cu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var qO="start",s9="close",o9="pLPCommand",a9="pRTLPCB",k1="id",O1="pw",F1="ser",u9="cb",c9="seg",l9="ts",d9="d",h9="dframe",V1=1870,L1=30,f9=V1-L1,p9=25e3,g9=3e4,sd=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=wd(e),this.stats_=C0(n),this.urlFn=u=>(this.appCheckToken&&(u[ID]=this.appCheckToken),P1(n,N1,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new DD(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(g9)),K3(()=>{if(this.isClosed_)return;this.scriptTagHolder=new TD((...s)=>{let[o,a,u,c,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===qO)this.id=a,this.password=u;else if(o===s9)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[qO]="t",r[F1]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[u9]=this.scriptTagHolder.uniqueCallbackIdentifier),r[D1]=Gg,this.transportSessionId&&(r[T1]=this.transportSessionId),this.lastSessionId&&(r[x1]=this.lastSessionId),this.applicationId&&(r[M1]=this.applicationId),this.appCheckToken&&(r[ID]=this.appCheckToken),typeof location<"u"&&location.hostname&&A1.test(location.hostname)&&(r[b1]=S1);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return Qn()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Y3()&&!Z3()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=Qe(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=aT(n),i=I1(r,f9);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(Qn())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[h9]="t",r[k1]=e,r[O1]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=Qe(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},TD=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Qn())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=v1(),window[o9+this.uniqueCallbackIdentifier]=e,window[a9+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){yt("frame writing exception"),a.stack&&yt(a.stack),yt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||yt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[k1]=this.myID,e[O1]=this.myPW,e[F1]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+L1+r.length<=V1;){let o=this.pendingSegs.shift();r=r+"&"+c9+i+"="+o.seg+"&"+l9+i+"="+o.ts+"&"+d9+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(p9)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){Qn()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{yt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var m9=16384,y9=45e3,Wg=null;typeof MozWebSocket<"u"?Wg=MozWebSocket:typeof WebSocket<"u"&&(Wg=WebSocket);var hu=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=wd(this.connId),this.stats_=C0(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[D1]=Gg,!Qn()&&typeof location<"u"&&location.hostname&&A1.test(location.hostname)&&(a[b1]=S1),r&&(a[T1]=r),i&&(a[x1]=i),s&&(a[ID]=s),o&&(a[M1]=o),P1(n,R1,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,uo.set("previous_websocket_failure",!0);try{let i;if(Qn()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Gg}/${w0}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Wg(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Wg!==null&&!t.forceDisallow_}static previouslyFailed(){return uo.isInMemoryStorage||uo.get("previous_websocket_failure")===!0}markConnectionHealthy(){uo.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Pd(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(S(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=Qe(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=I1(r,m9);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(y9))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),j1=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[sd,hu]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=hu&&hu.isAvailable(),i=r&&!hu.previouslyFailed();if(n.webSocketOnly&&(r||kt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[hu];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),_9=6e4,v9=5e3,w9=10*1024,E9=100*1024,dD="t",GO="d",I9="s",zO="r",C9="e",WO="o",KO="a",QO="n",YO="p",D9="h",bD=class{constructor(e,n,r,i,s,o,a,u,c,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=wd("c:"+this.id+":"),this.transportManager_=new j1(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=ed(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>E9?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>w9?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(dD in e){let n=e[dD];n===KO?this.upgradeIfSecondaryHealthy_():n===zO?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===WO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Yl("t",e),r=Yl("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:YO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:KO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:QO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Yl("t",e),r=Yl("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Yl(dD,e);if(GO in e){let r=e[GO];if(n===D9){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===QO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===I9?this.onConnectionShutdown_(r):n===zO?this.onReset_(r):n===C9?vD("Server Error: "+r):n===WO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):vD("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Gg!==r&&kt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),ed(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(_9))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ed(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(v9))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:YO,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(uo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Kg=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var Qg=class{constructor(e){this.allowedEvents_=e,this.listeners_={},S(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){S(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Yg=class t extends Qg{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Lm()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return S(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var ZO=32,JO=768,we=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function ve(){return new we("")}function re(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ki(t){return t.pieces_.length-t.pieceNum_}function Ae(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new we(t.pieces_,e)}function D0(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function T9(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function od(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function U1(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new we(e,0)}function Ve(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof we)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new we(n,0)}function ie(t){return t.pieceNum_>=t.pieces_.length}function Ht(t,e){let n=re(t),r=re(e);if(n===null)return e;if(n===r)return Ht(Ae(t),Ae(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function b9(t,e){let n=od(t,0),r=od(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=ho(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function T0(t,e){if(Ki(t)!==Ki(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function An(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Ki(t)>Ki(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var SD=class{constructor(e,n){this.errorPrefix_=n,this.parts_=od(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Mu(this.parts_[r]);B1(this)}};function S9(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Mu(e),B1(t)}function A9(t){let e=t.parts_.pop();t.byteLength_-=Mu(e),t.parts_.length>0&&(t.byteLength_-=1)}function B1(t){if(t.byteLength_>JO)throw new Error(t.errorPrefix_+"has a key path longer than "+JO+" bytes ("+t.byteLength_+").");if(t.parts_.length>ZO)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ZO+") or object contains a cycle "+ao(t))}function ao(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var AD=class t extends Qg{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return S(e==="visible","Unknown event type: "+e),[this.visible_]}};var Zl=1e3,x9=60*5*1e3,XO=30*1e3,M9=1.3,R9=3e4,N9="server_kill",e1=3,b0=(()=>{class t extends Kg{constructor(n,r,i,s,o,a,u,c){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=wd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Zl,this.maxReconnectDelay_=x9,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!Qn())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");AD.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Yg.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(Qe(o)),S(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new dt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let u=a.d;a.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),S(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),S(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,u=>{let c=u.d,l=u.s;t.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,c))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&fn(n,"w")){let i=Xr(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();kt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||fT(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=XO)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=hT(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),S(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Qe(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):vD("Unrecognized action received from server: "+Qe(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){S(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Zl,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Zl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>R9&&(this.reconnectDelay_=Zl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*M9)}this.onConnectStatus_(!1)}establishConnection_(){return v(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,u=null,c=function(){u?u.close():(a=!0,i())},l=function(h){S(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(h)};this.realtime_={close:c,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?yt("getToken() completed but was canceled"):(yt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,u=new bD(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{kt(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(N9)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&kt(h),c())}}})}interrupt(n){yt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){yt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],kd(this.interruptReasons_)&&(this.reconnectDelay_=Zl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>I0(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new we(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){yt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=e1&&(this.reconnectDelay_=XO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){yt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=e1&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";Qn()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+w0.replace(/\./g,"-")]=1,Lm()?n["framework.cordova"]=1:cT()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Yg.getInstance().currentlyOnline();return kd(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),ae=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var gu=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new ae(Wi,e),i=new ae(Wi,n);return this.compare(r,i)!==0}minPost(){return ae.MIN}};var qg,Zg=class extends gu{static get __EMPTY_NODE(){return qg}static set __EMPTY_NODE(e){qg=e}compare(e,n){return ho(e.name,n.name)}isDefinedOn(e){throw yo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ae.MIN}maxPost(){return new ae(Zr,qg)}makePost(e,n){return S(typeof e=="string","KeyIndex indexValue must always be a string."),new ae(e,qg)}toString(){return".key"}},Cr=new Zg;var fu=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Wn=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??xn.EMPTY_NODE,this.right=o??xn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return xn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return xn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),xD=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new Wn(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},xn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Wn.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Wn.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new fu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new fu(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new fu(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new fu(this.root_,null,this.comparator_,!0,e)}};xn.EMPTY_NODE=new xD;function P9(t,e){return ho(t.name,e.name)}function S0(t,e){return ho(t,e)}var MD;function k9(t){MD=t}var $1=function(t){return typeof t=="number"?"number:"+C1(t):"string:"+t},H1=function(t){if(t.isLeafNode()){let e=t.val();S(typeof e=="string"||typeof e=="number"||typeof e=="object"&&fn(e,".sv"),"Priority must be a string or number.")}else S(t===MD||t.isEmpty(),"priority of unexpected type.");S(t===MD||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var t1,mu=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,S(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),H1(this.priorityNode_)}static set __childrenNodeConstructor(n){t1=n}static get __childrenNodeConstructor(){return t1}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return ie(n)?this:re(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=re(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(S(i!==".priority"||Ki(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ae(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+$1(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=C1(this.value_):n+=this.value_,this.lazyHash_=w1(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(S(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return S(s>=0,"Unknown leaf type: "+r),S(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),q1,G1;function O9(t){q1=t}function F9(t){G1=t}var RD=class extends gu{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?ho(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ae.MIN}maxPost(){return new ae(Zr,new mu("[PRIORITY-POST]",G1))}makePost(e,n){let r=q1(e);return new ae(n,new mu("[PRIORITY-POST]",r))}toString(){return".priority"}},Re=new RD;var V9=Math.log(2),ND=class{constructor(e){let n=s=>parseInt(Math.log(s)/V9,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Jg=function(t,e,n,r){t.sort(e);let i=function(u,c){let l=c-u,d,h;if(l===0)return null;if(l===1)return d=t[u],h=n?n(d):d,new Wn(h,d.node,Wn.BLACK,null,null);{let f=parseInt(l/2,10)+u,p=i(u,f),g=i(f+1,c);return d=t[f],h=n?n(d):d,new Wn(h,d.node,Wn.BLACK,p,g)}},s=function(u){let c=null,l=null,d=t.length,h=function(p,g){let _=d-p,T=d;d-=p;let P=i(_+1,T),A=t[_],H=n?n(A):A;f(new Wn(H,A.node,g,null,P))},f=function(p){c?(c.left=p,c=p):(l=p,c=p)};for(let p=0;p<u.count;++p){let g=u.nextBitIsOne(),_=Math.pow(2,u.count-(p+1));g?h(_,Wn.BLACK):(h(_,Wn.BLACK),h(_,Wn.RED))}return l},o=new ND(t.length),a=s(o);return new xn(r||e,a)};var hD,du={},yu=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return S(du&&Re,"ChildrenNode.ts has not been loaded"),hD=hD||new t({".priority":du},{".priority":Re}),hD}get(e){let n=Xr(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof xn?n:null}hasIndex(e){return fn(this.indexSet_,e.toString())}addIndex(e,n){S(e!==Cr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(ae.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Jg(r,e.getCompare()):a=du;let u=e.toString(),c=Object.assign({},this.indexSet_);c[u]=e;let l=Object.assign({},this.indexes_);return l[u]=a,new t(l,c)}addToIndexes(e,n){let r=xu(this.indexes_,(i,s)=>{let o=Xr(this.indexSet_,s);if(S(o,"Missing index implementation for "+s),i===du)if(o.isDefinedOn(e.node)){let a=[],u=n.getIterator(ae.Wrap),c=u.getNext();for(;c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),Jg(a,o.getCompare())}else return du;else{let a=n.get(e.name),u=i;return a&&(u=u.remove(new ae(e.name,a))),u.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=xu(this.indexes_,i=>{if(i===du)return i;{let s=n.get(e.name);return s?i.remove(new ae(e.name,s)):i}});return new t(r,this.indexSet_)}};var Jl,J=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&H1(this.priorityNode_),this.children_.isEmpty()&&S(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Jl||(Jl=new t(new xn(S0),null,yu.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Jl}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Jl:r}}getChild(n){let r=re(n);return r===null?this:this.getImmediateChild(r).getChild(Ae(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(S(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new ae(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Jl:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=re(n);if(i===null)return r;{S(re(n)!==".priority"||Ki(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ae(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Re,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let u in r)a[u]=r[u];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+$1(this.getPriority().val())+":"),this.forEachChild(Re,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":w1(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ae(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new ae(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new ae(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,ae.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,ae.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Ed?-1:0}withIndex(n){if(n===Cr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Cr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Re),s=r.getIterator(Re),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Cr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),PD=class extends J{constructor(){super(new xn(S0),J.EMPTY_NODE,yu.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return J.EMPTY_NODE}isEmpty(){return!1}},Ed=new PD;Object.defineProperties(ae,{MIN:{value:new ae(Wi,J.EMPTY_NODE)},MAX:{value:new ae(Zr,Ed)}});Zg.__EMPTY_NODE=J.EMPTY_NODE;mu.__childrenNodeConstructor=J;k9(Ed);F9(Ed);var L9=!0;function Ue(t,e=null){if(t===null)return J.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),S(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new mu(n,Ue(e))}if(!(t instanceof Array)&&L9){let n=[],r=!1;if(_t(t,(o,a)=>{if(o.substring(0,1)!=="."){let u=Ue(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new ae(o,u)))}}),n.length===0)return J.EMPTY_NODE;let s=Jg(n,P9,o=>o.name,S0);if(r){let o=Jg(n,Re.getCompare());return new J(s,Ue(e),new yu({".priority":o},{".priority":Re}))}else return new J(s,Ue(e),yu.Default)}else{let n=J.EMPTY_NODE;return _t(t,(r,i)=>{if(fn(t,r)&&r.substring(0,1)!=="."){let s=Ue(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Ue(e))}}O9(Ue);var ad=class extends gu{constructor(e){super(),this.indexPath_=e,S(!ie(e)&&re(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?ho(e.name,n.name):s}makePost(e,n){let r=Ue(e),i=J.EMPTY_NODE.updateChild(this.indexPath_,r);return new ae(n,i)}maxPost(){let e=J.EMPTY_NODE.updateChild(this.indexPath_,Ed);return new ae(Zr,e)}toString(){return od(this.indexPath_,0).join("/")}};var kD=class extends gu{compare(e,n){let r=e.node.compareTo(n.node);return r===0?ho(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ae.MIN}maxPost(){return ae.MAX}makePost(e,n){let r=Ue(e);return new ae(n,r)}toString(){return".value"}},A0=new kD;function z1(t){return{type:"value",snapshotNode:t}}function _u(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function ud(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function cd(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function j9(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var ld=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){S(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(ud(n,a)):S(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(_u(n,r)):o.trackChildChange(cd(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Re,(i,s)=>{n.hasChild(i)||r.trackChildChange(ud(i,s))}),n.isLeafNode()||n.forEachChild(Re,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(cd(i,s,o))}else r.trackChildChange(_u(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?J.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Xg=class t{constructor(e){this.indexedFilter_=new ld(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new ae(n,r))||(r=J.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=J.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(J.EMPTY_NODE);let s=this;return n.forEachChild(Re,(o,a)=>{s.matches(new ae(o,a))||(i=i.updateImmediateChild(o,J.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var OD=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Xg(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ae(n,r))||(r=J.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=J.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=J.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(J.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,J.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;S(a.numChildren()===this.limit_,"");let u=new ae(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,u);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(cd(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(ud(n,d));let g=a.updateImmediateChild(n,J.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(_u(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:l&&o(c,u)>=0?(s!=null&&(s.trackChildChange(ud(c.name,c.node)),s.trackChildChange(_u(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,J.EMPTY_NODE)):e}};var dd=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Re}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return S(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return S(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Wi}hasEnd(){return this.endSet_}getIndexEndValue(){return S(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return S(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Zr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return S(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Re}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function U9(t){return t.loadsAllData()?new ld(t.getIndex()):t.hasLimit()?new OD(t):new Xg(t)}function B9(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function $9(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function FD(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function H9(t,e,n){let r;return t.index_===Cr||n?r=FD(t,e,n):r=FD(t,e,Zr),r.startAfterSet_=!0,r}function VD(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function q9(t,e,n){let r;return t.index_===Cr||n?r=VD(t,e,n):r=VD(t,e,Wi),r.endBeforeSet_=!0,r}function _m(t,e){let n=t.copy();return n.index_=e,n}function n1(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Re?n="$priority":t.index_===A0?n="$value":t.index_===Cr?n="$key":(S(t.index_ instanceof ad,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Qe(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=Qe(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Qe(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Qe(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Qe(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function r1(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Re&&(e.i=t.index_.toString()),e}var LD=class t extends Kg{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=wd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(S(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let u=n1(e._queryParams);this.restRequest_(s+".json",u,(c,l)=>{let d=l;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,r),Xr(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=n1(e._queryParams),r=e._path.toString(),i=new dt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+pT(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=Pd(a.responseText)}catch{kt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&kt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var jD=class{constructor(){this.rootNode_=J.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function em(){return{value:null,children:new Map}}function Du(t,e,n){if(ie(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=re(e);t.children.has(r)||t.children.set(r,em());let i=t.children.get(r);e=Ae(e),Du(i,e,n)}}function UD(t,e){if(ie(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Re,(r,i)=>{Du(t,new we(r),i)}),UD(t,e)}}else if(t.children.size>0){let n=re(e);return e=Ae(e),t.children.has(n)&&UD(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function BD(t,e,n){t.value!==null?n(e,t.value):G9(t,(r,i)=>{let s=new we(e.toString()+"/"+r);BD(i,s,n)})}function G9(t,e){t.children.forEach((n,r)=>{e(r,n)})}var $D=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&_t(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var i1=10*1e3,z9=30*1e3,W9=5*60*1e3,HD=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new $D(e);let r=i1+(z9-i1)*Math.random();ed(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;_t(e,(i,s)=>{s>0&&fn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),ed(this.reportStats_.bind(this),Math.floor(Math.random()*2*W9))}};var Ir=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Ir||{});function x0(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function M0(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function R0(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var qD=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Ir.ACK_USER_WRITE,this.source=x0()}operationForChild(e){if(ie(this.path)){if(this.affectedTree.value!=null)return S(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new we(e));return new t(ve(),n,this.revert)}}else return S(re(this.path)===e,"operationForChild called for unrelated child."),new t(Ae(this.path),this.affectedTree,this.revert)}};var tm=class t{constructor(e,n){this.source=e,this.path=n,this.type=Ir.LISTEN_COMPLETE}operationForChild(e){return ie(this.path)?new t(this.source,ve()):new t(this.source,Ae(this.path))}};var vu=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Ir.OVERWRITE}operationForChild(e){return ie(this.path)?new t(this.source,ve(),this.snap.getImmediateChild(e)):new t(this.source,Ae(this.path),this.snap)}};var hd=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Ir.MERGE}operationForChild(e){if(ie(this.path)){let n=this.children.subtree(new we(e));return n.isEmpty()?null:n.value?new vu(this.source,ve(),n.value):new t(this.source,ve(),n)}else return S(re(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Ae(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Tr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ie(e))return this.isFullyInitialized()&&!this.filtered_;let n=re(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var GD=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function K9(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(j9(o.childName,o.snapshotNode))}),Xl(t,i,"child_removed",e,r,n),Xl(t,i,"child_added",e,r,n),Xl(t,i,"child_moved",s,r,n),Xl(t,i,"child_changed",e,r,n),Xl(t,i,"value",e,r,n),i}function Xl(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,u)=>Y9(t,a,u)),o.forEach(a=>{let u=Q9(t,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(u,t.query_))})})}function Q9(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function Y9(t,e,n){if(e.childName==null||n.childName==null)throw yo("Should only compare child_ events.");let r=new ae(e.childName,e.snapshotNode),i=new ae(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function vm(t,e){return{eventCache:t,serverCache:e}}function nd(t,e,n,r){return vm(new Tr(e,n,r),t.serverCache)}function W1(t,e,n,r){return vm(t.eventCache,new Tr(e,n,r))}function nm(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function lo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var fD,Z9=()=>(fD||(fD=new xn(Q3)),fD),qt=class t{constructor(e,n=Z9()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return _t(e,(r,i)=>{n=n.set(new we(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ve(),value:this.value};if(ie(e))return null;{let r=re(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ae(e),n);return s!=null?{path:Ve(new we(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ie(e))return this;{let n=re(e),r=this.children.get(n);return r!==null?r.subtree(Ae(e)):new t(null)}}set(e,n){if(ie(e))return new t(n,this.children);{let r=re(e),s=(this.children.get(r)||new t(null)).set(Ae(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(ie(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=re(e),r=this.children.get(n);if(r){let i=r.remove(Ae(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(ie(e))return this.value;{let n=re(e),r=this.children.get(n);return r?r.get(Ae(e)):null}}setTree(e,n){if(ie(e))return n;{let r=re(e),s=(this.children.get(r)||new t(null)).setTree(Ae(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(ve(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Ve(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ve(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(ie(e))return null;{let s=re(e),o=this.children.get(s);return o?o.findOnPath_(Ae(e),Ve(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ve(),n)}foreachOnPath_(e,n,r){if(ie(e))return this;{this.value&&r(n,this.value);let i=re(e),s=this.children.get(i);return s?s.foreachOnPath_(Ae(e),Ve(n,i),r):new t(null)}}foreach(e){this.foreach_(ve(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Ve(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var Kn=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new qt(null))}};function rd(t,e,n){if(ie(e))return new Kn(new qt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Ht(i,e);return s=s.updateChild(o,n),new Kn(t.writeTree_.set(i,s))}else{let i=new qt(n),s=t.writeTree_.setTree(e,i);return new Kn(s)}}}function zD(t,e,n){let r=t;return _t(n,(i,s)=>{r=rd(r,Ve(e,i),s)}),r}function s1(t,e){if(ie(e))return Kn.empty();{let n=t.writeTree_.setTree(e,new qt(null));return new Kn(n)}}function WD(t,e){return fo(t,e)!=null}function fo(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Ht(n.path,e)):null}function o1(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Re,(r,i)=>{e.push(new ae(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ae(r,i.value))}),e}function Gi(t,e){if(ie(e))return t;{let n=fo(t,e);return n!=null?new Kn(new qt(n)):new Kn(t.writeTree_.subtree(e))}}function KD(t){return t.writeTree_.isEmpty()}function wu(t,e){return K1(ve(),t.writeTree_,e)}function K1(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(S(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=K1(Ve(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Ve(t,".priority"),r)),n}}function wm(t,e){return J1(e,t)}function J9(t,e,n,r,i){S(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=rd(t.visibleWrites,e,n)),t.lastWriteId=r}function X9(t,e,n,r){S(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=zD(t.visibleWrites,e,n),t.lastWriteId=r}function eW(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function tW(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);S(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&nW(a,r.path)?i=!1:An(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return rW(t),!0;if(r.snap)t.visibleWrites=s1(t.visibleWrites,r.path);else{let a=r.children;_t(a,u=>{t.visibleWrites=s1(t.visibleWrites,Ve(r.path,u))})}return!0}else return!1}function nW(t,e){if(t.snap)return An(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&An(Ve(t.path,n),e))return!0;return!1}function rW(t){t.visibleWrites=Q1(t.allWrites,iW,ve()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function iW(t){return t.visible}function Q1(t,e,n){let r=Kn.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)An(n,o)?(a=Ht(n,o),r=rd(r,a,s.snap)):An(o,n)&&(a=Ht(o,n),r=rd(r,ve(),s.snap.getChild(a)));else if(s.children){if(An(n,o))a=Ht(n,o),r=zD(r,a,s.children);else if(An(o,n))if(a=Ht(o,n),ie(a))r=zD(r,ve(),s.children);else{let u=Xr(s.children,re(a));if(u){let c=u.getChild(Ae(a));r=rd(r,ve(),c)}}}else throw yo("WriteRecord should have .snap or .children")}}return r}function Y1(t,e,n,r,i){if(!r&&!i){let s=fo(t.visibleWrites,e);if(s!=null)return s;{let o=Gi(t.visibleWrites,e);if(KD(o))return n;if(n==null&&!WD(o,ve()))return null;{let a=n||J.EMPTY_NODE;return wu(o,a)}}}else{let s=Gi(t.visibleWrites,e);if(!i&&KD(s))return n;if(!i&&n==null&&!WD(s,ve()))return null;{let o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(An(c.path,e)||An(e,c.path))},a=Q1(t.allWrites,o,e),u=n||J.EMPTY_NODE;return wu(a,u)}}}function sW(t,e,n){let r=J.EMPTY_NODE,i=fo(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Re,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=Gi(t.visibleWrites,e);return n.forEachChild(Re,(o,a)=>{let u=wu(Gi(s,new we(o)),a);r=r.updateImmediateChild(o,u)}),o1(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Gi(t.visibleWrites,e);return o1(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function oW(t,e,n,r,i){S(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Ve(e,n);if(WD(t.visibleWrites,s))return null;{let o=Gi(t.visibleWrites,s);return KD(o)?i.getChild(n):wu(o,i.getChild(n))}}function aW(t,e,n,r){let i=Ve(e,n),s=fo(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=Gi(t.visibleWrites,i);return wu(o,r.getNode().getImmediateChild(n))}else return null}function uW(t,e){return fo(t.visibleWrites,e)}function cW(t,e,n,r,i,s,o){let a,u=Gi(t.visibleWrites,e),c=fo(u,ve());if(c!=null)a=c;else if(n!=null)a=wu(u,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function lW(){return{visibleWrites:Kn.empty(),allWrites:[],lastWriteId:-1}}function rm(t,e,n,r){return Y1(t.writeTree,t.treePath,e,n,r)}function N0(t,e){return sW(t.writeTree,t.treePath,e)}function a1(t,e,n,r){return oW(t.writeTree,t.treePath,e,n,r)}function im(t,e){return uW(t.writeTree,Ve(t.treePath,e))}function dW(t,e,n,r,i,s){return cW(t.writeTree,t.treePath,e,n,r,i,s)}function P0(t,e,n){return aW(t.writeTree,t.treePath,e,n)}function Z1(t,e){return J1(Ve(t.treePath,e),t.writeTree)}function J1(t,e){return{treePath:t,writeTree:e}}var QD=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;S(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),S(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,cd(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,ud(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,_u(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,cd(r,e.snapshotNode,i.oldSnap));else throw yo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var YD=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},X1=new YD,fd=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Tr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return P0(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:lo(this.viewCache_),s=dW(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function hW(t){return{filter:t}}function fW(t,e){S(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),S(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function pW(t,e,n,r,i){let s=new QD,o,a;if(n.type===Ir.OVERWRITE){let c=n;c.source.fromUser?o=ZD(t,e,c.path,c.snap,r,i,s):(S(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!ie(c.path),o=sm(t,e,c.path,c.snap,r,i,a,s))}else if(n.type===Ir.MERGE){let c=n;c.source.fromUser?o=mW(t,e,c.path,c.children,r,i,s):(S(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=JD(t,e,c.path,c.children,r,i,a,s))}else if(n.type===Ir.ACK_USER_WRITE){let c=n;c.revert?o=vW(t,e,c.path,r,i,s):o=yW(t,e,c.path,c.affectedTree,r,i,s)}else if(n.type===Ir.LISTEN_COMPLETE)o=_W(t,e,n.path,r,s);else throw yo("Unknown operation type: "+n.type);let u=s.getChanges();return gW(e,o,u),{viewCache:o,changes:u}}function gW(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=nm(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(z1(nm(e)))}}function eF(t,e,n,r,i,s){let o=e.eventCache;if(im(r,n)!=null)return e;{let a,u;if(ie(n))if(S(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=lo(e),l=c instanceof J?c:J.EMPTY_NODE,d=N0(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=rm(r,lo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=re(n);if(c===".priority"){S(Ki(n)===1,"Can't have a priority with additional path components");let l=o.getNode();u=e.serverCache.getNode();let d=a1(r,n,l,u);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=Ae(n),d;if(o.isCompleteForChild(c)){u=e.serverCache.getNode();let h=a1(r,n,o.getNode(),u);h!=null?d=o.getNode().getImmediateChild(c).updateChild(l,h):d=o.getNode().getImmediateChild(c)}else d=P0(r,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,l,i,s):a=o.getNode()}}return nd(e,a,o.isFullyInitialized()||ie(n),t.filter.filtersNodes())}}function sm(t,e,n,r,i,s,o,a){let u=e.serverCache,c,l=o?t.filter:t.filter.getIndexedFilter();if(ie(n))c=l.updateFullNode(u.getNode(),r,null);else if(l.filtersNodes()&&!u.isFiltered()){let f=u.getNode().updateChild(n,r);c=l.updateFullNode(u.getNode(),f,null)}else{let f=re(n);if(!u.isCompleteForPath(n)&&Ki(n)>1)return e;let p=Ae(n),_=u.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?c=l.updatePriority(u.getNode(),_):c=l.updateChild(u.getNode(),f,_,p,X1,null)}let d=W1(e,c,u.isFullyInitialized()||ie(n),l.filtersNodes()),h=new fd(i,d,s);return eF(t,d,n,i,h,a)}function ZD(t,e,n,r,i,s,o){let a=e.eventCache,u,c,l=new fd(i,e,s);if(ie(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=nd(e,c,!0,t.filter.filtersNodes());else{let d=re(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),u=nd(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=Ae(n),f=a.getNode().getImmediateChild(d),p;if(ie(h))p=r;else{let g=l.getCompleteChild(d);g!=null?D0(h)===".priority"&&g.getChild(U1(h)).isEmpty()?p=g:p=g.updateChild(h,r):p=J.EMPTY_NODE}if(f.equals(p))u=e;else{let g=t.filter.updateChild(a.getNode(),d,p,h,l,o);u=nd(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function u1(t,e){return t.eventCache.isCompleteForChild(e)}function mW(t,e,n,r,i,s,o){let a=e;return r.foreach((u,c)=>{let l=Ve(n,u);u1(e,re(l))&&(a=ZD(t,a,l,c,i,s,o))}),r.foreach((u,c)=>{let l=Ve(n,u);u1(e,re(l))||(a=ZD(t,a,l,c,i,s,o))}),a}function c1(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function JD(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,c;ie(n)?c=r:c=new qt(null).setTree(n,r);let l=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=c1(t,f,h);u=sm(t,u,new we(d),p,i,s,o,a)}}),c.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),g=c1(t,p,h);u=sm(t,u,new we(d),g,i,s,o,a)}}),u}function yW(t,e,n,r,i,s,o){if(im(i,n)!=null)return e;let a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(ie(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return sm(t,e,n,u.getNode().getChild(n),i,s,a,o);if(ie(n)){let c=new qt(null);return u.getNode().forEachChild(Cr,(l,d)=>{c=c.set(new we(l),d)}),JD(t,e,n,c,i,s,a,o)}else return e}else{let c=new qt(null);return r.foreach((l,d)=>{let h=Ve(n,l);u.isCompleteForPath(h)&&(c=c.set(l,u.getNode().getChild(h)))}),JD(t,e,n,c,i,s,a,o)}}function _W(t,e,n,r,i){let s=e.serverCache,o=W1(e,s.getNode(),s.isFullyInitialized()||ie(n),s.isFiltered());return eF(t,o,n,r,X1,i)}function vW(t,e,n,r,i,s){let o;if(im(r,n)!=null)return e;{let a=new fd(r,e,i),u=e.eventCache.getNode(),c;if(ie(n)||re(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=rm(r,lo(e));else{let d=e.serverCache.getNode();S(d instanceof J,"serverChildren would be complete if leaf node"),l=N0(r,d)}l=l,c=t.filter.updateFullNode(u,l,s)}else{let l=re(n),d=P0(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=u.getImmediateChild(l)),d!=null?c=t.filter.updateChild(u,l,d,Ae(n),a,s):e.eventCache.getNode().hasChild(l)?c=t.filter.updateChild(u,l,J.EMPTY_NODE,Ae(n),a,s):c=u,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=rm(r,lo(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||im(r,ve())!=null,nd(e,c,o,t.filter.filtersNodes())}}var XD=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new ld(r.getIndex()),s=U9(r);this.processor_=hW(s);let o=n.serverCache,a=n.eventCache,u=i.updateFullNode(J.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(J.EMPTY_NODE,a.getNode(),null),l=new Tr(u,o.isFullyInitialized(),i.filtersNodes()),d=new Tr(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=vm(d,l),this.eventGenerator_=new GD(this.query_)}get query(){return this.query_}};function wW(t){return t.viewCache_.serverCache.getNode()}function EW(t){return nm(t.viewCache_)}function IW(t,e){let n=lo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ie(e)&&!n.getImmediateChild(re(e)).isEmpty())?n.getChild(e):null}function l1(t){return t.eventRegistrations_.length===0}function CW(t,e){t.eventRegistrations_.push(e)}function d1(t,e,n){let r=[];if(n){S(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function h1(t,e,n,r){e.type===Ir.MERGE&&e.source.queryId!==null&&(S(lo(t.viewCache_),"We should always have a full cache before handling merges"),S(nm(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=pW(t.processor_,i,e,n,r);return fW(t.processor_,s.viewCache),S(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,tF(t,s.changes,s.viewCache.eventCache.getNode(),null)}function DW(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Re,(s,o)=>{r.push(_u(s,o))}),n.isFullyInitialized()&&r.push(z1(n.getNode())),tF(t,r,n.getNode(),e)}function tF(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return K9(t.eventGenerator_,e,n,i)}var om,am=class{constructor(){this.views=new Map}};function TW(t){S(!om,"__referenceConstructor has already been defined"),om=t}function bW(){return S(om,"Reference.ts has not been loaded"),om}function SW(t){return t.views.size===0}function k0(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return S(s!=null,"SyncTree gave us an op for an invalid query."),h1(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(h1(o,e,n,r));return s}}function nF(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=rm(n,i?r:null),u=!1;a?u=!0:r instanceof J?(a=N0(n,r),u=!1):(a=J.EMPTY_NODE,u=!1);let c=vm(new Tr(a,u,!1),new Tr(r,i,!1));return new XD(e,c)}return o}function AW(t,e,n,r,i,s){let o=nF(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),CW(o,n),DW(o,n)}function xW(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=Qi(t);if(i==="default")for(let[u,c]of t.views.entries())o=o.concat(d1(c,n,r)),l1(c)&&(t.views.delete(u),c.query._queryParams.loadsAllData()||s.push(c.query));else{let u=t.views.get(i);u&&(o=o.concat(d1(u,n,r)),l1(u)&&(t.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!Qi(t)&&s.push(new(bW())(e._repo,e._path)),{removed:s,events:o}}function rF(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function zi(t,e){let n=null;for(let r of t.views.values())n=n||IW(r,e);return n}function iF(t,e){if(e._queryParams.loadsAllData())return Em(t);{let r=e._queryIdentifier;return t.views.get(r)}}function sF(t,e){return iF(t,e)!=null}function Qi(t){return Em(t)!=null}function Em(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var um;function MW(t){S(!um,"__referenceConstructor has already been defined"),um=t}function RW(){return S(um,"Reference.ts has not been loaded"),um}var NW=1,cm=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new qt(null),this.pendingWriteTree_=lW(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function O0(t,e,n,r,i){return J9(t.pendingWriteTree_,e,n,r,i),i?Tu(t,new vu(x0(),e,n)):[]}function PW(t,e,n,r){X9(t.pendingWriteTree_,e,n,r);let i=qt.fromObject(n);return Tu(t,new hd(x0(),e,i))}function qi(t,e,n=!1){let r=eW(t.pendingWriteTree_,e);if(tW(t.pendingWriteTree_,e)){let s=new qt(null);return r.snap!=null?s=s.set(ve(),!0):_t(r.children,o=>{s=s.set(new we(o),!0)}),Tu(t,new qD(r.path,s,n))}else return[]}function Id(t,e,n){return Tu(t,new vu(M0(),e,n))}function kW(t,e,n){let r=qt.fromObject(n);return Tu(t,new hd(M0(),e,r))}function OW(t,e){return Tu(t,new tm(M0(),e))}function FW(t,e,n){let r=F0(t,n);if(r){let i=V0(r),s=i.path,o=i.queryId,a=Ht(s,e),u=new tm(R0(o),a);return L0(t,s,u)}else return[]}function lm(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||sF(o,e))){let u=xW(o,e,n,r);SW(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=u.removed;if(a=u.events,!i){let l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>Qi(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=jW(h);for(let p=0;p<f.length;++p){let g=f[p],_=g.query,T=cF(t,g);t.listenProvider_.startListening(id(_),pd(t,_),T.hashFn,T.onComplete)}}}!d&&c.length>0&&!r&&(l?t.listenProvider_.stopListening(id(e),null):c.forEach(h=>{let f=t.queryToTagMap.get(Cm(h));t.listenProvider_.stopListening(id(h),f)}))}UW(t,c)}return a}function oF(t,e,n,r){let i=F0(t,r);if(i!=null){let s=V0(i),o=s.path,a=s.queryId,u=Ht(o,e),c=new vu(R0(a),u,n);return L0(t,o,c)}else return[]}function VW(t,e,n,r){let i=F0(t,r);if(i){let s=V0(i),o=s.path,a=s.queryId,u=Ht(o,e),c=qt.fromObject(n),l=new hd(R0(a),u,c);return L0(t,o,l)}else return[]}function e0(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=Ht(h,i);s=s||zi(f,p),o=o||Qi(f)});let a=t.syncPointTree_.get(i);a?(o=o||Qi(a),s=s||zi(a,ve())):(a=new am,t.syncPointTree_=t.syncPointTree_.set(i,a));let u;s!=null?u=!0:(u=!1,s=J.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let g=zi(p,ve());g&&(s=s.updateImmediateChild(f,g))}));let c=sF(a,e);if(!c&&!e._queryParams.loadsAllData()){let h=Cm(e);S(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=BW();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=wm(t.pendingWriteTree_,i),d=AW(a,e,n,l,s,u);if(!c&&!o&&!r){let h=iF(a,e);d=d.concat($W(t,e,h))}return d}function Im(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let u=Ht(o,e),c=zi(a,u);if(c)return c});return Y1(i,e,s,n,!0)}function LW(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(c,l)=>{let d=Ht(c,n);r=r||zi(l,d)});let i=t.syncPointTree_.get(n);i?r=r||zi(i,ve()):(i=new am,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new Tr(r,!0,!1):null,a=wm(t.pendingWriteTree_,e._path),u=nF(i,e,a,s?o.getNode():J.EMPTY_NODE,s);return EW(u)}function Tu(t,e){return aF(e,t.syncPointTree_,null,wm(t.pendingWriteTree_,ve()))}function aF(t,e,n,r){if(ie(t.path))return uF(t,e,n,r);{let i=e.get(ve());n==null&&i!=null&&(n=zi(i,ve()));let s=[],o=re(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){let c=n?n.getImmediateChild(o):null,l=Z1(r,o);s=s.concat(aF(a,u,c,l))}return i&&(s=s.concat(k0(i,t,r,n))),s}}function uF(t,e,n,r){let i=e.get(ve());n==null&&i!=null&&(n=zi(i,ve()));let s=[];return e.children.inorderTraversal((o,a)=>{let u=n?n.getImmediateChild(o):null,c=Z1(r,o),l=t.operationForChild(o);l&&(s=s.concat(uF(l,a,u,c)))}),i&&(s=s.concat(k0(i,t,r,n))),s}function cF(t,e){let n=e.query,r=pd(t,n);return{hashFn:()=>(wW(e)||J.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?FW(t,n._path,r):OW(t,n._path);{let s=J3(i,n);return lm(t,n,null,s)}}}}function pd(t,e){let n=Cm(e);return t.queryToTagMap.get(n)}function Cm(t){return t._path.toString()+"$"+t._queryIdentifier}function F0(t,e){return t.tagToQueryMap.get(e)}function V0(t){let e=t.indexOf("$");return S(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new we(t.substr(0,e))}}function L0(t,e,n){let r=t.syncPointTree_.get(e);S(r,"Missing sync point for query tag that we're tracking");let i=wm(t.pendingWriteTree_,e);return k0(r,n,i,null)}function jW(t){return t.fold((e,n,r)=>{if(n&&Qi(n))return[Em(n)];{let i=[];return n&&(i=rF(n)),_t(r,(s,o)=>{i=i.concat(o)}),i}})}function id(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(RW())(t._repo,t._path):t}function UW(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=Cm(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function BW(){return NW++}function $W(t,e,n){let r=e._path,i=pd(t,e),s=cF(t,n),o=t.listenProvider_.startListening(id(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)S(!Qi(a.value),"If we're adding a query, it shouldn't be shadowed");else{let u=a.fold((c,l,d)=>{if(!ie(c)&&l&&Qi(l))return[Em(l).query];{let h=[];return l&&(h=h.concat(rF(l).map(f=>f.query))),_t(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<u.length;++c){let l=u[c];t.listenProvider_.stopListening(id(l),pd(t,l))}}return o}var t0=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},n0=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Ve(this.path_,e);return new t(this.syncTree_,n)}node(){return Im(this.syncTree_,this.path_)}},HW=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},f1=function(t,e,n){if(!t||typeof t!="object")return t;if(S(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return qW(t[".sv"],e,n);if(typeof t[".sv"]=="object")return GW(t[".sv"],e);S(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},qW=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:S(!1,"Unexpected server value: "+t)}},GW=function(t,e,n){t.hasOwnProperty("increment")||S(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&S(!1,"Unexpected increment value: "+r);let i=e.node();if(S(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},lF=function(t,e,n,r){return U0(e,new n0(n,t),r)},j0=function(t,e,n){return U0(t,new t0(e),n)};function U0(t,e,n){let r=t.getPriority().val(),i=f1(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=f1(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new mu(a,Ue(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new mu(i))),o.forEachChild(Re,(a,u)=>{let c=U0(u,e.getImmediateChild(a),n);c!==u&&(s=s.updateImmediateChild(a,c))}),s}}var gd=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function Dm(t,e){let n=e instanceof we?e:new we(e),r=t,i=re(n);for(;i!==null;){let s=Xr(r.node.children,i)||{children:{},childCount:0};r=new gd(i,r,s),n=Ae(n),i=re(n)}return r}function po(t){return t.node.value}function B0(t,e){t.node.value=e,r0(t)}function dF(t){return t.node.childCount>0}function zW(t){return po(t)===void 0&&!dF(t)}function Tm(t,e){_t(t.node.children,(n,r)=>{e(new gd(n,t,r))})}function hF(t,e,n,r){n&&!r&&e(t),Tm(t,i=>{hF(i,e,!0,r)}),n&&r&&e(t)}function WW(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Cd(t){return new we(t.parent===null?t.name:Cd(t.parent)+"/"+t.name)}function r0(t){t.parent!==null&&KW(t.parent,t.name,t)}function KW(t,e,n){let r=zW(n),i=fn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,r0(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,r0(t))}var QW=/[\[\].#$\/\u0000-\u001F\u007F]/,YW=/[\[\].#$\u0000-\u001F\u007F]/,pD=10*1024*1024,bm=function(t){return typeof t=="string"&&t.length!==0&&!QW.test(t)},fF=function(t){return typeof t=="string"&&t.length!==0&&!YW.test(t)},ZW=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),fF(t)},md=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!ym(t)||t&&typeof t=="object"&&fn(t,".sv")},br=function(t,e,n,r){r&&e===void 0||Dd(zt(t,"value"),e,n)},Dd=function(t,e,n){let r=n instanceof we?new SD(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+ao(r));if(typeof e=="function")throw new Error(t+"contains a function "+ao(r)+" with contents = "+e.toString());if(ym(e))throw new Error(t+"contains "+e.toString()+" "+ao(r));if(typeof e=="string"&&e.length>pD/3&&Mu(e)>pD)throw new Error(t+"contains a string greater than "+pD+" utf8 bytes "+ao(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(_t(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!bm(o)))throw new Error(t+" contains an invalid key ("+o+") "+ao(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);S9(r,o),Dd(t,a,r),A9(r)}),i&&s)throw new Error(t+' contains ".value" child '+ao(r)+" in addition to actual children.")}},JW=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=od(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!bm(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(b9);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&An(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},pF=function(t,e,n,r){if(r&&e===void 0)return;let i=zt(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];_t(e,(o,a)=>{let u=new we(o);if(Dd(i,a,Ve(n,u)),D0(u)===".priority"&&!md(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),JW(i,s)},$0=function(t,e,n){if(!(n&&e===void 0)){if(ym(e))throw new Error(zt(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!md(e))throw new Error(zt(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Td=function(t,e,n,r){if(!(r&&n===void 0)&&!bm(n))throw new Error(zt(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},bu=function(t,e,n,r){if(!(r&&n===void 0)&&!fF(n))throw new Error(zt(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},XW=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),bu(t,e,n,r)},un=function(t,e){if(re(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},gF=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!bm(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!ZW(n))throw new Error(zt(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var i0=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Sm(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!T0(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function mF(t,e,n){Sm(t,n),yF(t,r=>T0(r,e))}function cn(t,e,n){Sm(t,n),yF(t,r=>An(r,e)||An(e,r))}function yF(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(e6(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function e6(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();co&&yt("event: "+n.toString()),Cu(r)}}}var _F="repo_interrupt",t6=25,s0=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new i0,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=em(),this.transactionQueueTree_=new gd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function n6(t,e,n){if(t.stats_=C0(t.repoInfo_),t.forceRestClient_||n9())t.server_=new LD(t.repoInfo_,(r,i,s,o)=>{p1(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>g1(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Qe(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new b0(t.repoInfo_,e,(r,i,s,o)=>{p1(t,r,i,s,o)},r=>{g1(t,r)},r=>{r6(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=i9(t.repoInfo_,()=>new HD(t.stats_,t.server_)),t.infoData_=new jD,t.infoSyncTree_=new cm({startListening:(r,i,s,o)=>{let a=[],u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=Id(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),H0(t,"connected",!1),t.serverSyncTree_=new cm({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{let c=o(a,u);cn(t.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function vF(t){let n=t.infoData_.getNode(new we(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function bd(t){return HW({timestamp:vF(t)})}function p1(t,e,n,r,i){t.dataUpdateCount++;let s=new we(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let u=xu(n,c=>Ue(c));o=VW(t.serverSyncTree_,s,u,i)}else{let u=Ue(n);o=oF(t.serverSyncTree_,s,u,i)}else if(r){let u=xu(n,c=>Ue(c));o=kW(t.serverSyncTree_,s,u)}else{let u=Ue(n);o=Id(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=Eu(t,s)),cn(t.eventQueue_,a,o)}function g1(t,e){H0(t,"connected",e),e===!1&&o6(t)}function r6(t,e){_t(e,(n,r)=>{H0(t,n,r)})}function H0(t,e,n){let r=new we("/.info/"+e),i=Ue(n);t.infoData_.updateSnapshot(r,i);let s=Id(t.infoSyncTree_,r,i);cn(t.eventQueue_,r,s)}function Am(t){return t.nextWriteId_++}function i6(t,e,n){let r=LW(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=Ue(i).withIndex(e._queryParams.getIndex());e0(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Id(t.serverSyncTree_,e._path,s);else{let a=pd(t.serverSyncTree_,e);o=oF(t.serverSyncTree_,e._path,s,a)}return cn(t.eventQueue_,e._path,o),lm(t.serverSyncTree_,e,n,null,!0),s},i=>(Su(t,"get for query "+Qe(e)+" failed: "+i),Promise.reject(new Error(i))))}function q0(t,e,n,r,i){Su(t,"set",{path:e.toString(),value:n,priority:r});let s=bd(t),o=Ue(n,r),a=Im(t.serverSyncTree_,e),u=j0(o,a,s),c=Am(t),l=O0(t.serverSyncTree_,e,u,c,!0);Sm(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||kt("set at "+e+" failed: "+h);let g=qi(t.serverSyncTree_,c,!p);cn(t.eventQueue_,e,g),Yi(t,i,h,f)});let d=z0(t,e);Eu(t,d),cn(t.eventQueue_,d,[])}function s6(t,e,n,r){Su(t,"update",{path:e.toString(),value:n});let i=!0,s=bd(t),o={};if(_t(n,(a,u)=>{i=!1,o[a]=lF(Ve(e,a),Ue(u),t.serverSyncTree_,s)}),i)yt("update() called with empty data.  Don't do anything."),Yi(t,r,"ok",void 0);else{let a=Am(t),u=PW(t.serverSyncTree_,e,o,a);Sm(t.eventQueue_,u),t.server_.merge(e.toString(),n,(c,l)=>{let d=c==="ok";d||kt("update at "+e+" failed: "+c);let h=qi(t.serverSyncTree_,a,!d),f=h.length>0?Eu(t,e):e;cn(t.eventQueue_,f,h),Yi(t,r,c,l)}),_t(n,c=>{let l=z0(t,Ve(e,c));Eu(t,l)}),cn(t.eventQueue_,e,[])}}function o6(t){Su(t,"onDisconnectEvents");let e=bd(t),n=em();BD(t.onDisconnect_,ve(),(i,s)=>{let o=lF(i,s,t.serverSyncTree_,e);Du(n,i,o)});let r=[];BD(n,ve(),(i,s)=>{r=r.concat(Id(t.serverSyncTree_,i,s));let o=z0(t,i);Eu(t,o)}),t.onDisconnect_=em(),cn(t.eventQueue_,ve(),r)}function a6(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&UD(t.onDisconnect_,e),Yi(t,n,r,i)})}function m1(t,e,n,r){let i=Ue(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Du(t.onDisconnect_,e,i),Yi(t,r,s,o)})}function u6(t,e,n,r,i){let s=Ue(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Du(t.onDisconnect_,e,s),Yi(t,i,o,a)})}function c6(t,e,n,r){if(kd(n)){yt("onDisconnect().update() called with empty data.  Don't do anything."),Yi(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&_t(n,(o,a)=>{let u=Ue(a);Du(t.onDisconnect_,Ve(e,o),u)}),Yi(t,r,i,s)})}function l6(t,e,n){let r;re(e._path)===".info"?r=e0(t.infoSyncTree_,e,n):r=e0(t.serverSyncTree_,e,n),mF(t.eventQueue_,e._path,r)}function o0(t,e,n){let r;re(e._path)===".info"?r=lm(t.infoSyncTree_,e,n):r=lm(t.serverSyncTree_,e,n),mF(t.eventQueue_,e._path,r)}function wF(t){t.persistentConnection_&&t.persistentConnection_.interrupt(_F)}function d6(t){t.persistentConnection_&&t.persistentConnection_.resume(_F)}function Su(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),yt(n,...e)}function Yi(t,e,n,r){e&&Cu(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function h6(t,e,n,r,i,s){Su(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:v1(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=G0(t,e,void 0);o.currentInputSnapshot=a;let u=o.update(a.val());if(u===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Dd("transaction failed: Data returned ",u,o.path),o.status=0;let c=Dm(t.transactionQueueTree_,e),l=po(c)||[];l.push(o),B0(c,l);let d;typeof u=="object"&&u!==null&&fn(u,".priority")?(d=Xr(u,".priority"),S(md(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(Im(t.serverSyncTree_,e)||J.EMPTY_NODE).getPriority().val();let h=bd(t),f=Ue(u,d),p=j0(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Am(t);let g=O0(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);cn(t.eventQueue_,e,g),xm(t,t.transactionQueueTree_)}}function G0(t,e,n){return Im(t.serverSyncTree_,e,n)||J.EMPTY_NODE}function xm(t,e=t.transactionQueueTree_){if(e||Mm(t,e),po(e)){let n=IF(t,e);S(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&f6(t,Cd(e),n)}else dF(e)&&Tm(e,n=>{xm(t,n)})}function f6(t,e,n){let r=n.map(c=>c.currentWriteId),i=G0(t,e,r),s=i,o=i.hash();for(let c=0;c<n.length;c++){let l=n[c];S(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=Ht(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),u=e;t.server_.put(u.toString(),a,c=>{Su(t,"transaction put response",{path:u.toString(),status:c});let l=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat(qi(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Mm(t,Dm(t.transactionQueueTree_,e)),xm(t,t.transactionQueueTree_),cn(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)Cu(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{kt("transaction at "+u.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}Eu(t,e)}},o)}function Eu(t,e){let n=EF(t,e),r=Cd(n),i=IF(t,n);return p6(t,i,r),r}function p6(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let u=e[a],c=Ht(n,u.path),l=!1,d;if(S(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)l=!0,d=u.abortReason,i=i.concat(qi(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=t6)l=!0,d="maxretry",i=i.concat(qi(t.serverSyncTree_,u.currentWriteId,!0));else{let h=G0(t,u.path,o);u.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){Dd("transaction failed: Data returned ",f,u.path);let p=Ue(f);typeof f=="object"&&f!=null&&fn(f,".priority")||(p=p.updatePriority(h.getPriority()));let _=u.currentWriteId,T=bd(t),P=j0(p,h,T);u.currentOutputSnapshotRaw=p,u.currentOutputSnapshotResolved=P,u.currentWriteId=Am(t),o.splice(o.indexOf(_),1),i=i.concat(O0(t.serverSyncTree_,u.path,P,u.currentWriteId,u.applyLocally)),i=i.concat(qi(t.serverSyncTree_,_,!0))}else l=!0,d="nodata",i=i.concat(qi(t.serverSyncTree_,u.currentWriteId,!0))}cn(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}Mm(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Cu(r[a]);xm(t,t.transactionQueueTree_)}function EF(t,e){let n,r=t.transactionQueueTree_;for(n=re(e);n!==null&&po(r)===void 0;)r=Dm(r,n),e=Ae(e),n=re(e);return r}function IF(t,e){let n=[];return CF(t,e,n),n.sort((r,i)=>r.order-i.order),n}function CF(t,e,n){let r=po(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Tm(e,i=>{CF(t,i,n)})}function Mm(t,e){let n=po(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,B0(e,n.length>0?n:void 0)}Tm(e,r=>{Mm(t,r)})}function z0(t,e){let n=Cd(EF(t,e)),r=Dm(t.transactionQueueTree_,e);return WW(r,i=>{gD(t,i)}),gD(t,r),hF(r,i=>{gD(t,i)}),n}function gD(t,e){let n=po(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(S(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(S(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(qi(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?B0(e,void 0):n.length=s+1,cn(t.eventQueue_,Cd(e),i);for(let o=0;o<r.length;o++)Cu(r[o])}}function g6(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function m6(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):kt(`Invalid query segment '${n}' in query '${t}'`)}return e}var a0=function(t,e){let n=y6(t),r=n.namespace;n.domain==="firebase.com"&&Dr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Dr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||W3();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new zg(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new we(n.pathString)}},y6=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=g6(t.substring(l,d)));let h=m6(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var y1="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",_6=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=y1.charAt(n%64),n=Math.floor(n/64);S(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=y1.charAt(e[i]);return S(o.length===20,"nextPushId: Length should be 20."),o}}();var dm=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Qe(this.snapshot.exportVal())}},hm=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var yd=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return S(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var fm=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new dt;return a6(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){un("OnDisconnect.remove",this._path);let e=new dt;return m1(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){un("OnDisconnect.set",this._path),br("OnDisconnect.set",e,this._path,!1);let n=new dt;return m1(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){un("OnDisconnect.setWithPriority",this._path),br("OnDisconnect.setWithPriority",e,this._path,!1),$0("OnDisconnect.setWithPriority",n,!1);let r=new dt;return u6(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){un("OnDisconnect.update",this._path),pF("OnDisconnect.update",e,this._path,!1);let n=new dt;return c6(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Gt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ie(this._path)?null:D0(this._path)}get ref(){return new ln(this._repo,this._path)}get _queryIdentifier(){let e=r1(this._queryParams),n=I0(e);return n==="{}"?"default":n}get _queryObject(){return r1(this._queryParams)}isEqual(e){if(e=ce(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=T0(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+T9(this._path)}};function Rm(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Ji(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Cr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Wi)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Zr)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Re){if(e!=null&&!md(e)||n!=null&&!md(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(S(t.getIndex()instanceof ad||t.getIndex()===A0,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Nm(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var ln=class t extends Gt{constructor(e,n){super(e,n,new dd,!1)}get parent(){let e=U1(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Iu=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new we(e),r=Zi(this.ref,e);return new t(this._node.getChild(n),r,Re)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,Zi(this.ref,r),Re)))}hasChild(e){let n=new we(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function W0(t,e){return t=ce(t),t._checkNotDeleted("ref"),e!==void 0?Zi(t._root,e):t._root}function K0(t,e){t=ce(t),t._checkNotDeleted("refFromURL");let n=a0(e,t._repo.repoInfo_.nodeAdmin);gF("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Dr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),W0(t,n.path.toString())}function Zi(t,e){return t=ce(t),re(t._path)===null?XW("child","path",e,!1):bu("child","path",e,!1),new ln(t._repo,Ve(t._path,e))}function DF(t,e){t=ce(t),un("push",t._path),br("push",e,t._path,!0);let n=vF(t._repo),r=_6(n),i=Zi(t,r),s=Zi(t,r),o;return e!=null?o=Pm(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function TF(t){return un("remove",t._path),Pm(t,null)}function Pm(t,e){t=ce(t),un("set",t._path),br("set",e,t._path,!1);let n=new dt;return q0(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function bF(t,e){t=ce(t),un("setPriority",t._path),$0("setPriority",e,!1);let n=new dt;return q0(t._repo,Ve(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function SF(t,e,n){if(un("setWithPriority",t._path),br("setWithPriority",e,t._path,!1),$0("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new dt;return q0(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function AF(t,e){pF("update",e,t._path,!1);let n=new dt;return s6(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function xF(t){t=ce(t);let e=new yd(()=>{}),n=new _d(e);return i6(t._repo,t,n).then(r=>new Iu(r,new ln(t._repo,t._path),t._queryParams.getIndex()))}var _d=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new dm("value",this,new Iu(e.snapshotNode,new ln(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new hm(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},pm=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new hm(this,e,n):null}createEvent(e,n){S(e.childName!=null,"Child events should have a childName.");let r=Zi(new ln(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new dm(e.type,this,new Iu(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Sd(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let u=n,c=(l,d)=>{o0(t._repo,t,a),u(l,d)};c.userCallback=n.userCallback,c.context=n.context,n=c}let o=new yd(n,s||void 0),a=e==="value"?new _d(o):new pm(e,o);return l6(t._repo,t,a),()=>o0(t._repo,t,a)}function km(t,e,n,r){return Sd(t,"value",e,n,r)}function Q0(t,e,n,r){return Sd(t,"child_added",e,n,r)}function Y0(t,e,n,r){return Sd(t,"child_changed",e,n,r)}function Z0(t,e,n,r){return Sd(t,"child_moved",e,n,r)}function J0(t,e,n,r){return Sd(t,"child_removed",e,n,r)}function X0(t,e,n){let r=null,i=n?new yd(n):null;e==="value"?r=new _d(i):e&&(r=new pm(e,i)),o0(t._repo,t,r)}var dn=class{},gm=class extends dn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){br("endAt",this._value,e._path,!0);let n=VD(e._queryParams,this._value,this._key);if(Nm(n),Ji(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Gt(e._repo,e._path,n,e._orderByCalled)}};function MF(t,e){return Td("endAt","key",e,!0),new gm(t,e)}var u0=class extends dn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){br("endBefore",this._value,e._path,!1);let n=q9(e._queryParams,this._value,this._key);if(Nm(n),Ji(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Gt(e._repo,e._path,n,e._orderByCalled)}};function RF(t,e){return Td("endBefore","key",e,!0),new u0(t,e)}var mm=class extends dn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){br("startAt",this._value,e._path,!0);let n=FD(e._queryParams,this._value,this._key);if(Nm(n),Ji(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Gt(e._repo,e._path,n,e._orderByCalled)}};function NF(t=null,e){return Td("startAt","key",e,!0),new mm(t,e)}var c0=class extends dn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){br("startAfter",this._value,e._path,!1);let n=H9(e._queryParams,this._value,this._key);if(Nm(n),Ji(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Gt(e._repo,e._path,n,e._orderByCalled)}};function PF(t,e){return Td("startAfter","key",e,!0),new c0(t,e)}var l0=class extends dn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Gt(e._repo,e._path,B9(e._queryParams,this._limit),e._orderByCalled)}};function kF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new l0(t)}var d0=class extends dn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Gt(e._repo,e._path,$9(e._queryParams,this._limit),e._orderByCalled)}};function OF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new d0(t)}var h0=class extends dn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Rm(e,"orderByChild");let n=new we(this._path);if(ie(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new ad(n),i=_m(e._queryParams,r);return Ji(i),new Gt(e._repo,e._path,i,!0)}};function FF(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return bu("orderByChild","path",t,!1),new h0(t)}var f0=class extends dn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Rm(e,"orderByKey");let n=_m(e._queryParams,Cr);return Ji(n),new Gt(e._repo,e._path,n,!0)}};function VF(){return new f0}var p0=class extends dn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Rm(e,"orderByPriority");let n=_m(e._queryParams,Re);return Ji(n),new Gt(e._repo,e._path,n,!0)}};function LF(){return new p0}var g0=class extends dn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Rm(e,"orderByValue");let n=_m(e._queryParams,A0);return Ji(n),new Gt(e._repo,e._path,n,!0)}};function jF(){return new g0}var m0=class extends dn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(br("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new gm(this._value,this._key)._apply(new mm(this._value,this._key)._apply(e))}};function UF(t,e){return Td("equalTo","key",e,!0),new m0(t,e)}function Mn(t,...e){let n=ce(t);for(let r of e)n=r._apply(n);return n}TW(ln);MW(ln);var v6="FIREBASE_DATABASE_EMULATOR_HOST",y0={},w6=!1;function E6(t,e,n,r){t.repoInfo_=new zg(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function eT(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Dr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),yt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=a0(s,i),a=o.repoInfo,u,c;typeof process<"u"&&process.env&&(c=process.env[v6]),c?(u=!0,s=`http://${c}?ns=${a.namespace}`,o=a0(s,i),a=o.repoInfo):u=!o.repoInfo.secure;let l=i&&u?new td(td.OWNER):new ED(t.name,t.options,e);gF("Invalid Firebase Database URL",o),ie(o.path)||Dr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=C6(a,t,l,new wD(t.name,n));return new _0(d,t)}function I6(t,e){let n=y0[e];(!n||n[t.key]!==t)&&Dr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),wF(t),delete n[t.key]}function C6(t,e,n,r){let i=y0[e.name];i||(i={},y0[e.name]=i);let s=i[t.toURLString()];return s&&Dr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new s0(t,w6,n,r),i[t.toURLString()]=s,s}var _0=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(n6(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ln(this._repo,ve())),this._rootInternal}_delete(){return this._rootInternal!==null&&(I6(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Dr("Cannot call "+e+" on a deleted database.")}};function BF(){j1.IS_TRANSPORT_INITIALIZED&&kt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function $F(){BF(),sd.forceDisallow()}function HF(){BF(),hu.forceDisallow(),sd.forceAllow()}function qF(t,e,n,r={}){t=ce(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Dr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Dr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new td(td.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Rd(r.mockUserToken,t.app.options.projectId);s=new td(o)}E6(i,e,n,s)}function GF(t){t=ce(t),t._checkNotDeleted("goOffline"),wF(t._repo)}function zF(t){t=ce(t),t._checkNotDeleted("goOnline"),d6(t._repo)}function WF(t,e){E1(t,e)}function D6(t){E0(Fd),Xi(new Xt("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return eT(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Rn(UO,BO,t),Rn(UO,BO,"esm2017")}var T6={".sv":"timestamp"};function KF(){return T6}function QF(t){return{".sv":{increment:t}}}var v0=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function YF(t,e,n){var r;if(t=ce(t),un("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new dt,o=(u,c,l)=>{let d=null;u?s.reject(u):(d=new Iu(l,new ln(t._repo,t._path),Re),s.resolve(new v0(c,d)))},a=km(t,()=>{});return h6(t._repo,t._path,e,o,a,i),s.promise}b0.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};b0.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};D6();var b6="@firebase/database-compat",S6="1.0.3";var A6=new ei("@firebase/database-compat"),ZF=function(t){let e="FIREBASE WARNING: "+t;A6.warn(e)};var x6=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(zt(t,e)+"must be a boolean.")},M6=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(zt(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var tT=class{constructor(e){this._delegate=e}cancel(e){q("OnDisconnect.cancel",0,1,arguments.length),ut("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){q("OnDisconnect.remove",0,1,arguments.length),ut("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){q("OnDisconnect.set",1,2,arguments.length),ut("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){q("OnDisconnect.setWithPriority",2,3,arguments.length),ut("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(q("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,ZF("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ut("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var nT=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return q("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var go=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return q("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return q("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return q("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return q("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return q("DataSnapshot.child",0,1,arguments.length),e=String(e),bu("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return q("DataSnapshot.hasChild",1,1,arguments.length),bu("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return q("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return q("DataSnapshot.forEach",1,1,arguments.length),ut("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return q("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return q("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return q("DataSnapshot.ref",0,0,arguments.length),new Jr(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Om=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;q("Query.on",2,4,arguments.length),ut("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(c,l)=>{n.call(o.context,new go(this.database,c),l)};a.userCallback=n,a.context=o.context;let u=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return km(this._delegate,a,u),n;case"child_added":return Q0(this._delegate,a,u),n;case"child_removed":return J0(this._delegate,a,u),n;case"child_changed":return Y0(this._delegate,a,u),n;case"child_moved":return Z0(this._delegate,a,u),n;default:throw new Error(zt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(q("Query.off",0,3,arguments.length),M6("Query.off",e,!0),ut("Query.off","callback",n,!0),Bm("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,X0(this._delegate,e,i)}else X0(this._delegate,e)}get(){return xF(this._delegate).then(e=>new go(this.database,e))}once(e,n,r,i){q("Query.once",1,4,arguments.length),ut("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new dt,a=(c,l)=>{let d=new go(this.database,c);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let u=c=>{s.cancel&&s.cancel.call(s.context,c),o.reject(c)};switch(e){case"value":km(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":Q0(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":J0(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":Y0(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":Z0(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error(zt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return q("Query.limitToFirst",1,1,arguments.length),new t(this.database,Mn(this._delegate,kF(e)))}limitToLast(e){return q("Query.limitToLast",1,1,arguments.length),new t(this.database,Mn(this._delegate,OF(e)))}orderByChild(e){return q("Query.orderByChild",1,1,arguments.length),new t(this.database,Mn(this._delegate,FF(e)))}orderByKey(){return q("Query.orderByKey",0,0,arguments.length),new t(this.database,Mn(this._delegate,VF()))}orderByPriority(){return q("Query.orderByPriority",0,0,arguments.length),new t(this.database,Mn(this._delegate,LF()))}orderByValue(){return q("Query.orderByValue",0,0,arguments.length),new t(this.database,Mn(this._delegate,jF()))}startAt(e=null,n){return q("Query.startAt",0,2,arguments.length),new t(this.database,Mn(this._delegate,NF(e,n)))}startAfter(e=null,n){return q("Query.startAfter",0,2,arguments.length),new t(this.database,Mn(this._delegate,PF(e,n)))}endAt(e=null,n){return q("Query.endAt",0,2,arguments.length),new t(this.database,Mn(this._delegate,MF(e,n)))}endBefore(e=null,n){return q("Query.endBefore",0,2,arguments.length),new t(this.database,Mn(this._delegate,RF(e,n)))}equalTo(e,n){return q("Query.equalTo",1,2,arguments.length),new t(this.database,Mn(this._delegate,UF(e,n)))}toString(){return q("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return q("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(q("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,ut(e,"cancel",i.cancel,!0),i.context=r,Bm(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(zt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Jr(this.database,new ln(this._delegate._repo,this._delegate._path))}},Jr=class t extends Om{constructor(e,n){super(e,new Gt(n._repo,n._path,new dd,!1)),this.database=e,this._delegate=n}getKey(){return q("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return q("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,Zi(this._delegate,e))}getParent(){q("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return q("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){q("Reference.set",1,2,arguments.length),ut("Reference.set","onComplete",n,!0);let r=Pm(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(q("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,ZF("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}un("Reference.update",this._delegate._path),ut("Reference.update","onComplete",n,!0);let r=AF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){q("Reference.setWithPriority",2,3,arguments.length),ut("Reference.setWithPriority","onComplete",r,!0);let i=SF(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){q("Reference.remove",0,1,arguments.length),ut("Reference.remove","onComplete",e,!0);let n=TF(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){q("Reference.transaction",1,3,arguments.length),ut("Reference.transaction","transactionUpdate",e,!1),ut("Reference.transaction","onComplete",n,!0),x6("Reference.transaction","applyLocally",r,!0);let i=YF(this._delegate,e,{applyLocally:r}).then(s=>new nT(s.committed,new go(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){q("Reference.setPriority",1,2,arguments.length),ut("Reference.setPriority","onComplete",n,!0);let r=bF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){q("Reference.push",0,2,arguments.length),ut("Reference.push","onComplete",n,!0);let r=DF(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return un("Reference.onDisconnect",this._delegate._path),new tT(new fm(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var mo=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:$F,forceLongPolling:HF}}useEmulator(e,n,r={}){qF(this._delegate,e,n,r)}ref(e){if(q("database.ref",0,1,arguments.length),e instanceof Jr){let n=K0(this._delegate,e.toString());return new Jr(this,n)}else{let n=W0(this._delegate,e);return new Jr(this,n)}}refFromURL(e){q("database.refFromURL",1,1,arguments.length);let r=K0(this._delegate,e);return new Jr(this,r)}goOffline(){return q("database.goOffline",0,0,arguments.length),GF(this._delegate)}goOnline(){return q("database.goOnline",0,0,arguments.length),zF(this._delegate)}};mo.ServerValue={TIMESTAMP:KF(),increment:t=>QF(t)};function R6({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){E0(n);let a=new $m("database-standalone"),u=new Od("auth-internal",a);u.setComponent(new Xt("auth-internal",()=>r,"PRIVATE"));let c;return i&&(c=new Od("app-check-internal",a),c.setComponent(new Xt("app-check-internal",()=>i,"PRIVATE"))),{instance:new mo(eT(t,u,c,e,o),t),namespace:s}}var N6=Object.freeze({__proto__:null,initStandalone:R6});var P6=mo.ServerValue;function k6(t){t.INTERNAL.registerComponent(new Xt("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new mo(i,r)},"PUBLIC").setServiceProps({Reference:Jr,Query:Om,Database:mo,DataSnapshot:go,enableLogging:WF,INTERNAL:N6,ServerValue:P6}).setMultipleInstances(!0)),t.registerVersion(b6,S6)}k6(vt);function Ad(t,e,n="on",r=is){return new ne(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(j(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Vu())}function O6(t){return typeof t=="string"}function F6(t){return typeof t.exportVal=="function"}function nV(t){return t==null}function rV(t){return typeof t.set=="function"}function JF(t,e){return rV(e)?e:t.ref(e)}function iV(t,e){if(O6(t))return e.stringCase();if(rV(t))return e.firebaseCase();if(F6(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function sV(t){return(nV(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function oV(t,e,n){e=sV(e);let r=e.map(i=>Ad(t,i,"on",n));return Mo(...r)}function V6(t,e,n){let r=oV(t,e).pipe(Zn((i,s)=>[...i,s],[]));return j6(t,r,n)}function L6(t,e){return Ad(t,"value","on",e).pipe(j(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function j6(t,e,n){return L6(t,n).pipe(dy(e),j(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),cy(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),j(i=>i.actions))}function XF(t,e){return function(r,i){return iV(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function U6(t){return function(n){return n?iV(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function B6(t,e,n){return Ad(t,"value","once",n).pipe(Oe(r=>{let i=[U(r)];return e.forEach(s=>i.push(Ad(t,s,"on",n))),Mo(...i).pipe(Zn(H6,[]))}),ku())}function aV(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function $6(t,e){if(nV(e))return 0;{let n=aV(t,e);return n===-1?t.length:n+1}}function H6(t,e){let{payload:n,prevKey:r,key:i}=e,s=aV(t,i),o=$6(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{let c={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(u=>u.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function eV(t,e,n){return e=sV(e),B6(t,e,n)}function q6(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:XF(r,"update"),set:XF(r,"set"),push:i=>r.push(i),remove:U6(r),snapshotChanges(i){return eV(t,i,n).pipe(Ge)},stateChanges(i){return oV(t,i,n).pipe(Ge)},auditTrail(i){return V6(t,i,n).pipe(Ge)},valueChanges(i,s){return eV(t,i,n).pipe(j(a=>a.map(u=>s&&s.idField?ue(x({},u.payload.val()),{[s.idField]:u.key}):u.payload.val())),Ge)}}}function tV(t,e){return function(){return Ad(t,"value","on",e)}}function G6(t,e){return{query:t,snapshotChanges(){return tV(t,e.schedulers.outsideAngular)().pipe(Ge)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return tV(t,e.schedulers.outsideAngular)().pipe(Ge,j(r=>r.payload.exists()?r.payload.val():null))}}}var z6=new F("angularfire2.realtimeDatabaseURL"),W6=new F("angularfire2.database.use-emulator"),K6=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,_){this.schedulers=a;let T=u,P=bs(n,o,r);c&&kc(P,o,l,h,f,p,d,g),this.database=ga(`${P.name}.database.${i}`,"AngularFireDatabase",P.name,()=>{let A=o.runOutsideAngular(()=>P.database(i||void 0));return T&&A.useEmulator(...T),A},[T])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>JF(this.database,n)),s=i;return r&&(s=r(i)),q6(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>JF(this.database,n));return G6(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(I(wi),I(Ei,8),I(z6,8),I(xt),I(le),I(pa),I(W6,8),I(Bf,8),I(Ac,8),I(xc,8),I(Mc,8),I(Rc,8),I(Nc,8),I(Pc,8),I(jr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),uV=(()=>{class t{constructor(){vt.registerVersion("angularfire",Ts.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=et({type:t});static \u0275inj=Xe({providers:[K6]})}return t})();var cV={production:!1,firebaseConfig:{apiKey:"AIzaSyA1biiilIPPoUEZEl_oIWGZocjxzfupqd4",authDomain:"libros-e9a24.firebaseapp.com",databaseURL:"https://libros-e9a24-default-rtdb.firebaseio.com",projectId:"libros-e9a24",storageBucket:"libros-e9a24.appspot.com",messagingSenderId:"741059288725",appId:"1:741059288725:web:fb672713a95899faed859c"}};var lV=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e,bootstrap:[jO]}),e.\u0275inj=Xe({imports:[ax,LO,RO,pM.initializeApp(cV.firebaseConfig),uV]});let t=e;return t})();ox().bootstrapModule(lV).catch(t=>console.error(t));
